(self.webpackChunk=self.webpackChunk||[]).push([[2902],{"../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/user/cronjobs/index.vue?vue&type=style&index=0&id=128435da&prod&lang=scss&":function(){},"./js/api/commands/user/cronjobs.ts":function(u,d,s){"use strict";s.d(d,{Jh:function(){return m},SX:function(){return f},cX:function(){return r},it:function(){return b},vP:function(){return _},yl:function(){return c},zk:function(){return i}});var o=s("./js/api/command/index.js"),l=s("../node_modules/ramda/es/index.js");const a="/CMD_CRON_JOBS",i=o.Z.get({url:a,id:"CRON_JOBS",params:{ipp:"99999",page:"1"},mapResponse:{email:l.vgT("MAILTO"),rows:l.zGw(l.vgT("crons"),l.CEd(["info"]),l.VO0)}}),c=o.Z.select({url:a,params:{action:"delete",delete:!0}}),m=o.Z.post({url:a,params:{action:"create"},schema:{reboot:o.Z.REQUIRED_BOOL,minute:o.Z.REQUIRED_STRING,hour:o.Z.REQUIRED_STRING,dayofmonth:o.Z.REQUIRED_STRING,month:o.Z.REQUIRED_STRING,dayofweek:o.Z.REQUIRED_STRING}}),p=o.Z.post({url:a,params:{save:!0},schema:{id:o.Z.REQUIRED_STRING,command:o.Z.REQUIRED_STRING}}),f=p.extend({url:a,params:{reboot:!0}}),_=p.extend({url:a,schema:{minute:o.Z.REQUIRED_STRING,hour:o.Z.REQUIRED_STRING,dayofmonth:o.Z.REQUIRED_STRING,month:o.Z.REQUIRED_STRING,dayofweek:o.Z.REQUIRED_STRING}}),b=o.Z.post({url:a,params:{action:"saveemail"},schema:{email:o.Z.REQUIRED_STRING}}),r=o.Z.get({url:a,id:"CRON_PHP_BIN_PATH",response:!1,mapResponse:e=>e.set_php_bin_path_in_crons==="1"})},"./js/pages/user/cronjobs/index.vue":function(u,d,s){"use strict";s.r(d),s.d(d,{default:function(){return b}});var o=function(){var e=this,t=e._self._c;return t("app-page",{attrs:{actions:[{name:"user/cronjobs/create",label:e.$gettext("Create Cron Job"),icon:"#plus-fill"},{handler:e.$dialog("SEND_TO_EMAIL").open,label:e.$gettext("Send all Cron output to e-mail"),icon:"#email-manager"}]}},[t("app-page-section",[t("ui-r-table",e._b({staticClass:"cronjobs",attrs:{"rows-count":e.$api.cronjobs.rows.length,"checked-rows":e.checkedRows,columns:[{id:"minute",label:e.$gettext("Minute")},{id:"hour",label:e.$gettext("Hour")},{id:"day_of_month",label:e.$gettext("Day of Month")},{id:"month",label:e.$gettext("Month")},{id:"day_of_week",label:e.$gettext("Day of Week")},{id:"command",label:e.$gettext("Command"),grow:!0}],editable:!1,"vertical-layout":e.clientStore.isPhone,"disable-pagination":""},on:{"update:checkedRows":function(n){e.checkedRows=n}},scopedSlots:e._u([{key:"table:actions",fn:function(){return[t("ui-table-action",{on:{click:function(n){e.$dialog("DELETE_ITEMS_DIALOG").open()}}},[t("span",{domProps:{textContent:e._s(e.$gettext("Delete"))}})])]},proxy:!0},{key:"row:actions",fn:function({item:n}){return[t("ui-button-icon",{attrs:{icon:"pencil",title:e.$gettext("Edit")},on:{click:function(x){return e.setEditable(n)}}})]}},{key:"col:command",fn:function({command:n}){return[t("span",{staticClass:"wrap",domProps:{textContent:e._s(n)}})]}}])},"ui-r-table",e.$api.cronjobs,!1))],1),e._v(" "),t("ui-dialog-delete-items",{attrs:{subject:e.$ngettext("Cron job","Cron jobs",e.checkedJobs.length)},on:{"click:confirm":e.deleteJobs}}),e._v(" "),t("ui-dialog",{attrs:{id:"SEND_TO_EMAIL",title:e.$gettext("Set E-mail")},scopedSlots:e._u([{key:"content",fn:function(){return[t("ui-form-element",{attrs:{vertical:""},scopedSlots:e._u([{key:"title",fn:function(){return[e._v(e._s(e.$gettext("E-mail")))]},proxy:!0},{key:"tooltip",fn:function(){return[e._v(`
                    `+e._s(e.$gettext("Valid values are an E-mail address, your DA username: admin, or a blank field to prevent any e-mail."))+`
                `)]},proxy:!0},{key:"content",fn:function(){return[t("input-text",{on:{keyup:function(n){return!n.type.indexOf("key")&&e._k(n.keyCode,"enter",13,n.key,"Enter")?null:e.saveEmail.apply(null,arguments)}},model:{value:e.email,callback:function(n){e.email=n},expression:"email"}})]},proxy:!0}])})]},proxy:!0},{key:"buttons",fn:function(){return[t("ui-button",{attrs:{theme:"safe"},on:{click:e.saveEmail}},[t("span",{domProps:{textContent:e._s(e.$gettext("Save"))}})])]},proxy:!0}])}),e._v(" "),t("ui-dialog",{attrs:{id:"EDIT_CRON_JOB",theme:"safe",size:"normal",title:e.$gettext("Edit Cron Job")},scopedSlots:e._u([{key:"content",fn:function(){return[e.editableRow.minute!=="@reboot"?[t("ui-form-element",{attrs:{vertical:"",group:"modifyCronJob",validators:{required:!0}},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("Minute"))}}),e._v(" "),t("ui-tooltip",[t("div",{directives:[{name:"flex",rawName:"v-flex",value:{dir:"column"},expression:"{ dir: 'column' }"}]},[e._v(`
                                `+e._s(e.$gettext("Valid Cron time values are the numbers indicated and *."))+`
                                `+e._s(e.$gettext("You can specify exact times using commas to separate them. e.g. 1,2,3 (minutes 1,2 and 3)"))+`
                                `+e._s(e.$gettext("You can specify spans using a dash. e.g. 5-7 (minutes 5 to 7)"))+`
                                `+e._s(e.$gettext("You can specify intervals using a star and a forward slash. e.g. */2 (every 2nd minute)"))+`
                                `+e._s(e.$gettext("You can combine them to create a more precise schedule. e.g. 1,5,11-15,30-59/2 (minutes 1, 5, 11 to 15 and every 2nd minute between 30 and 59)"))+`
                                `),t("span",{domProps:{textContent:e._s(e.$gettext("Note that there are no spaces"))}})])])]},proxy:!0},{key:"content",fn:function(){return[t("input-text",{model:{value:e.editableRow.minute,callback:function(n){e.$set(e.editableRow,"minute",n)},expression:"editableRow.minute"}})]},proxy:!0},{key:"error:between",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("Minute should be a number between 0 and 59 or *"))}})]},proxy:!0}],null,!1,2721899265)}),e._v(" "),t("ui-form-element",{attrs:{vertical:"",group:"modifyCronJob",validators:{required:!0}},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("Hour"))}})]},proxy:!0},{key:"content",fn:function(){return[t("input-text",{model:{value:e.editableRow.hour,callback:function(n){e.$set(e.editableRow,"hour",n)},expression:"editableRow.hour"}})]},proxy:!0},{key:"error:between",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("Hour should be a number between 0 and 23 or *"))}})]},proxy:!0}],null,!1,1632565636)}),e._v(" "),t("ui-form-element",{attrs:{vertical:"",group:"modifyCronJob",validators:{required:!0}},scopedSlots:e._u([{key:"title",fn:function(){return[e._v(`
                        `+e._s(e.$gettext("Day of Month"))+`
                    `)]},proxy:!0},{key:"content",fn:function(){return[t("input-text",{model:{value:e.editableRow.day_of_month,callback:function(n){e.$set(e.editableRow,"day_of_month",n)},expression:"editableRow.day_of_month"}})]},proxy:!0}],null,!1,2706699772)}),e._v(" "),t("ui-form-element",{attrs:{vertical:"",group:"modifyCronJob",validators:{required:!0}},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("Month"))}})]},proxy:!0},{key:"content",fn:function(){return[t("input-text",{model:{value:e.editableRow.month,callback:function(n){e.$set(e.editableRow,"month",n)},expression:"editableRow.month"}})]},proxy:!0}],null,!1,745814101)}),e._v(" "),t("ui-form-element",{attrs:{vertical:""},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("Day of Week"))}})]},proxy:!0},{key:"content",fn:function(){return[t("input-text",{model:{value:e.editableRow.day_of_week,callback:function(n){e.$set(e.editableRow,"day_of_week",n)},expression:"editableRow.day_of_week"}})]},proxy:!0}],null,!1,3606845461)})]:e._e(),e._v(" "),t("ui-form-element",{attrs:{vertical:""},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("Command"))}}),e._v(" "),t("ui-tooltip",[t("div",{directives:[{name:"flex",rawName:"v-flex",value:{dir:"column"},expression:"{ dir: 'column' }"}]},[e._v(`
                            `+e._s(e.$gettext("To access a specific URL periodically use a command like:"))+`
                            curl -L -s https://example.com/cron.php
                        `)])])]},proxy:!0},{key:"content",fn:function(){return[t("input-textarea",{attrs:{type:"text"},model:{value:e.editableRow.command,callback:function(n){e.$set(e.editableRow,"command",n)},expression:"editableRow.command"}})]},proxy:!0}])})]},proxy:!0},{key:"buttons",fn:function(){return[t("ui-button",{attrs:{theme:"primary","validate-group":"modifyCronJob"},on:{click:e.updateJob}},[t("span",{domProps:{textContent:e._s(e.$gettext("Save"))}})])]},proxy:!0}])})],1)},l=[],a=s("./js/stores/index.ts"),i=s("./js/api/commands/user/cronjobs.ts"),c={preload:()=>i.zk(),api:[{command:i.zk,bind:"cronjobs"}],data(){return{checkedRows:[],editableRow:{},email:""}},computed:{checkedJobs(){return this.checkedRows.map(r=>r.id)},...(0,a.Kc)(["client"])},created(){this.email=this.$api.cronjobs.email},methods:{loadData(){i.zk()},async deleteJobs(){await i.yl({select:this.checkedJobs})&&(this.checkedRows=[],this.clearEditable(),this.loadData())},async saveEmail(){i.it({email:this.email}),this.$dialog("SEND_TO_EMAIL").close()},setEditable(r){this.editableRow={...r},this.$dialog("EDIT_CRON_JOB").open()},clearEditable(){this.editableRow={},this.$dialog("EDIT_CRON_JOB").close()},async updateJob(){let r=null;this.editableRow.minute==="@reboot"?r=await i.SX(this.editableRow):r=await i.vP({...this.editableRow,dayofmonth:this.editableRow.day_of_month,dayofweek:this.editableRow.day_of_week}),!(r instanceof Error)&&(this.clearEditable(),this.loadData())}}},m=c,p=s("../node_modules/vue-style-loader/index.js!../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/user/cronjobs/index.vue?vue&type=style&index=0&id=128435da&prod&lang=scss&"),f=s("../node_modules/vue-loader/lib/runtime/componentNormalizer.js"),_=(0,f.Z)(m,o,l,!1,null,null,null),b=_.exports},"../node_modules/vue-style-loader/index.js!../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/user/cronjobs/index.vue?vue&type=style&index=0&id=128435da&prod&lang=scss&":function(u,d,s){var o=s("../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/user/cronjobs/index.vue?vue&type=style&index=0&id=128435da&prod&lang=scss&");o.__esModule&&(o=o.default),typeof o=="string"&&(o=[[u.id,o,""]]),o.locals&&(u.exports=o.locals);var l=s("../node_modules/vue-style-loader/lib/addStylesClient.js").Z,a=l("5fb53eb8",o,!0,{})}}]);
