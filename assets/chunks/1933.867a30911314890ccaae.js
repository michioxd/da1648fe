(self.webpackChunk=self.webpackChunk||[]).push([[1933],{"./js/api/commands/admin/users/packages.js":function(x,f,d){"use strict";d.d(f,{$o:function(){return P},$y:function(){return h},EV:function(){return g},Nx:function(){return m},kz:function(){return i},wI:function(){return O},xp:function(){return _}});var s=d("./js/api/command/index.js");const p="/CMD_MANAGE_RESELLER_PACKAGES",g=s.Z.get({id:"RESELLER_PACKAGES",url:p,params:{bytes:!0},pagination:!0,after:t=>t.toTable(t.mapArrayProps({bandwidth:t.convert.toAppLimit,quota:t.convert.toAppLimit,ips:n=>t.convert.toAppNumber(n||"0")}))}),O=s.Z.post({url:p,schema:{select:s.Z.ROWS},before:({select:t})=>t.reduce((n,a,c)=>({...n,[`delete${c}`]:a}),{delete:!0})}),P=s.Z.post({url:p,params:{export:!0},schema:{select:s.Z.ROWS}}),m=s.Z.post({url:p,params:{action:"import"},schema:{import:s.Z.REQUIRED_STRING}}),_=s.Z.get({url:"/CMD_SHOW_RESELLER_PACKAGE",id:"RESELLER_PACKAGE",params:{bytes:!0},query:{package:s.Z.REQUIRED_STRING},after:t=>t.flow(n=>({data:n}),t.moveProp({"data.ips":"ips","data.custom_items":"customItems","data.have_inode":"haveInode","data.dns":"dns","data.ip":"ip","data.create_user_home_override":"homeOverride","data.cgroup":"cgroup"}),t.mapProps({homeOverride:t.flow(n=>n||{},t.toSelect),customItems:t.flow(t.toArray,t.mapArray(n=>{const a={type:n.type,description:n.desc,label:n.string,name:n.name};switch(n.type){case"checkbox":return{...a,value:n.checked==="yes"};case"text":return{...a,value:n.value};case"listbox":return{...a,value:Object.values(n.select).find(c=>c.selected).value,options:t.reduce((c,N)=>({...c,[N.value]:N.text}))(n.select)};default:return!1}}),n=>n.filter(a=>!!a)),haveInode:t.convert.toAppBoolean,dns:t.getProp("value"),ip:t.getProp("value"),ips:t.convert.toAppNumber,features:t.feedWith(1,t.flow(t.getProp("data"),t.filter(t.flow(t.getProp("type"),t.isEqual("checkbox"))),t.mapValues(t.flow(t.getProp("checked"),t.convert.toAppBoolean)))),limits:t.feedWith(1,t.flow(t.getProp("data"),t.filter(t.flow(t.getProp("type"),t.isEqual("unlimited"))),t.mapValues(n=>{const a=t.convert.toAppLimit(n.value)===1/0;return{value:a?"":n.value,unlimited:a}}))),cgroup:n=>n?Object.values({...n.options||{},...n.saved||{}}):[]}),t.deleteProp("data"))}),h=s.Z.post({url:p,params:{add:!0},schema:{bandwidth:s.Z.OPTIONAL_STRING,ubandwidth:s.Z.OPTIONAL_BOOL,quota:s.Z.OPTIONAL_STRING,uquota:s.Z.OPTIONAL_BOOL,inode:s.Z.OPTIONAL_STRING,uinode:s.Z.OPTIONAL_BOOL,vdomains:s.Z.OPTIONAL_STRING,uvdomains:s.Z.OPTIONAL_BOOL,nsubdomains:s.Z.OPTIONAL_STRING,unsubdomains:s.Z.OPTIONAL_BOOL,nemails:s.Z.OPTIONAL_STRING,unemails:s.Z.OPTIONAL_BOOL,nemailf:s.Z.OPTIONAL_STRING,unemailf:s.Z.OPTIONAL_BOOL,nemailml:s.Z.OPTIONAL_STRING,unemailml:s.Z.OPTIONAL_BOOL,nemailr:s.Z.OPTIONAL_STRING,unemailr:s.Z.OPTIONAL_BOOL,mysql:s.Z.OPTIONAL_STRING,umysql:s.Z.OPTIONAL_BOOL,domainptr:s.Z.OPTIONAL_STRING,udomainptr:s.Z.OPTIONAL_BOOL,ftp:s.Z.OPTIONAL_STRING,uftp:s.Z.OPTIONAL_BOOL,aftp:s.Z.OPTIONAL_STRING,cgi:s.Z.OPTIONAL_STRING,git:s.Z.OPTIONAL_STRING,php:s.Z.OPTIONAL_STRING,spam:s.Z.OPTIONAL_STRING,catchall:s.Z.OPTIONAL_STRING,ssl:s.Z.OPTIONAL_STRING,ssh:s.Z.OPTIONAL_STRING,userssh:s.Z.OPTIONAL_STRING,oversell:s.Z.OPTIONAL_STRING,cron:s.Z.OPTIONAL_STRING,sysinfo:s.Z.OPTIONAL_STRING,login_keys:s.Z.OPTIONAL_STRING,dnscontrol:s.Z.OPTIONAL_STRING,dns:s.Z.REQUIRED_STRING,serverip:s.Z.OPTIONAL_STRING,packagename:s.Z.OPTIONAL_STRING,create_user_home_override:s.Z.OPTIONAL_STRING,nusers:s.Z.OPTIONAL_STRING,unusers:s.Z.OPTIONAL_BOOL}}),i=s.Z.post({url:p,schema:{action:s.Z.REQUIRED_STRING,from:s.Z.REQUIRED_STRING,to:s.Z.REQUIRED_STRING},before:({from:t,to:n})=>({from:null,to:null,old_package:t,new_package:n})})},"../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/admin/reseller-packages/_components/reseller-package.vue?vue&type=style&index=0&id=f2519850&prod&lang=scss&":function(){},"./js/components/local/cgroups-editor.vue":function(x,f,d){"use strict";d.d(f,{Z:function(){return h}});var s=function(){var t=this,n=t._self._c;return t.enabled?n("app-page-section",{scopedSlots:t._u([{key:"section:title",fn:function(){return[n("div",{directives:[{name:"flex",rawName:"v-flex",value:{cross:"center"},expression:"{ cross: 'center' }"}]},[n("span",{domProps:{textContent:t._s(t.$gettext("Resource Limits"))}}),t._v(" "),t.$slots.tooltip||t.$scopedSlots.tooltip?n("ui-tooltip",{directives:[{name:"margin",rawName:"v-margin:left",value:.5,expression:"0.5",arg:"left"}]},[n("span",{domProps:{textContent:t._s(t.$gettext("Set maximum values reseller could set for his users."))}})]):t._e()],1)]},proxy:!0},{key:"default",fn:function(){return t._l(t.options,function(a){return n("ui-form-element",{key:a.name,scopedSlots:t._u([{key:"title",fn:function(){return[n("span",{domProps:{textContent:t._s(a.string)}})]},proxy:!0},{key:"tooltip",fn:function(){return[n("span",{domProps:{textContent:t._s(a.desc)}})]},proxy:!0},{key:"content",fn:function(){return[n("input-text",{attrs:{disabled:t.values[a.name].unlimited,placeholder:a.placeholder},on:{blur:function(c){return t.checkValue(a.name)}},scopedSlots:t._u([{key:"additions:right",fn:function(){return[n("input-checkbox-button",{attrs:{value:t.values[a.name].unlimited},on:{input:function(c){return t.setLimitState(a,c)}}},[n("span",{domProps:{textContent:t._s(t.$gettext("Unlimited"))}})])]},proxy:!0}],null,!0),model:{value:t.values[a.name].value,callback:function(c){t.$set(t.values[a.name],"value",c)},expression:"values[item.name].value"}})]},proxy:!0}],null,!0)})})},proxy:!0}],null,!1,4188802112)}):t._e()},p=[],g=d("../node_modules/ramda/es/index.js"),O={props:{options:{type:Array,required:!1,default:()=>[]}},data:()=>({values:{}}),computed:{enabled(){return this.options.length&&this.$_flags.server.cgroup},requestData(){return g.UID(i=>i.unlimited?"":i.value,this.values)}},watch:{requestData:{deep:!0,handler(i){this.$emit("update:cgroup-values",i)}}},created(){this.enabled&&this.options.forEach(i=>{const t=i.value||i.default,n=t==="";this.$set(this.values,i.name,{value:t,unlimited:n})})},methods:{setLimitState(i,t){this.values[i.name].unlimited=t,t===!1&&this.values[i.name].value===""&&(this.values[i.name].value=i.placeholder)},checkValue(i){this.values[i].value===""&&(this.values[i].unlimited=!0)}}},P=O,m=d("../node_modules/vue-loader/lib/runtime/componentNormalizer.js"),_=(0,m.Z)(P,s,p,!1,null,null,null),h=_.exports},"./js/pages/admin/reseller-packages/_components/reseller-package.vue":function(x,f,d){"use strict";d.d(f,{Z:function(){return N}});var s=function(){var e=this,o=e._self._c;return o("div",{staticClass:"reseller-package"},[e._l(e.enabledLimitLabels,function(r,l){return o("ui-form-element",{key:l,scopedSlots:e._u([{key:"title",fn:function(){return[o("span",{domProps:{textContent:e._s(e.$gettext(r))}})]},proxy:!0},{key:"content",fn:function(){return[o(["bandwidth","quota"].includes(l)?"input-size":"input-text",{directives:[{name:"flex-item",rawName:"v-flex-item",value:{grow:!0},expression:"{ grow: true }"}],tag:"component",attrs:{disabled:e.limits[l].unlimited,number:""},on:{blur:function(v){return e.checkEmptyness(e.limits[l])}},scopedSlots:e._u([{key:"additions:right",fn:function(){return[o("ui-button",{attrs:{tabindex:"-1"},on:{click:function(v){e.limits[l].unlimited=!e.limits[l].unlimited}}},[o("input-checkbox",{attrs:{label:e.$gettext("Unlimited")},model:{value:e.limits[l].unlimited,callback:function(v){e.$set(e.limits[l],"unlimited",v)},expression:"limits[key].unlimited"}})],1)]},proxy:!0}],null,!0),model:{value:e.limits[l].value,callback:function(v){e.$set(e.limits[l],"value",v)},expression:"limits[key].value"}})]},proxy:!0}],null,!0)})}),e._v(" "),o("ui-form-element",{scopedSlots:e._u([{key:"title",fn:function(){return[o("span",{domProps:{textContent:e._s(e.$gettext("IPs"))}})]},proxy:!0},{key:"content",fn:function(){return[o("input-text",{attrs:{number:""},model:{value:e.ips,callback:function(r){e.ips=r},expression:"ips"}})]},proxy:!0}])}),e._v(" "),e._l(e.enabledFeatureLabels,function(r,l){return o("ui-form-element",{key:l,class:{dimmed:!e.features[l]},attrs:{"vertical-on-phone":!1,reverse:e.clientStore.isPhone},scopedSlots:e._u([{key:"title",fn:function(){return[o("span",{domProps:{textContent:e._s(e.$gettext(r))}})]},proxy:!0},{key:"content",fn:function(){return[o("input-checkbox",{model:{value:e.features[l],callback:function(v){e.$set(e.features,l,v)},expression:"features[key]"}})]},proxy:!0}],null,!0)})}),e._v(" "),o("ui-form-element",{scopedSlots:e._u([{key:"title",fn:function(){return[o("span",{domProps:{textContent:e._s(e.$gettext("Personal DNS's"))}})]},proxy:!0},{key:"content",fn:function(){return[o("div",{directives:[{name:"flex",rawName:"v-flex",value:{dir:"column"},expression:"{ dir: 'column' }"}]},[o("input-radio",{attrs:{value:"OFF"},model:{value:e.dns,callback:function(r){e.dns=r},expression:"dns"}},[o("span",{domProps:{textContent:e._s(e.$gettext("None"))}})]),e._v(" "),o("input-radio",{attrs:{value:"TWO"},model:{value:e.dns,callback:function(r){e.dns=r},expression:"dns"}},[o("span",{domProps:{textContent:e._s(e.$gettext("Uses 2 IP's, domain uses one of them"))}})]),e._v(" "),o("input-radio",{attrs:{value:"Three"},model:{value:e.dns,callback:function(r){e.dns=r},expression:"dns"}},[o("span",{domProps:{textContent:e._s(e.$gettext("Uses 3 IP's, domain gets own IP"))}})])],1)]},proxy:!0}])}),e._v(" "),o("ui-form-element",{scopedSlots:e._u([{key:"title",fn:function(){return[o("span",{domProps:{textContent:e._s(e.$gettext("Share Server IP"))}})]},proxy:!0},{key:"content",fn:function(){return[o("input-checkbox",{model:{value:e.serverip,callback:function(r){e.serverip=r},expression:"serverip"}},[o("span",{domProps:{textContent:e._s(e.$gettext("Allow Reseller to create sites with server IP"))}})])]},proxy:!0}])}),e._v(" "),e.canOverrideHome?o("ui-form-element",{scopedSlots:e._u([{key:"title",fn:function(){return[o("span",{domProps:{textContent:e._s(e.$gettext("Home Directory"))}})]},proxy:!0},{key:"content",fn:function(){return[o("div",[o("input-select",{attrs:{options:e.homeOverride.options},model:{value:e.homeOverride.value,callback:function(r){e.$set(e.homeOverride,"value",r)},expression:"homeOverride.value"}})],1)]},proxy:!0}],null,!1,1883137892)}):e._e(),e._v(" "),e._l(e.customItems,function(r){return o("ui-form-element",{key:r.name,scopedSlots:e._u([{key:"title",fn:function(){return[o("span",{domProps:{textContent:e._s(r.label)}})]},proxy:!0},{key:"content",fn:function(){return[r.type==="checkbox"?o("input-checkbox",{model:{value:r.value,callback:function(l){e.$set(r,"value",l)},expression:"customItem.value"}},[e._v(`
                `+e._s(r.description)+`
            `)]):o(r.type==="text"?"input-text":"input-select",{tag:"component",attrs:{options:r.type==="listbox"?r.options:[]},scopedSlots:e._u([{key:"additions:right",fn:function(){return[o("ui-button",[e._v(`
                        `+e._s(r.description)+`
                    `)])]},proxy:!0}],null,!0),model:{value:r.value,callback:function(l){e.$set(r,"value",l)},expression:"customItem.value"}})]},proxy:!0}],null,!0)})}),e._v(" "),o("cgroups-editor",{attrs:{options:e.$api.package.cgroup},on:{"update:cgroup-values":function(r){e.cgroupValues=r}},scopedSlots:e._u([{key:"tooltip",fn:function(){return[o("span",{domProps:{textContent:e._s(e.$gettext("Set maximum values reseller could set for his users."))}})]},proxy:!0}])})],2)},p=[],g=d("./js/stores/index.ts"),O=d("./js/api/commands/admin/users/packages.js"),P=d("./js/components/local/cgroups-editor.vue"),m=d("./js/modules/utils/index.js"),_=d("../node_modules/ramda/es/index.js");const h=(u,e)=>_.zGw(_.Zpf,_.hXT(o=>u(...o)),_.Pen)(e);var i={components:{CgroupsEditor:P.Z},api:[{command:O.xp,bind:"package"}],props:{package:{type:String,required:!1,default:"newpackage"}},data(){return{limits:[],features:[],customItems:[],dns:"OFF",serverip:!0,ips:"0",homeOverride:{value:"",options:{}},cgroupValues:{}}},computed:{processedData(){const u=(r,l,v)=>({...r,[v]:["bandwidth","quota"].includes(v)?String(l.value/1048576):l.value,[`u${v}`]:l.unlimited||null}),e=r=>r?"ON":null,o=(r,l)=>({...r,[l.name]:l.value===!0?"ON":l.value});return{...m._.reduce(this.limits,u,{}),...m._.reduce(this.customItems,o,{}),...m._.mapValues(this.features,e),...this.cgroupValues,serverip:this.serverip?"ON":null,dns:this.dns,ips:this.ips,create_user_home_override:this.canOverrideHome?this.homeOverride.value:null}},canOverrideHome(){return this.homeOverride&&!!Object.keys(this.homeOverride.options).length},enabledFeatureLabels(){return h((u,e)=>e&&typeof this.features[u]!="undefined",this.featureLabels)},enabledLimitLabels(){return h((u,e)=>e&&this.limits[u],this.limitLabels)},...(0,g.Kc)(["client"])},watch:{processedData(u){this.$emit("update",u)}},created(){this.limitLabels={bandwidth:this.$gettext("Bandwidth"),quota:this.$gettext("Disk Space"),inode:this.$_flags.server.inode?this.$gettext("Inode"):void 0,vdomains:this.$gettext("Domains"),nsubdomains:this.$gettext("Sub-Domains"),nemails:this.$gettext("E-mail Accounts"),nemailf:this.$gettext("E-mail Forwarders"),nemailml:this.$gettext("Mailing Lists"),nemailr:this.$gettext("Autoresponders"),mysql:this.$gettext("MySQL Databases"),domainptr:this.$gettext("Domain Pointers"),ftp:this.$gettext("FTP Accounts"),nusers:this.$gettext("User Accounts")},this.featureLabels={aftp:this.$gettext("Anonymous FTP Accounts"),cgi:this.$gettext("CGI Access"),git:this.$gettext("Git"),wordpress:this.$gettext("Wordpress"),clamav:this.$gettext("ClamAV"),nginx_unit:this.$gettext("Nginx Unit"),php:this.$gettext("PHP Access"),spam:this.$gettext("SpamAssassin"),catchall:this.$gettext("Catch-All E-mail"),ssl:this.$gettext("SSL Access"),ssh:this.$gettext("SSH Access"),userssh:this.$gettext("SSH Access for Users"),redis:this.$gettext("Redis"),oversell:this.$gettext("Allow Overselling"),cron:this.$gettext("Cron Jobs"),sysinfo:this.$gettext("System Info"),login_keys:this.$gettext("Login Keys"),dnscontrol:this.$gettext("DNS Control")};const u=this.$_ctx.session.features.server;u.redis===!1&&delete this.featureLabels.redis,u.wordpress===!1&&delete this.featureLabels.wordpress,u.git===!1&&delete this.featureLabels.git,u.clamav===!1&&delete this.featureLabels.clamav,u.unit===!1&&delete this.featureLabels.nginx_unit;const e=this.$api.package;this.limits=m._.cloneDeep(e.limits),this.features=m._.cloneDeep(e.features),this.customItems=m._.cloneDeep(e.customItems),this.ips=e.ips||0,this.homeOverride=m._.cloneDeep(e.homeOverride),this.serverip=e.features.serverip,this.dns=e.dns,this.package===null&&(this.limits.bandwidth.value*=2**20,this.limits.quota.value*=2**20)},methods:{checkEmptyness(u){u.value||(u.unlimited=!0)}}},t=i,n=d("../node_modules/vue-style-loader/index.js!../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/admin/reseller-packages/_components/reseller-package.vue?vue&type=style&index=0&id=f2519850&prod&lang=scss&"),a=d("../node_modules/vue-loader/lib/runtime/componentNormalizer.js"),c=(0,a.Z)(t,s,p,!1,null,null,null),N=c.exports},"../node_modules/vue-style-loader/index.js!../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/admin/reseller-packages/_components/reseller-package.vue?vue&type=style&index=0&id=f2519850&prod&lang=scss&":function(x,f,d){var s=d("../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/admin/reseller-packages/_components/reseller-package.vue?vue&type=style&index=0&id=f2519850&prod&lang=scss&");s.__esModule&&(s=s.default),typeof s=="string"&&(s=[[x.id,s,""]]),s.locals&&(x.exports=s.locals);var p=d("../node_modules/vue-style-loader/lib/addStylesClient.js").Z,g=p("1f8a6b52",s,!0,{})}}]);
