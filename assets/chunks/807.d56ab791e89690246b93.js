(self.webpackChunk=self.webpackChunk||[]).push([[807,8952],{"./js/vue-globals/mixins.js":function(f,d,n){"use strict";n.r(d),n.d(d,{$bindTab:function(){return S},$clickOutside:function(){return g},$resizeListener:function(){return P},$scrollListener:function(){return T}});var i=n("../node_modules/vue/dist/vue.common.prod.js"),a=n.n(i),c=n("../node_modules/ramda/es/index.js"),s=n("./js/modules/file.js"),u=n("./js/modules/utils/index.js"),m=n("./js/modules/constants.js"),h=n("./js/modules/utils/css.js"),x=n("../node_modules/punycode/punycode.es6.js"),v=n("./js/vue-globals/helpers.js"),y=n("./js/stores/index.ts");const b=n("./js/vue-globals/mixins sync recursive \\.js$");(0,s.s)(b,l=>a().mixin(l.module)),a().mixin({data:()=>({isMounted:!1}),mounted(){this.isMounted=!0}}),a().mixin({methods:{$dialog(l){return{open:()=>v.uY.emit("dialog:open",l),close:()=>v.uY.emit("dialog:close",l)}}}}),a().mixin({computed:{$domain(){return this.$_ctx.session.domain},$domainUnicode(){return x.ZP.toUnicode(this.$domain)}}}),a().mixin({beforeCreate(){const l=(0,y.oR)(PiniaStores.VALIDATION);this.$valid=l.isValid.bind(l)}}),a().mixin({created(){this.regexps=m.gk}}),a().mixin({computed:{$p6e(){const l=p=>_=>{try{return p(_)}catch(r){return _}};return{toA:l(x.ZP.toASCII),toU:l(x.ZP.toUnicode),email2ascii:p=>{if(!p||!p.includes("@"))return p;const[_,r]=p.split("@");return[_,x.ZP.toASCII(r)].join("@")},email2unicode:p=>{if(!p||!p.includes("@"))return p;const[_,r]=p.split("@");return[_,x.ZP.toUnicode(r)].join("@")}}}}}),a().mixin({computed:{$_layout:(0,v.YM)("skin/layout")}}),a().mixin({methods:{$_useStore(l){return(0,y.oR)(l)}}});const k=[];document.body.addEventListener("click",l=>{k.forEach(p=>p(l.target))}),window.addEventListener("touchmove",l=>{k.forEach(p=>p(l.target))});const g={methods:{$clickOutsideListener(l,p){const _=e=>c.zGw(c.Bxt(p),c.qhW(Array.isArray,t=>[t]),c.hXT(c.CyQ(c.kKJ)),c.YPD(t=>t===e||t.contains(e)))(),r=e=>{_(e)&&this.$emit(`clickOutside:${l}`)};k.push(r)}}},T={methods:{__getScroller(){return this.$_layout==="sidebar"?window.document.querySelector("main"):window},__emitScroll(){this.$emit("window:scroll",window.pageYOffset)}},mounted(){const l=this.__getScroller();l&&l.addEventListener("scroll",this.__emitScroll)},destroyed(){const l=this.__getScroller();l&&l.removeEventListener("scroll",this.__emitScroll)}},D=[];window.addEventListener("resize",()=>{D.forEach(l=>l())});const P={created(){this.$resizeListener=()=>{this.$emit("window:resize",window.innerWidth)},D.push(this.$resizeListener)},destroyed(){D.splice(D.indexOf(this.$resizeListener),1)}},S=({param:l="tab",defaultTab:p}={param:"tab"})=>({computed:{[l]:{get(){return this.$route.params[l]||p},set(_){this.$route.params[l]!==_&&this.$router.replace(u._.merge({},this.$route,{params:{[l]:_}}))}}}})},"./js/vue-globals/mixins/bindApi.js":function(f,d,n){"use strict";n.r(d);var i=n("../node_modules/ramda/es/index.js");const a=(c,s)=>i.ETc(c.split("."),s);d.default={beforeCreate(){this.$options.commands&&(this.$commands=this.$options.commands)},computed:{$api(){if(!this.$options.api)return[];const c=this.$options.api;return typeof c=="function"?c.data.response:i.u4g((u,{command:m,bind:h})=>{if(typeof h=="string")return{...u,[h]:m.data.response};const x=i.u4g((v,[y,b])=>{const k=y.includes(".")?a(y,m.data):m.data[y]||m.data.response[y];return{...v,[b]:k}},{},i.Zpf(h));return{...u,...x}},{},c)}}}},"./js/vue-globals/mixins/local/clickOutside.js":function(f,d,n){"use strict";n.r(d),n.d(d,{$clickOutside:function(){return s}});var i=n("../node_modules/ramda/es/index.js");const a=[];document.body.addEventListener("click",u=>{a.forEach(i.gH4(u))}),window.addEventListener("touchstart",u=>{a.forEach(i.gH4(u))});const c=(u,m)=>i.zGw(i.qhW(Array.isArray,h=>[h]),i.hXT(i.CyQ(i.kKJ)),i.YPD(h=>h===u||h.contains(u)))(m),s={methods:{$clickOutsideListener(u,m){const h=x=>{c(x.target,m)&&this.$emit(`clickOutside:${u}`)};a.push(h)}}}},"./js/vue-globals/mixins/local/inputValidation.js":function(f,d,n){"use strict";n.r(d),n.d(d,{$inputValidation:function(){return c}});var i=n("./js/vue-globals/helpers.js"),a=n("./js/stores/index.ts");const c={inject:{groupID:{default:null},inputID:{default:null},validators:{default:()=>({})}},props:{id:{type:String,required:!1,default(){return this.inputID}},group:{type:String,required:!1,default(){return this.groupID}},novalidate:{type:Boolean,required:!1,default(){return!Object.keys(this.validators).length}}},computed:{validationStore(){return(0,a.oR)(PiniaStores.VALIDATION)},valid(){return this.validationStore.isValid(this.group,this.id)},errorState(){return!this.novalidate&&this.isUpdated&&!this.valid},isUpdated(){var s;const u=(s=this.validationStore.groups[this.group])==null?void 0:s[this.id];return typeof u=="undefined"?!1:u.updated}},methods:{$validate(s){this.id&&!this.novalidate&&this.validationStore.validate(this.groupID,this.id,s,this.validators)}},created(){if(!this.novalidate){const{validate:s}=this.$options;s&&this.$watch(s,(0,i.Ds)(this.$validate,{trailing:!0,leading:!1,delay:200}),{immediate:!0})}},destroyed(){this.novalidate||this.validationStore.deleteInput(this.group,this.id)}}},"./js/vue-globals/mixins/notification.js":function(f,d,n){"use strict";n.r(d);var i=n("./js/composables/index.ts");d.default={created(){const a=new i.d$;this.$notifications=a}}},"./js/vue-globals/mixins/reloadApiTable.js":function(f,d,n){"use strict";n.r(d);var i=n("./js/modules/constants.js");const a=s=>s.$options&&s.$options.name==="UiApiTable",c=s=>{const u=[s];let m=s;for(;m=u.shift();){if(a(m))return m;m.$children.length&&u.push(...m.$children)}return!1};d.default={methods:{$reloadApiTable({reset:s=!0}={}){const u=c(this);if(!u){i.Vi.DEV&&console.warn("$reloadApiTable called without any ui-api-table child");return}u.reloadTable(),s&&Object.assign(this.$data,this.$options.data.apply(this))}}}},"./js/vue-globals/mixins/session.js":function(f,d,n){"use strict";n.r(d);var i=n("./js/context/index.ts");d.default={computed:{$_ctx(){return i.T},$_flags(){return i.T.session.features},$_session(){return i.T.session.allValues}},methods:{$_cmd(a){return i.T.session.allowedCommands.includes(a)}}}},"./js/vue-globals/mixins/staticData.js":function(f,d,n){"use strict";n.r(d),d.default={created(){this.$options.staticData&&Object.entries(this.$options.staticData).forEach(([i,a])=>{this[i]=typeof a=="function"?a.bind(this)():a})}}},"../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/admin/system-backup.vue?vue&type=style&index=0&id=f8d64fa6&prod&lang=scss&":function(){},"./js/pages/admin/system-backup.vue":function(f,d,n){"use strict";n.r(d),n.d(d,{default:function(){return _}});var i=function(){var e=this,t=e._self._c;return t("app-page",{attrs:{id:"system-backup",actions:[{handler:e.systemBackup,label:e.$gettext("Run System Backup"),icon:"#console"}]},scopedSlots:e._u([{key:"default",fn:function(){return[t("app-page-section",[t("ui-tabs",{attrs:{tabs:[{id:"basic",label:e.$gettext("Basic Configuration"),desc:e.$gettext("Configure full system Backup")},{id:"remote",label:e.$gettext("Remote Transfer"),desc:e.$gettext("Configure Remote Transfer option")},{id:"directories",label:e.$gettext("Directories"),desc:e.$gettext("Choose directories to backup")},{id:"files",label:e.$gettext("Files"),desc:e.$gettext("Choose files to backup")}],selected:e.tab,disabled:!e.$valid("systemBackup")},on:{"update:selected":function(o){e.tab=o}},scopedSlots:e._u([{key:"tab:basic",fn:function(){return[t("div",[t("ui-form-element",{attrs:{group:"systemBackup",validators:{required:!0}},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("Backup Path"))}})]},proxy:!0},{key:"content",fn:function(){return[t("input-text",{model:{value:e.backupPath,callback:function(o){e.backupPath=o},expression:"backupPath"}})]},proxy:!0}])}),e._v(" "),t("ui-form-element",{attrs:{group:"systemBackup",validators:{required:!0}},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("Minimum disk space required for backup (MB)"))}})]},proxy:!0},{key:"content",fn:function(){return[t("ui-input-group",{scopedSlots:e._u([{key:"additions:left",fn:function(){return[t("input-text",{staticClass:"minDisk",attrs:{number:""},model:{value:e.minDisk,callback:function(o){e.minDisk=o},expression:"minDisk"}})]},proxy:!0},{key:"input",fn:function(){return[t("input-select",{attrs:{novalidate:"",options:e.options.selects.mountPoint},scopedSlots:e._u([{key:"additions:left",fn:function(){return[t("ui-button",{attrs:{disabled:""}},[t("span",{staticClass:"wrap:nowrap",domProps:{textContent:e._s(e.$gettext("on partition"))}})])]},proxy:!0}]),model:{value:e.mountPoint,callback:function(o){e.mountPoint=o},expression:"mountPoint"}})]},proxy:!0}])})]},proxy:!0}])}),e._v(" "),t("ui-form-element",{scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("Backup"))}})]},proxy:!0},{key:"content",fn:function(){return[t("div",{directives:[{name:"flex",rawName:"v-flex",value:{dir:"column"},expression:"{ dir: 'column' }"}]},[t("input-checkbox",{attrs:{value:"httpd"},model:{value:e.backup,callback:function(o){e.backup=o},expression:"backup"}},[t("span",{domProps:{textContent:e._s(e.$gettext("HTTPD data"))}})]),e._v(" "),t("input-checkbox",{attrs:{value:"dns"},model:{value:e.backup,callback:function(o){e.backup=o},expression:"backup"}},[t("span",{domProps:{textContent:e._s(e.$gettext("DNS data"))}})]),e._v(" "),t("input-checkbox",{attrs:{value:"mysql"},model:{value:e.backup,callback:function(o){e.backup=o},expression:"backup"}},[t("span",{domProps:{textContent:e._s(e.$gettext("MySQL Databases"))}})]),e._v(" "),t("input-checkbox",{attrs:{value:"custom"},model:{value:e.backup,callback:function(o){e.backup=o},expression:"backup"}},[t("span",{domProps:{textContent:e._s(e.$gettext("Custom Directories & Files"))}})])],1)]},proxy:!0}])}),e._v(" "),t("ui-form-element",{attrs:{"vertical-on-phone":!1,reverse:e.clientStore.isPhone,underline:!1},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("Add user home directories to directory list"))}})]},proxy:!0},{key:"content",fn:function(){return[t("input-checkbox",{model:{value:e.homeDirs,callback:function(o){e.homeDirs=o},expression:"homeDirs"}})]},proxy:!0}])})],1)]},proxy:!0},{key:"tab:remote",fn:function(){return[t("div",[t("ui-form-element",{attrs:{"vertical-on-phone":!1,reverse:e.clientStore.isPhone,underline:!e.clientStore.isPhone},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("Use Remote Transfer"))}})]},proxy:!0},{key:"content",fn:function(){return[t("input-checkbox",{model:{value:e.remoteTransfer,callback:function(o){e.remoteTransfer=o},expression:"remoteTransfer"}})]},proxy:!0}])}),e._v(" "),t("ui-form-element",{scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("Remote transfer method"))}})]},proxy:!0},{key:"content",fn:function(){return[t("input-select",{attrs:{options:e.options.selects.transferMethod},model:{value:e.remoteTransferData.method,callback:function(o){e.$set(e.remoteTransferData,"method",o)},expression:"remoteTransferData.method"}}),e._v(" "),e.remoteTransferData.method==="scp"?t("ui-link",{attrs:{href:"/CMD_FILE_MANAGER/.ssh/id_rsa.pub"}},[t("span",{domProps:{textContent:e._s(e.$gettext("Link to id_rsa.pub (should be inserted into ~/user/.ssh/authorized_keys)"))}})]):e._e()]},proxy:!0}])}),e._v(" "),t("ui-form-element",{attrs:{"vertical-on-phone":!1,reverse:e.clientStore.isPhone,underline:!e.clientStore.isPhone},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("Delete the local backup after remote transfer"))}})]},proxy:!0},{key:"content",fn:function(){return[t("input-checkbox",{model:{value:e.remoteTransferData.deleteAfter,callback:function(o){e.$set(e.remoteTransferData,"deleteAfter",o)},expression:"remoteTransferData.deleteAfter"}})]},proxy:!0}])}),e._v(" "),t("ui-form-element",{attrs:{"vertical-on-phone":!1,reverse:e.clientStore.isPhone,underline:!e.clientStore.isPhone},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("Incremental file-by-file backup"))}})]},proxy:!0},{key:"tooltip",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("Deletes local file before creating the next one"))}})]},proxy:!0},{key:"content",fn:function(){return[t("input-checkbox",{model:{value:e.remoteTransferData.incremental,callback:function(o){e.$set(e.remoteTransferData,"incremental",o)},expression:"remoteTransferData.incremental"}})]},proxy:!0}])}),e._v(" "),t("ui-form-element",{attrs:{group:"systemBackup",validators:{required:!0}},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("Remote Host"))}})]},proxy:!0},{key:"content",fn:function(){return[t("input-text",{model:{value:e.remoteTransferData.host,callback:function(o){e.$set(e.remoteTransferData,"host",o)},expression:"remoteTransferData.host"}})]},proxy:!0}])}),e._v(" "),t("ui-form-element",{attrs:{group:"systemBackup",validators:{required:!0}},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("Remote User"))}})]},proxy:!0},{key:"content",fn:function(){return[t("input-text",{model:{value:e.remoteTransferData.user,callback:function(o){e.$set(e.remoteTransferData,"user",o)},expression:"remoteTransferData.user"}})]},proxy:!0}])}),e._v(" "),t("ui-form-element",{attrs:{group:"systemBackup",validators:{required:!0}},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("Remote Password"))}})]},proxy:!0},{key:"content",fn:function(){return[t("input-password",{model:{value:e.remoteTransferData.password,callback:function(o){e.$set(e.remoteTransferData,"password",o)},expression:"remoteTransferData.password"}})]},proxy:!0}])}),e._v(" "),t("ui-form-element",{attrs:{group:"systemBackup",validators:{required:!0}},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("Remote Path"))}})]},proxy:!0},{key:"content",fn:function(){return[t("input-text",{model:{value:e.remoteTransferData.path,callback:function(o){e.$set(e.remoteTransferData,"path",o)},expression:"remoteTransferData.path"}})]},proxy:!0}])})],1)]},proxy:!0},{key:"tab:directories",fn:function(){return[t("div",[t("keep-alive",[t("ui-r-table",e._b({key:"dirs",attrs:{"checked-rows":e.checkedDirs,"disable-pagination":"","hide-before-controls":""},on:{"update:checkedRows":e.setDirs},scopedSlots:e._u([{key:"table:actions",fn:function(){return[t("ui-table-action",{on:{click:e.deleteDirs}},[t("span",{domProps:{textContent:e._s(e.$gettext("Delete"))}})])]},proxy:!0},{key:"table:after",fn:function(){return[t("ui-input-group",{scopedSlots:e._u([{key:"input",fn:function(){return[t("input-text",{on:{keyup:function(o){return!o.type.indexOf("key")&&e._k(o.keyCode,"enter",13,o.key,"Enter")?null:e.addDir.apply(null,arguments)}},model:{value:e.directory,callback:function(o){e.directory=o},expression:"directory"}})]},proxy:!0},{key:"additions:right",fn:function(){return[t("ui-button",{attrs:{theme:"safe",disabled:!e.directory},on:{click:e.addDir}},[t("span",{domProps:{textContent:e._s(e.$gettext("Add"))}})])]},proxy:!0}])})]},proxy:!0}])},"ui-r-table",{rows:e.options.directories,rowsCount:e.options.directories.length,columns:[{id:"directory",label:e.$gettext("Directories")}]},!1))],1)],1)]},proxy:!0},{key:"tab:files",fn:function(){return[t("div",[t("keep-alive",[t("ui-r-table",e._b({key:"files",attrs:{"checked-rows":e.checkedFiles,"disable-pagination":"","hide-before-controls":""},on:{"update:checkedRows":e.setFiles},scopedSlots:e._u([{key:"table:actions",fn:function(){return[t("ui-table-action",{on:{click:e.deleteFiles}},[t("span",{domProps:{textContent:e._s(e.$gettext("Delete"))}})])]},proxy:!0},{key:"table:after",fn:function(){return[t("ui-input-group",{scopedSlots:e._u([{key:"input",fn:function(){return[t("input-text",{model:{value:e.file,callback:function(o){e.file=o},expression:"file"}})]},proxy:!0},{key:"additions:right",fn:function(){return[t("ui-button",{attrs:{theme:"safe",disabled:!e.file},on:{click:e.addFile}},[t("span",{domProps:{textContent:e._s(e.$gettext("Add"))}})])]},proxy:!0}])})]},proxy:!0}])},"ui-r-table",{rows:e.options.files,rowsCount:e.options.files.length,columns:[{id:"file",label:e.$gettext("Files")}]},!1))],1)],1)]},proxy:!0}])})],1),e._v(" "),t("ui-dialog",{attrs:{id:"VIEW_BACKUP_LOG_DIALOG",size:"normal",title:e.$gettext("View Last Backup Log")},scopedSlots:e._u([{key:"content",fn:function(){return[t("div",{staticClass:"log-wrapper"},[t("iframe",{attrs:{src:"/CMD_SYSTEM_BACKUP/status.log.txt",frameborder:"0"}})])]},proxy:!0}])}),e._v(" "),t("ui-dialog",{attrs:{id:"CRON_SCHEDULE_DIALOG",title:e.$gettext("Cron Schedule")},scopedSlots:e._u([{key:"content",fn:function(){return[t("ui-form-element",{attrs:{vertical:""},scopedSlots:e._u([{key:"content",fn:function(){return[t("input-checkbox",{model:{value:e.cronData.use_cron,callback:function(o){e.$set(e.cronData,"use_cron",o)},expression:"cronData.use_cron"}},[t("span",{domProps:{textContent:e._s(e.$gettext("Use Cron for Backup"))}})])]},proxy:!0}])}),e._v(" "),t("ui-form-element",{attrs:{vertical:"",group:"cronSchedule",validators:{required:!0}},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("Minute"))}})]},proxy:!0},{key:"content",fn:function(){return[t("input-text",{model:{value:e.cronData.minute,callback:function(o){e.$set(e.cronData,"minute",o)},expression:"cronData.minute"}})]},proxy:!0},{key:"tooltip",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("0-59"))}})]},proxy:!0}])}),e._v(" "),t("ui-form-element",{attrs:{vertical:"",group:"cronSchedule",validators:{required:!0}},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("Hour"))}})]},proxy:!0},{key:"content",fn:function(){return[t("input-text",{model:{value:e.cronData.hour,callback:function(o){e.$set(e.cronData,"hour",o)},expression:"cronData.hour"}})]},proxy:!0},{key:"tooltip",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("0-23"))}})]},proxy:!0}])}),e._v(" "),t("ui-form-element",{attrs:{vertical:"",group:"cronSchedule",validators:{required:!0}},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("Day of Month"))}})]},proxy:!0},{key:"content",fn:function(){return[t("input-text",{model:{value:e.cronData.dayofmonth,callback:function(o){e.$set(e.cronData,"dayofmonth",o)},expression:"cronData.dayofmonth"}})]},proxy:!0},{key:"tooltip",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("1-31"))}})]},proxy:!0}])}),e._v(" "),t("ui-form-element",{attrs:{vertical:"",group:"cronSchedule",validators:{required:!0}},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("Month"))}})]},proxy:!0},{key:"content",fn:function(){return[t("input-text",{model:{value:e.cronData.month,callback:function(o){e.$set(e.cronData,"month",o)},expression:"cronData.month"}})]},proxy:!0},{key:"tooltip",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("1-12"))}})]},proxy:!0}])}),e._v(" "),t("ui-form-element",{attrs:{vertical:""},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("Day of Week"))}})]},proxy:!0},{key:"content",fn:function(){return[t("input-text",{model:{value:e.cronData.dayofweek,callback:function(o){e.$set(e.cronData,"dayofweek",o)},expression:"cronData.dayofweek"}})]},proxy:!0},{key:"tooltip",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("0-7; 0,7 - Sunday"))}})]},proxy:!0}])})]},proxy:!0},{key:"buttons",fn:function(){return[t("ui-button",{attrs:{theme:"primary","validate-group":"cronSchedule"},on:{click:e.saveCron}},[t("span",{domProps:{textContent:e._s(e.$gettext("Save"))}})])]},proxy:!0}])})]},proxy:!0},{key:"footer:buttons",fn:function(){return[t("ui-button",{attrs:{"validate-group":"systemBackup",theme:"primary"},on:{click:e.saveOptions}},[t("span",{domProps:{textContent:e._s(e.$gettext("Save"))}})])]},proxy:!0},{key:"bottom:links",fn:function(){return[e.options.hasLog?t("ui-link",{attrs:{bullet:""},on:{click:function(o){e.$dialog("VIEW_BACKUP_LOG_DIALOG").open()}}},[t("span",{domProps:{textContent:e._s(e.$gettext("View Last Backup Log"))}})]):e._e(),e._v(" "),t("ui-link",{attrs:{bullet:""},on:{click:function(o){e.$dialog("CRON_SCHEDULE_DIALOG").open()}}},[t("span",{domProps:{textContent:e._s(e.$gettext("Cron Schedule"))}})])]},proxy:!0}])})},a=[],c=n("./js/stores/index.ts"),s=n("./js/api/command/index.js");const u=(r,e={})=>s.Z.post({url:"/CMD_SYSTEM_BACKUP",params:{action:r},schema:e}),m=s.Z.get({url:"/CMD_SYSTEM_BACKUP",id:"SYSTEM_BACKUP_OPTIONS",after:r=>r.flow(r.project({backupPath:"BACKUP_PATH",minDisk:"MIN_DISK",mountPoint:"MOUNT_POINT","backup.httpd":"HTTP_BK","backup.mysql":"MYSQL_BK","backup.dns":"BIND_BK","backup.custom":"CUSTOM_BK",remoteTransfer:"USE_RTRANS","remoteTransferData.method":"RTRANS_METHOD","remoteTransferData.deleteAfter":"DEL_AFTERTRANS","remoteTransferData.incremental":"FBF_RTRANS","remoteTransferData.host":"FTP_HOST","remoteTransferData.user":"FTP_USER","remoteTransferData.password":"FTP_PASS","remoteTransferData.path":"FTP_RPATH",directories:"directories",files:"files","cronData.use_cron":"cron.CRON","cronData.minute":"cron.MINUTE","cronData.hour":"cron.HOUR","cronData.dayofmonth":"cron.DAY","cronData.month":"cron.MONTH","cronData.dayofweek":"cron.DAYOFWEEK","selects.mountPoint":"MOUNT_POINT","selects.transferMethod":"RTRANS_SELECT",hasLog:"LOG_TIME",logTime:"LOG_TIME"}),r.mapProps({mountPoint:r.flow(r.find(r.getProp("selected")),r.getProp("value")),backup:e=>Object.keys(e).filter(o=>e[o]==="1"),remoteTransfer:r.isEqual("1"),remoteTransferData:r.mapProps({deleteAfter:r.isEqual("1"),incremental:r.isEqual("1")}),selects:r.mapProps({mountPoint:r.flow(r.toArray,r.mapArray(r.getProp("value"))),transferMethod:r.flow(r.toArray,r.mapArray(r.getProp("value")))}),directories:r.mapArray(e=>({directory:e})),files:r.mapArray(e=>({file:e})),cronData:r.mapProps({use_cron:r.convert.toAppBoolean}),hasLog:r.convert.toAppBoolean,logTime:e=>e&&r.convert.toAppDate(e)}))}),h=u("now"),x=u("deletedirs",{select:s.Z.ROWS}),v=u("adddirectory",{directory:s.Z.REQUIRED_STRING}),y=u("deletefiles",{select:s.Z.ROWS}),b=u("addfile",{file:s.Z.REQUIRED_STRING}),k=u("setting",{BACKUP_PATH:s.Z.REQUIRED_STRING,MIN_DISK:s.Z.REQUIRED_STRING,MOUNT_POINT:s.Z.REQUIRED_STRING,ADD_USERS_TO_LIST:s.Z.REQUIRED_BOOL,HTTP_BK:s.Z.REQUIRED_BOOL,BIND_BK:s.Z.REQUIRED_BOOL,MYSQL_BK:s.Z.REQUIRED_BOOL,CUSTOM_BK:s.Z.REQUIRED_BOOL,USE_RTRANS:s.Z.REQUIRED_BOOL,RTRANS_METHOD:s.Z.REQUIRED_STRING,DEL_AFTERTRANS:s.Z.REQUIRED_BOOL,FBF_RTRANS:s.Z.REQUIRED_BOOL,FTP_HOST:s.Z.REQUIRED_STRING,FTP_USER:s.Z.REQUIRED_STRING,FTP_PASS:s.Z.REQUIRED_STRING,FTP_RPATH:s.Z.REQUIRED_STRING}),g=u("when",{use_cron:s.Z.REQUIRED_BOOL,minute:s.Z.REQUIRED_STRING,hour:s.Z.REQUIRED_STRING,dayofmonth:s.Z.REQUIRED_STRING,month:s.Z.REQUIRED_STRING,dayofweek:s.Z.REQUIRED_STRING});var T=n("./js/vue-globals/mixins.js"),D={preload:m,api:[{command:m,bind:"options"}],mixins:[(0,T.$bindTab)({defaultTab:"basic",param:"tab"})],data(){return{backupPath:"",minDisk:"",mountPoint:"",backup:[],homeDirs:!1,remoteTransfer:!1,remoteTransferData:{method:"ftp",deleteAfter:!1,incremental:!1,host:"",user:"",password:"",path:""},cronData:{use_cron:!1,minute:"",hour:"",dayofmonth:"",month:"",dayofweek:""},file:"",directory:"",dirs:[],files:[]}},computed:{options(){return this.$api.options},checkedDirs(){return this.options.directories.filter(({directory:r})=>this.dirs.includes(r))},checkedFiles(){return this.options.files.filter(({file:r})=>this.files.includes(r))},requestData(){return{BACKUP_PATH:this.backupPath,MIN_DISK:this.minDisk,MOUNT_POINT:this.mountPoint,ADD_USERS_TO_LIST:this.homeDirs,HTTP_BK:this.backup.includes("httpd"),BIND_BK:this.backup.includes("dns"),MYSQL_BK:this.backup.includes("mysql"),CUSTOM_BK:this.backup.includes("custom"),USE_RTRANS:this.remoteTransfer,RTRANS_METHOD:this.remoteTransferData.method,DEL_AFTERTRANS:this.remoteTransferData.deleteAfter,FBF_RTRANS:this.remoteTransferData.incremental,FTP_HOST:this.$p6e.toA(this.remoteTransferData.host),FTP_USER:this.remoteTransferData.user,FTP_PASS:this.remoteTransferData.password,FTP_RPATH:this.remoteTransferData.path}},...(0,c.Kc)(["client"])},mounted(){this.backupPath=this.options.backupPath,this.minDisk=this.options.minDisk,this.mountPoint=this.options.mountPoint,this.backup=this.options.backup,this.remoteTransfer=this.options.remoteTransfer,Object.assign(this.remoteTransferData,this.options.remoteTransferData),this.remoteTransferData.host=this.$p6e.toU(this.options.remoteTransferData.host),Object.assign(this.cronData,this.options.cronData)},methods:{systemBackup(){h()},setFiles(r){const e=r.map(t=>t.file);e.length!==this.files.length&&(this.files=e)},setDirs(r){const e=r.map(t=>t.directory);e.length!==this.dirs.length&&(this.dirs=e)},reloadOptions(){m(),this.dirs=[],this.files=[]},deleteDirs(){x({select:this.dirs}).then(this.reloadOptions)},deleteFiles(){y({select:this.files}).then(this.reloadOptions)},addDir(){v({directory:this.directory}).then(this.reloadOptions)},async addFile(){b({file:this.file}).then(this.reloadOptions)},saveOptions(){k(this.requestData)},saveCron(){g(this.cronData)}}},P=D,S=n("../node_modules/vue-style-loader/index.js!../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/admin/system-backup.vue?vue&type=style&index=0&id=f8d64fa6&prod&lang=scss&"),l=n("../node_modules/vue-loader/lib/runtime/componentNormalizer.js"),p=(0,l.Z)(P,i,a,!1,null,null,null),_=p.exports},"../node_modules/vue-style-loader/index.js!../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/admin/system-backup.vue?vue&type=style&index=0&id=f8d64fa6&prod&lang=scss&":function(f,d,n){var i=n("../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/admin/system-backup.vue?vue&type=style&index=0&id=f8d64fa6&prod&lang=scss&");i.__esModule&&(i=i.default),typeof i=="string"&&(i=[[f.id,i,""]]),i.locals&&(f.exports=i.locals);var a=n("../node_modules/vue-style-loader/lib/addStylesClient.js").Z,c=a("108715be",i,!0,{})},"./js/vue-globals/mixins sync recursive \\.js$":function(f,d,n){var i={"./bindApi.js":"./js/vue-globals/mixins/bindApi.js","./local/clickOutside.js":"./js/vue-globals/mixins/local/clickOutside.js","./local/inputValidation.js":"./js/vue-globals/mixins/local/inputValidation.js","./notification.js":"./js/vue-globals/mixins/notification.js","./reloadApiTable.js":"./js/vue-globals/mixins/reloadApiTable.js","./session.js":"./js/vue-globals/mixins/session.js","./staticData.js":"./js/vue-globals/mixins/staticData.js","vue-globals/mixins/bindApi.js":"./js/vue-globals/mixins/bindApi.js","vue-globals/mixins/local/clickOutside.js":"./js/vue-globals/mixins/local/clickOutside.js","vue-globals/mixins/local/inputValidation.js":"./js/vue-globals/mixins/local/inputValidation.js","vue-globals/mixins/notification.js":"./js/vue-globals/mixins/notification.js","vue-globals/mixins/reloadApiTable.js":"./js/vue-globals/mixins/reloadApiTable.js","vue-globals/mixins/session.js":"./js/vue-globals/mixins/session.js","vue-globals/mixins/staticData.js":"./js/vue-globals/mixins/staticData.js"};function a(s){var u=c(s);return n(u)}function c(s){if(!n.o(i,s)){var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}return i[s]}a.keys=function(){return Object.keys(i)},a.resolve=c,f.exports=a,a.id="./js/vue-globals/mixins sync recursive \\.js$"}}]);
