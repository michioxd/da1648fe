(self.webpackChunk=self.webpackChunk||[]).push([[9113],{"./js/vue-globals/mixins/local/inputValidation.js":function(g,m,n){"use strict";n.r(m),n.d(m,{$inputValidation:function(){return d}});var l=n("./js/vue-globals/helpers.js"),p=n("./js/stores/index.ts");const d={inject:{groupID:{default:null},inputID:{default:null},validators:{default:()=>({})}},props:{id:{type:String,required:!1,default(){return this.inputID}},group:{type:String,required:!1,default(){return this.groupID}},novalidate:{type:Boolean,required:!1,default(){return!Object.keys(this.validators).length}}},computed:{validationStore(){return(0,p.oR)(PiniaStores.VALIDATION)},valid(){return this.validationStore.isValid(this.group,this.id)},errorState(){return!this.novalidate&&this.isUpdated&&!this.valid},isUpdated(){var u;const f=(u=this.validationStore.groups[this.group])==null?void 0:u[this.id];return typeof f=="undefined"?!1:f.updated}},methods:{$validate(u){this.id&&!this.novalidate&&this.validationStore.validate(this.groupID,this.id,u,this.validators)}},created(){if(!this.novalidate){const{validate:u}=this.$options;u&&this.$watch(u,(0,l.Ds)(this.$validate,{trailing:!0,leading:!1,delay:200}),{immediate:!0})}},destroyed(){this.novalidate||this.validationStore.deleteInput(this.group,this.id)}}},"../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/components/local/input-ip.vue?vue&type=style&index=0&id=7be90e6c&prod&lang=scss&":function(){},"../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/admin/brute-force-monitor/_components/ipinfo-dialog.vue?vue&type=style&index=0&id=9dd7280e&prod&lang=scss&scoped=true&":function(){},"./js/components/local/utils/cidr.ts":function(g,m,n){"use strict";n.d(m,{T:function(){return l},x:function(){return p}});const l=d=>{if(!d)return"";const u=[];let f=Number(d);for(let _=0;_<4;_++){const t=Math.min(f,8);u.push(256-2**(8-t)),f-=t}return u.join(".")},p=d=>{if(!d)return"";const u=(t,o)=>t.split(o).length-1,f=t=>(t>>>0).toString(2);return u((t=>t.split(".").map(Number))(d).map(t=>f(t)).join(""),"1")}},"./js/components/local/utils/mask-definition.ts":function(g,m,n){"use strict";n.d(m,{Xm:function(){return _}});const l={addressDefinition:(t,{buffer:o},s)=>{const a=/^([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])$/;return s-1>-1&&o[s-1]!=="."&&(o[s-2]&&o[s-2]!=="."?t=o[s-2]+o[s-1]+t:t=o[s-1]+t),a.test(t)},netmaskDefinition:(t,{buffer:o},s)=>{const a=/^3[0-2]$|^[0-2][0-9]$|^[0-9]$/;return o[s-1]!=="/"&&(t=o[s-1]+t),a.test(t)},netmaskDelimiterDefinition:t=>t==="/"},p={addressDefinition:(t,{buffer:o},s)=>{const a=/[A-Fa-f0-9]/;return s===1&&o[0]===":"?!1:a.test(t)},addressDelimiterDefinition:(t,{buffer:o},s)=>t===":"?o[s-1]===":"?!o.join("").includes("::"):!0:/[A-Fa-f0-9]/.test(t)?{insert:[{pos:s,c:":"},{pos:s+1,c:t}],caret:s+2}:!1,netmaskDefinition:(t,{buffer:o},s)=>{const a=o;a.length===s?a.push(t):a[s]=t;const r=Number(a.join("").split("/").at(-1));return r>=0&&r<=128},netmaskDelimiterDefinition:(t,{buffer:o},s)=>{if(!s)return!1;if(o[s-1]===":"&&t==="/")return s>=3&&o[s-2]===":";const[a]=o.join("").split("/"),r=a.split(":").map(v=>v.replace(/_/g,"")).join(":");return t==="/"&&r.includes(":")}},d={ipv4Definition:(t,{buffer:o},s)=>{const a=/25[0-5]|2[0-4][0-9]|[01][0-9][0-9]/;return o[s-1]!=="-"?(t=o[s-1]+t,o[s-2]!=="-"?t=o[s-2]+t:t=`0${t}`):t=`00${t}`,a.test(t)},ipv6Definition:t=>/[A-Fa-f0-9]/.test(t),delimiterDefinition:t=>t==="-"},u={ipv4:{i:{validator:l.addressDefinition,cardinality:1},n:{validator:l.netmaskDefinition,cardinality:1},"=":{validator:l.netmaskDelimiterDefinition,cardinality:1,placeholder:"/"}},ipv6:{I:{validator:p.addressDefinition,cardinality:1,casing:"lower"},N:{validator:p.netmaskDefinition},":":{validator:p.addressDelimiterDefinition,cardinality:1,placeholder:":"},"-":{validator:p.netmaskDelimiterDefinition,cardinality:1,placeholder:"/"}}},f={"!":{validator:d.delimiterDefinition,cardinality:1,placeholder:""},r:{validator:d.ipv4Definition,cardinality:1,placeholder:""},R:{validator:d.ipv6Definition,cardinality:1,placeholder:""}},_=(t,o=!1)=>{let s={};return t.forEach(a=>{s={...s,...u[a]}}),o&&(s={...s,...f}),s}},"./js/components/local/input-ip.vue":function(g,m,n){"use strict";n.d(m,{Z:function(){return j}});var l=function(){var i=this,c=i._self._c;return c("ui-input-group",{staticClass:"width:100%",scopedSlots:i._u([{key:"additions:left",fn:function(){return[i.showVersionsSelect?c("input-select",{staticClass:"input-ip-version-select",attrs:{novalidate:"",options:{v4:"IPv4",v6:"IPv6"}},on:{change:function(y){return i.$emit("update:version",y)}},model:{value:i.dataVersion,callback:function(y){i.dataVersion=y},expression:"dataVersion"}}):i._e()]},proxy:!0},{key:"input",fn:function(){return[c("input",{ref:"input",staticClass:"input-ip-mask",attrs:{type:"text"},domProps:{value:i.innerValue},on:{input:i.emit,focus:i.moveCursor}})]},proxy:!0},{key:"additions:right",fn:function(){return[i._t("additions:right",null,null,{})]},proxy:!0}],null,!0)})},p=[],d=n("../node_modules/inputmask/dist/inputmask.js"),u=n.n(d),f=n("./js/vue-globals/mixins/local/inputValidation.js"),_=n("./js/components/local/utils/cidr.ts"),t=n("./js/components/local/utils/mask-definition.ts"),o={mixins:[f.$inputValidation],validate:"value",props:{value:{type:String,required:!0},netmask:{type:String,required:!1,default:""},version:{type:String,required:!1,default:"v4"},disableVersionSelect:{type:Boolean,required:!1,default:!1},allowRange:{type:Boolean,required:!1,default:!1}},data:()=>({focused:!1,dataVersion:"v4",innerCidr:null}),computed:{showVersionsSelect(){return!this.disableVersionSelect&&this.$_flags.server.ipv6},cidr(){return this.netmask?this.dataVersion==="v4"?(0,_.x)(this.netmask):this.netmask:this.netmask},innerValue(){return this.value&&this.innerCidr!==null?`${this.value}/${this.cidr}`:this.value},mask(){let e={v4:Array(4).fill("i[i[i]]").join("."),v6:`[I[I[I[I]]]]${Array(7).fill("[:[I[I[I[I]]]]]").join("")}`}[this.dataVersion];const i={v4:"[!r[r[r]]]",v6:"[!R[R[R[R]]]]"}[this.dataVersion],c={v4:"[=[n[n]]]",v6:"[-[N[N[N]]]]"}[this.dataVersion];return this.allowRange&&(e=`${e}${i}`),typeof this.netmask!="undefined"&&(e=`${e}${c}`),e}},watch:{version(e){this.dataVersion!==e&&(this.dataVersion=e)},dataVersion(e){e!==this.version&&(this.$emit("input",""),this.$emit("update:netmask","")),this.applyMask()},innerCidr(e,i){e!==null&&(i===null&&e===""&&(this.innerCidr=this.cidr),this.emitNetmask(e))}},mounted(){this.dataVersion=this.version,this.applyMask()},methods:{emit({target:{value:e}}){const[i,c]=e.split("/");this.innerCidr=e.includes("/")?c:null,this.$emit("input",i),e||this.emitNetmask("")},emitNetmask(e){return this.$emit("update:netmask",this.dataVersion==="v4"?(0,_.T)(e):e)},moveCursor(){this.value||this.$refs.input.setSelectionRange(0,0)},applyMask(){new(u())({mask:this.mask,keepStatic:!0,definitions:(0,t.Xm)(["ipv4","ipv6"],!0),onUnMask:i=>i,skipOptionalPartCharacter:"",placeholder:"_"}).mask(this.$refs.input)}}},s=o,a=n("../node_modules/vue-style-loader/index.js!../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/components/local/input-ip.vue?vue&type=style&index=0&id=7be90e6c&prod&lang=scss&"),r=n("../node_modules/vue-loader/lib/runtime/componentNormalizer.js"),v=(0,r.Z)(s,l,p,!1,null,null,null),j=v.exports},"./js/pages/admin/brute-force-monitor/_components/ipinfo-dialog.vue":function(g,m,n){"use strict";n.d(m,{Z:function(){return s}});var l=function(){var r=this,v=r._self._c;return v("ui-dialog",{attrs:{id:"SHOW_IPINFO_DIALOG",size:"normal"},scopedSlots:r._u([{key:"title",fn:function(){return[v("span",{domProps:{textContent:r._s(r.$gettextInterpolate(r.$gettext("IP Info: %{ ip }"),{ip:r.$api.ipinfo.ip}))}})]},proxy:!0},{key:"content",fn:function(){return[v("div",[v("h2",{staticClass:"ip",domProps:{textContent:r._s(r.$api.ipinfo.ip)}}),r._v(" "),v("ol",{staticClass:"ipinfo"},r._l(r.$api.ipinfo.data,function(j){return v("li",{staticClass:"line"},[v("span",{staticClass:"line-content",domProps:{textContent:r._s(j)}})])}),0)])]},proxy:!0}])})},p=[],d=n("./js/api/commands/admin/brute-force-monitor.js"),u={api:[{command:d.ws,bind:"ipinfo"}]},f=u,_=n("../node_modules/vue-style-loader/index.js!../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/admin/brute-force-monitor/_components/ipinfo-dialog.vue?vue&type=style&index=0&id=9dd7280e&prod&lang=scss&scoped=true&"),t=n("../node_modules/vue-loader/lib/runtime/componentNormalizer.js"),o=(0,t.Z)(f,l,p,!1,null,"9dd7280e",null),s=o.exports},"./js/pages/admin/brute-force-monitor/block_list.vue":function(g,m,n){"use strict";n.r(m),n.d(m,{default:function(){return v}});var l=function(){var e=this,i=e._self._c;return i("app-page",{scopedSlots:e._u([{key:"default",fn:function(){return[i("tabs",{attrs:{id:"blocklist"}},[e.$api.scripts.block?i("ui-form-element",{scopedSlots:e._u([{key:"title",fn:function(){return[i("span",{domProps:{textContent:e._s(e.$gettext("Block IP"))}})]},proxy:!0},{key:"content",fn:function(){return[i("input-ip",{attrs:{"disable-version-select":"",version:"v4"},scopedSlots:e._u([{key:"additions:right",fn:function(){return[i("ui-button",{attrs:{size:"normal",theme:"danger"},on:{click:e.blockIP}},[i("span",{domProps:{textContent:e._s(e.$gettext("Block"))}})])]},proxy:!0}],null,!1,4206856544),model:{value:e.ip,callback:function(c){e.ip=c},expression:"ip"}})]},proxy:!0}],null,!1,3922300351)}):e._e(),e._v(" "),i("ui-api-table",e._b({on:{"action:unblock":function(c){e.$dialog("UNBLOCK_IP_DIALOG").open()}},scopedSlots:e._u([{key:"col:ipinfo",fn:function(c){return[i("ui-button-icon",{attrs:{icon:"question",theme:"primary",title:e.$gettext("IP Info")},on:{click:function(y){return e.showIPInfo(c.ip)}}})]}},{key:"col:date_blocked",fn:function({date_blocked:c}){return[e._v(`
                    `+e._s(e.date(c,"datetime"))+`
                `)]}},{key:"buttons:before",fn:function(){return[i("input-text",{attrs:{placeholder:e.$gettext("Filter IPs")},scopedSlots:e._u([{key:"additions:right",fn:function(){return[i("ui-button",{attrs:{theme:"light",icon:"close"},on:{click:function(c){e.filter=""}}})]},proxy:!0}]),model:{value:e.filter,callback:function(c){e.filter=c},expression:"filter"}})]},proxy:!0}]),model:{value:e.select,callback:function(c){e.select=c},expression:"select"}},"ui-api-table",{command:e.$commands.getBlockList,rowID:"ip",columns:{ip:{label:e.$gettext("IP"),grow:!0},date_blocked:e.$gettext("Date Blocked"),info:e.$gettext("Info"),ipinfo:e.$gettext("IP Info")},actions:{unblock:{label:e.$gettext("Unblock"),disabled:!e.$api.scripts.unblock}},filters:e.filter?[{column:"ip",value:e.filter,type:"contains"}]:[]},!1))],1),e._v(" "),i("ui-dialog",{attrs:{id:"UNBLOCK_IP_DIALOG",theme:"danger",title:e.$ngettext("Unblock IP","Unblock IPs",e.select.length)},scopedSlots:e._u([{key:"content",fn:function(){return[i("span",{domProps:{textContent:e._s(e.$ngettext("Are you sure you want to unblock selected IP?","Are you sure you want to unblock selected IPs?",e.select.length))}})]},proxy:!0},{key:"buttons",fn:function(){return[i("ui-button",{attrs:{theme:"danger"},on:{click:e.unblockIP}},[i("span",{domProps:{textContent:e._s(e.$gettext("Remove"))}})])]},proxy:!0}])}),e._v(" "),i("ipinfo-dialog")]},proxy:!0}])})},p=[],d=n("./js/api/commands/admin/brute-force-monitor.js"),u=n("./js/composables/filters.ts"),f=n("./js/components/local/input-ip.vue"),_=n("./js/pages/admin/brute-force-monitor/_components/tabs.vue"),t=n("./js/pages/admin/brute-force-monitor/_components/ipinfo-dialog.vue"),o={preload:[d.JA,d.JP],api:[{command:d.JP,bind:{"response.scripts":"scripts"}}],commands:{getBlockList:d.JA},components:{Tabs:_.Z,IpinfoDialog:t.Z,InputIp:f.Z},data:()=>({select:[],ip:"",filter:""}),methods:{date:u.hT,unblockIP(){(0,d.h2)({ip:this.select}).then(this.$reloadApiTable)},async showIPInfo(j){await(0,d.ws)({ipinfo:j}),this.$dialog("SHOW_IPINFO_DIALOG").open()},blockIP(){(0,d.Ge)({ip:[this.ip]}).then(this.$reloadApiTable)}}},s=o,a=n("../node_modules/vue-loader/lib/runtime/componentNormalizer.js"),r=(0,a.Z)(s,l,p,!1,null,null,null),v=r.exports},"../node_modules/vue-style-loader/index.js!../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/components/local/input-ip.vue?vue&type=style&index=0&id=7be90e6c&prod&lang=scss&":function(g,m,n){var l=n("../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/components/local/input-ip.vue?vue&type=style&index=0&id=7be90e6c&prod&lang=scss&");l.__esModule&&(l=l.default),typeof l=="string"&&(l=[[g.id,l,""]]),l.locals&&(g.exports=l.locals);var p=n("../node_modules/vue-style-loader/lib/addStylesClient.js").Z,d=p("61c82612",l,!0,{})},"../node_modules/vue-style-loader/index.js!../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/admin/brute-force-monitor/_components/ipinfo-dialog.vue?vue&type=style&index=0&id=9dd7280e&prod&lang=scss&scoped=true&":function(g,m,n){var l=n("../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/admin/brute-force-monitor/_components/ipinfo-dialog.vue?vue&type=style&index=0&id=9dd7280e&prod&lang=scss&scoped=true&");l.__esModule&&(l=l.default),typeof l=="string"&&(l=[[g.id,l,""]]),l.locals&&(g.exports=l.locals);var p=n("../node_modules/vue-style-loader/lib/addStylesClient.js").Z,d=p("4b997640",l,!0,{})}}]);
