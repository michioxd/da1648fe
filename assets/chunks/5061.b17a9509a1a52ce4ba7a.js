"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5061],{"../node_modules/date-fns/esm/formatDistance/index.js":function(N,T,a){a.d(T,{Z:function(){return F}});var d=a("../node_modules/date-fns/esm/_lib/defaultOptions/index.js"),o=a("../node_modules/date-fns/esm/toDate/index.js"),i=a("../node_modules/date-fns/esm/_lib/requiredArgs/index.js");function f(s,r){(0,i.Z)(2,arguments);var t=(0,o.Z)(s),m=(0,o.Z)(r),I=t.getTime()-m.getTime();return I<0?-1:I>0?1:I}function L(s,r){(0,i.Z)(2,arguments);var t=(0,o.Z)(s),m=(0,o.Z)(r),I=t.getFullYear()-m.getFullYear(),b=t.getMonth()-m.getMonth();return I*12+b}function g(s){(0,i.Z)(1,arguments);var r=(0,o.Z)(s);return r.setHours(23,59,59,999),r}function M(s){(0,i.Z)(1,arguments);var r=(0,o.Z)(s),t=r.getMonth();return r.setFullYear(r.getFullYear(),t+1,0),r.setHours(23,59,59,999),r}function E(s){(0,i.Z)(1,arguments);var r=(0,o.Z)(s);return g(r).getTime()===M(r).getTime()}function p(s,r){(0,i.Z)(2,arguments);var t=(0,o.Z)(s),m=(0,o.Z)(r),I=f(t,m),b=Math.abs(L(t,m)),u;if(b<1)u=0;else{t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-I*b);var Z=f(t,m)===-I;E((0,o.Z)(s))&&b===1&&f(s,m)===1&&(Z=!1),u=I*(b-Number(Z))}return u===0?0:u}function c(s,r){return(0,i.Z)(2,arguments),(0,o.Z)(s).getTime()-(0,o.Z)(r).getTime()}var S={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(r){return r<0?Math.ceil(r):Math.floor(r)}},O="trunc";function P(s){return s?S[s]:S[O]}function x(s,r,t){(0,i.Z)(2,arguments);var m=c(s,r)/1e3;return P(t==null?void 0:t.roundingMethod)(m)}var R=a("../node_modules/date-fns/esm/_lib/defaultLocale/index.js");function A(s,r){if(s==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(s[t]=r[t]);return s}function y(s){return A({},s)}var e=a("../node_modules/date-fns/esm/_lib/getTimezoneOffsetInMilliseconds/index.js"),n=1440,v=2520,_=43200,D=86400;function F(s,r,t){var m,I;(0,i.Z)(2,arguments);var b=(0,d.j)(),u=(m=(I=t==null?void 0:t.locale)!==null&&I!==void 0?I:b.locale)!==null&&m!==void 0?m:R.Z;if(!u.formatDistance)throw new RangeError("locale must contain formatDistance property");var Z=f(s,r);if(isNaN(Z))throw new RangeError("Invalid time value");var l=A(y(t),{addSuffix:Boolean(t==null?void 0:t.addSuffix),comparison:Z}),w,U;Z>0?(w=(0,o.Z)(r),U=(0,o.Z)(s)):(w=(0,o.Z)(s),U=(0,o.Z)(r));var j=x(U,w),k=((0,e.Z)(U)-(0,e.Z)(w))/1e3,h=Math.round((j-k)/60),B;if(h<2)return t!=null&&t.includeSeconds?j<5?u.formatDistance("lessThanXSeconds",5,l):j<10?u.formatDistance("lessThanXSeconds",10,l):j<20?u.formatDistance("lessThanXSeconds",20,l):j<40?u.formatDistance("halfAMinute",0,l):j<60?u.formatDistance("lessThanXMinutes",1,l):u.formatDistance("xMinutes",1,l):h===0?u.formatDistance("lessThanXMinutes",1,l):u.formatDistance("xMinutes",h,l);if(h<45)return u.formatDistance("xMinutes",h,l);if(h<90)return u.formatDistance("aboutXHours",1,l);if(h<n){var G=Math.round(h/60);return u.formatDistance("aboutXHours",G,l)}else{if(h<v)return u.formatDistance("xDays",1,l);if(h<_){var K=Math.round(h/n);return u.formatDistance("xDays",K,l)}else if(h<D)return B=Math.round(h/_),u.formatDistance("aboutXMonths",B,l)}if(B=p(U,w),B<12){var W=Math.round(h/_);return u.formatDistance("xMonths",W,l)}else{var C=B%12,$=Math.floor(B/12);return C<3?u.formatDistance("aboutXYears",$,l):C<9?u.formatDistance("overXYears",$,l):u.formatDistance("almostXYears",$+1,l)}}},"./js/api/commands/admin/brute-force-monitor.js":function(N,T,a){a.d(T,{Ge:function(){return A},IH:function(){return M},JA:function(){return S},JP:function(){return L},Rl:function(){return E},T0:function(){return x},We:function(){return c},es:function(){return R},h2:function(){return y},lE:function(){return p},ws:function(){return g}});var d=a("./js/api/command/index.js");const o="/CMD_BRUTE_FORCE_MONITOR",i=(e,n)=>d.Z.get({id:e,url:o,...n}),f=(e,n)=>d.Z.post({url:o,params:{action:e},schema:n}),L=i("BFM_DEFAULTS",{params:{seek_value:"-1"},after:e=>e.flow(e.project({logsize:"BRUTE_LOG_SIZE",userLimit:"USER_LIMIT",ipLimit:"IP_LIMIT",logScanning:"LOG_SCANNING",subjects:"SUBJECT_SELECT",defaultSubject:"SUBJECT_SELECT","scripts.block":"HAVE_BLOCK_SH","scripts.unblock":"HAVE_UNBLOCK_SH","scripts.show_blocked_ips":"HAVE_SHOW_BLOCKED_IPS_SH"}),e.mapProps({logScanning:e.convert.toAppBoolean,subjects:e.toSelect,defaultSubject:e.flow(e.find(e.getProp("selected")),e.getProp("value")),scripts:e.mapValues(e.isEqual("1"))}))}),g=i("BFM_IPINFO",{schema:{ipinfo:d.Z.REQUIRED_STRING},after:e=>e.flow(e.project({ip:"BLOCK_IP",data:"info"}),e.mapProp("data",e.flow(e.convert.toLines,e.filter(e.notEmpty))))}),M=i("BFM_GENERAL_LIST",{params:{show:"LOGINFAILURES"},pagination:!0,schema:{filter:d.Z.OPTIONAL_STRING,value:d.Z.OPTIONAL_STRING},before:({filter:e,value:n,sort:v})=>{const _={};if(v||(_.sort1="-1"),e){const D=e==="ip"?2:3;_[`comparison${D}`]="equals",_[`value${D}`]=n}return _},after:e=>e.flow(e.project({rows:"LOGINFAILURES"}),e.processTableInfo("rows"),e.mapProp("rows",e.toArray),e.mapProp("rows",e.mapArray(n=>({...n,date:new Date(Number(n.id.slice(0,13))),index:Number(n.id.slice(13))}))))}),E=i("BFM_IPLIST",{params:{show:"IPLOGINFAILURES",sort1:-2},pagination:!0,after:e=>e.flow(e.project({rows:"IPLOGINFAILURES"}),e.processTableInfo("rows"),e.mapProp("rows",e.flow(e.toArray,e.mapArray(e.project({ip:"ip",failures:"login_failures",first:"first_entry",last:"last_entry",notified:"notified",blocked:"blocked"})),e.mapArrayProps({first:e.convert.toAppDate,last:e.convert.toAppDate,notified:e.isEqual("Yes"),blocked:e.isEqual("Yes")}))))}),p=i("BFM_USER_LIST",{params:{show:"USERLOGINFAILURES",sort1:-2},pagination:!0,after:e=>e.flow(e.project({rows:"USERLOGINFAILURES"}),e.processTableInfo("rows"),e.mapProp("rows",e.flow(e.toArray,e.mapArrayProps({first_entry:e.convert.toAppDate,last_entry:e.convert.toAppDate,notified:e.isEqual("Yes")}))))}),c=i("BFM_SKIP_LIST",{params:{show:"SKIPLIST"},pagination:!0,after:e=>e.flow(e.project({rows:"SKIPLIST"}),e.processTableInfo("rows"),e.mapProp("rows",e.flow(e.toArray,e.mapArray(e.flow(e.moveProp("when","date"),e.mapProp("date",e.convert.toAppDate))))))}),S=i("BFM_BLOCK_LIST",{params:{show:"BLOCKED_IPS"},pagination:!0,after:e=>e.flow(e.project({rows:"BLOCKED_IPS"}),e.processTableInfo("rows"),e.mapProp("rows",e.toArray),e.mapProp("rows",e.mapArray(e.deleteProp("ip_info"),e.mapProp("date_blocked",e.convert.toAppDate))))}),O={type:Array,required:!1},{OPTIONAL_STRING:P}=d.Z,x=f("skiplist",{ip:O,user:O,comments:P,skip_value:P}),R=f("remove_from_skiplist",{select:d.Z.ROWS}),A=f("block_ips",{ip:O,user:O}),y=f("unblock",{ip:d.Z.ROWS})},"./js/composables/dateFilter.ts":function(N,T,a){a.d(T,{W:function(){return L},f:function(){return i.f}});var d=a("../node_modules/ramda/es/index.js"),o=a("../node_modules/date-fns/esm/format/index.js"),i=a("./js/modules/date-formats.ts"),f=a("./js/modules/customizations/date-formats/default.ts");const L=d.WAo((g,M)=>{if(M)try{return(0,o.Z)(M,i.f.value[g])}catch(E){return console.warn(`Given ${g} format is incorrect:
${E.message}`),(0,o.Z)(M,f.d[g])}return""})},"./js/composables/filters.ts":function(N,T,a){a.d(T,{Q0:function(){return x},aS:function(){return A},d5:function(){return R},eB:function(){return S},hT:function(){return p},kC:function(){return E},n9:function(){return P},zM:function(){return c}});var d=a("../node_modules/date-fns/esm/formatDistance/index.js"),o=a("../node_modules/punycode/punycode.es6.js"),i=a("./js/composables/dateFilter.ts"),f=a("./js/composables/gettext.ts");const{$gettext:L,$ngettext:g,$gettextInterpolate:M}=(0,f.Z)(),E=e=>{var n;return e?((n=e.at(0))===null||n===void 0?void 0:n.toUpperCase())+e.slice(1):""},p=(e,n="datetime")=>(0,i.W)(n,e),c=e=>(0,d.Z)(e,new Date),S=(e,n=1024)=>{const v=Number(e);if(!v)return"0 B";const _=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],D=Math.floor(Math.log(v)/Math.log(n));return`${parseFloat((v/n**D).toFixed(2))} ${_[D]}`},O=e=>{try{return(0,o.xX)(e)}catch(n){return e}},P=e=>(0,o.xX)(e),x=e=>{if(!e||!e.includes("@"))return e;const[n,v]=e.split("@");return[n,O(v)].join("@")},R=e=>{if(e<60)return L("less than a minute");const n=Math.floor(e/60)%60,v=Math.floor(e/3600)%24,_=Math.floor(e/(3600*24)),D=[_?g("%{days} day","%{days} days",_):null,v?g("%{hours} hour","%{hours} hours",v):null,n?g("%{minutes} minute","%{minutes} minutes",n):null].filter(Boolean).join(", ");return M(D,{days:_,hours:v,minutes:n})},A=(e,n)=>e.length<=n?e:`${e.substring(0,n)}...`,y=()=>({capitalize:E,date:p,distanceFromNow:c,humanReadableSize:S,p6eUnicode:P,p6eUnicodeEmail:x,formatUptime:R,truncateString:A})},"./js/pages/admin/brute-force-monitor/_components/tabs.vue":function(N,T,a){a.d(T,{Z:function(){return E}});var d=function(){var c=this,S=c._self._c;return S("app-page-section",[S("ui-tabs",{ref:"tabs",attrs:{selected:c.id,tabs:c.headers},on:{"update:selected":c.changeTab},scopedSlots:c._u([{key:`tab:${c.id}`,fn:function(){return[S("div",[c._t("default")],2)]},proxy:!0}],null,!0)})],1)},o=[],i=a("./js/api/commands/admin/brute-force-monitor.js"),f={api:[{command:i.JP,bind:{"response.scripts":"scripts"}}],props:{id:{type:String,required:!0},filter:{type:Object,required:!1,default:null}},computed:{filterMessage(){if(this.filter){if(this.filter.filter==="ip")return this.$gettextInterpolate(this.$gettext("List filtered by IP: %{ ip }"),{ip:this.filter.value});if(this.filter.filter==="user")return this.$gettextInterpolate(this.$gettext("List filtered by User: %{ user } "),{user:this.filter.value})}return this.$gettext("Select IP address or User to filter results")},headers(){const p=[{id:"general",label:this.$gettext("Failed Logins"),desc:this.filterMessage},{id:"failed-ips",label:this.$gettext("Failed Logins: IP list"),desc:this.$gettext("Select IP to filter results")},{id:"failed-usernames",label:this.$gettext("Failed logins: Usernames List"),desc:this.$gettext("Select username to filter results")},{id:"skiplist",label:this.$gettext("Skip List"),desc:this.$gettext("Skipped IPs / Users")}];return this.$api.scripts.show_blocked_ips&&p.push({id:"blocklist",label:this.$gettext("Block List"),desc:this.$gettext("View / Delete Blocked IPs")}),p}},methods:{changeTab(p){const c=p==="general"?"admin/brute-force-monitor":`admin/brute-force-monitor/${p}`;c!==this.$route.name&&(this.$router.push({name:c}),this.$nextTick(()=>{this.$refs.tabs.dataCurrentTab=this.id}))}}},L=f,g=a("../node_modules/vue-loader/lib/runtime/componentNormalizer.js"),M=(0,g.Z)(L,d,o,!1,null,null,null),E=M.exports}}]);
