(self.webpackChunk=self.webpackChunk||[]).push([[6540],{"../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/user/terminal/_components/xterm-terminal.vue?vue&type=style&index=0&id=73344180&prod&lang=scss&":function(){},"../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/user/terminal/_components/xterm-terminal.vue?vue&type=style&index=1&id=73344180&prod&lang=css&":function(){},"./js/pages/user/terminal/index.vue":function(i,r,o){"use strict";o.r(r),o.d(r,{default:function(){return T}});var t=function(){var e=this,s=e._self._c;return s("div",{attrs:{id:"terminal"}},[s("div",{staticClass:"header"},[s("span",{directives:[{name:"margin",rawName:"v-margin",value:[0,.5],expression:"[0, 0.5]"}],class:e.state===e.ACTIVE?"c:txt:safe":"c:txt:danger",domProps:{innerHTML:e._s("&bull;")}}),e._v(" "),s("span",{domProps:{textContent:e._s(e.$gettext("Terminal"))}}),e._v(" "),s("span",{directives:[{name:"flex-item",rawName:"v-flex-item",value:{grow:!0},expression:"{ grow: true }"},{name:"margin",rawName:"v-margin:left",value:.5,expression:"0.5",arg:"left"}]},[e._v(`
            (`+e._s(e.stateLabels[e.state])+`)
        `)]),e._v(" "),e.state===e.CLOSED?[s("a",{key:"connect-button",staticClass:"cursor:pointer",on:{click:e.connect}},[e._v(`
                \u27F3
                `),s("span",{domProps:{textContent:e._s(e.$gettext("Connect"))}})]),e._v(" "),s("span",{directives:[{name:"margin",rawName:"v-margin",value:[0,1],expression:"[0, 1]"}],staticClass:"c:txt:primary"},[e._v("|")])]:e.state===e.ACTIVE?[s("a",{key:"disconnect-button",staticClass:"cursor:pointer",on:{click:e.disconnect}},[e._v(`
                \u27F3
                `),s("span",{domProps:{textContent:e._s(e.$gettext("Disconnect"))}})]),e._v(" "),s("span",{directives:[{name:"margin",rawName:"v-margin",value:[0,1],expression:"[0, 1]"}],staticClass:"c:txt:primary"},[e._v("|")])]:e._e(),e._v(" "),s("a",{staticClass:"cursor:pointer",on:{click:function(n){return e.$router.back()}}},[e._v(`
            \u2190
            `),s("span",{domProps:{textContent:e._s(e.$gettext("Back"))}})])],2),e._v(" "),s("div",{ref:"terminal",staticClass:"console"})])},a=[],u=o("../node_modules/lodash.debounce/index.js"),c=o.n(u),v=o("../node_modules/xterm/lib/xterm.js"),j=o("../node_modules/xterm-addon-fit/lib/xterm-addon-fit.js");const m=(d,e)=>Object.entries(e).forEach(s=>d(...s));class h{constructor(e){this._socket=null,this._handlers=e,this._disposables=[],this._terminal=null}activate(e){this._terminal=e,this._createSocket(),this._setSocketEvents({message:this._processMessage.bind(this),open:this._handlers.onConnect.bind(this),close:this.dispose.bind(this),error:this.dispose.bind(this)}),this._setTerminalEvents({onData:this._sendData.bind(this),onBinary:this._sendBinary.bind(this),onResize:c()(this._setTerminalSize.bind(this),1e3)})}dispose(){this._handlers.onDisconnect(this._socket),this._socket.readyState!==3&&this._socket.close()}_createSocket(){const{rows:e,cols:s}=this._terminal,l=`${window.location.protocol==="https:"?"wss:":"ws:"}//${window.location.host}/api/terminal?cols=${s}&rows=${e}`;this._socket=new WebSocket(l),this._socket.binaryType="arraybuffer"}_setSocketEvents(e){m((n,l)=>{this._socket.addEventListener(n,l);const O=()=>{l&&this._socket.removeEventListener(n,l)};this._disposables.push({dispose:O})},e)}_setTerminalEvents(e){this._terminal&&m((n,l)=>{typeof this._terminal[n]=="function"&&this._disposables.push(this._terminal[n](l))},e)}_setTerminalSize(e){const s=JSON.stringify(e,null,2);this._sendBinary(s)}_sendData(e){this._socket.readyState===1&&this._socket.send(e)}_sendBinary(e){if(this._socket.readyState!==1)return;const s=new Uint8Array(e.length);for(let n=0;n<e.length;++n)s[n]=e.charCodeAt(n)&255;this._socket.send(s)}_processMessage(e){if(this._terminal){const s=typeof e.data=="string"?e.data:new Uint8Array(e.data);this._terminal.write(s)}}}const f=(d,e)=>{const s=c()(e,200);window.ResizeObserver&&new ResizeObserver(s).observe(d)},p=()=>{};function g(d,e){const s=new v.Terminal(e),n=new j.FitAddon;return s.loadAddon(n),s.open(d),n.fit(),f(d,()=>n.fit()),s}function x(d,e={onConnect:p,onDisconnect:p}){const s=new h(e);return d.loadAddon(s),s}const y="connecting";var b={data:()=>({terminal:null,socket:null,state:y}),computed:{options(){return{theme:{cursor:"#4fb636",background:"#073642",forground:"#ffffff"},fontWeight:500,fontFamily:'"Consolas", "Lucida Console", monospace'}}},created(){this.CONNECTING="connecting",this.ACTIVE="active",this.CLOSED="closed",this.stateLabels={[this.CONNECTING]:this.$gettext("Connecting..."),[this.ACTIVE]:this.$gettext("Active"),[this.CLOSED]:this.$gettext("Closed")}},mounted(){this.init()},beforeDestroy(){this.dispose()},methods:{init(){this.terminal=g(this.$refs.terminal,this.options),this.connect()},dispose(){this.terminal&&(this.terminal.dispose(),this.state=this.CLOSED,this.terminal=null)},disconnect(){this.socket&&this.socket.dispose()},connect(){this.socket&&this.terminal.writeln(""),this.state=this.CONNECTING,this.socket=x(this.terminal,{onConnect:()=>{this.state=this.ACTIVE},onDisconnect:()=>{this.state=this.CLOSED}})}}},S=b,$=o("../node_modules/vue-style-loader/index.js!../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/user/terminal/_components/xterm-terminal.vue?vue&type=style&index=0&id=73344180&prod&lang=scss&"),A=o("../node_modules/vue-style-loader/index.js!../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/user/terminal/_components/xterm-terminal.vue?vue&type=style&index=1&id=73344180&prod&lang=css&"),_=o("../node_modules/vue-loader/lib/runtime/componentNormalizer.js"),C=(0,_.Z)(S,t,a,!1,null,null,null),R=C.exports,k={render:d=>d(R)},w=k,N,E,L=(0,_.Z)(w,N,E,!1,null,null,null),T=L.exports},"../node_modules/vue-style-loader/index.js!../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/user/terminal/_components/xterm-terminal.vue?vue&type=style&index=0&id=73344180&prod&lang=scss&":function(i,r,o){var t=o("../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/user/terminal/_components/xterm-terminal.vue?vue&type=style&index=0&id=73344180&prod&lang=scss&");t.__esModule&&(t=t.default),typeof t=="string"&&(t=[[i.id,t,""]]),t.locals&&(i.exports=t.locals);var a=o("../node_modules/vue-style-loader/lib/addStylesClient.js").Z,u=a("111e5ce2",t,!0,{})},"../node_modules/vue-style-loader/index.js!../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/user/terminal/_components/xterm-terminal.vue?vue&type=style&index=1&id=73344180&prod&lang=css&":function(i,r,o){var t=o("../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/user/terminal/_components/xterm-terminal.vue?vue&type=style&index=1&id=73344180&prod&lang=css&");t.__esModule&&(t=t.default),typeof t=="string"&&(t=[[i.id,t,""]]),t.locals&&(i.exports=t.locals);var a=o("../node_modules/vue-style-loader/lib/addStylesClient.js").Z,u=a("87e75186",t,!0,{})}}]);
