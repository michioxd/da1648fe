(self.webpackChunk=self.webpackChunk||[]).push([[5684,8952],{"./js/vue-globals/mixins.js":function(g,u,s){"use strict";s.r(u),s.d(u,{$bindTab:function(){return A},$clickOutside:function(){return I},$resizeListener:function(){return E},$scrollListener:function(){return D}});var n=s("../node_modules/vue/dist/vue.common.prod.js"),o=s.n(n),c=s("../node_modules/ramda/es/index.js"),i=s("./js/modules/file.js"),l=s("./js/modules/utils/index.js"),p=s("./js/modules/constants.js"),h=s("./js/modules/utils/css.js"),v=s("../node_modules/punycode/punycode.es6.js"),b=s("./js/vue-globals/helpers.js"),f=s("./js/stores/index.ts");const P=s("./js/vue-globals/mixins sync recursive \\.js$");(0,i.s)(P,a=>o().mixin(a.module)),o().mixin({data:()=>({isMounted:!1}),mounted(){this.isMounted=!0}}),o().mixin({methods:{$dialog(a){return{open:()=>b.uY.emit("dialog:open",a),close:()=>b.uY.emit("dialog:close",a)}}}}),o().mixin({computed:{$domain(){return this.$_ctx.session.domain},$domainUnicode(){return v.ZP.toUnicode(this.$domain)}}}),o().mixin({beforeCreate(){const a=(0,f.oR)(PiniaStores.VALIDATION);this.$valid=a.isValid.bind(a)}}),o().mixin({created(){this.regexps=p.gk}}),o().mixin({computed:{$p6e(){const a=m=>_=>{try{return m(_)}catch(x){return _}};return{toA:a(v.ZP.toASCII),toU:a(v.ZP.toUnicode),email2ascii:m=>{if(!m||!m.includes("@"))return m;const[_,x]=m.split("@");return[_,v.ZP.toASCII(x)].join("@")},email2unicode:m=>{if(!m||!m.includes("@"))return m;const[_,x]=m.split("@");return[_,v.ZP.toUnicode(x)].join("@")}}}}}),o().mixin({computed:{$_layout:(0,b.YM)("skin/layout")}}),o().mixin({methods:{$_useStore(a){return(0,f.oR)(a)}}});const y=[];document.body.addEventListener("click",a=>{y.forEach(m=>m(a.target))}),window.addEventListener("touchmove",a=>{y.forEach(m=>m(a.target))});const I={methods:{$clickOutsideListener(a,m){const _=k=>c.zGw(c.Bxt(m),c.qhW(Array.isArray,j=>[j]),c.hXT(c.CyQ(c.kKJ)),c.YPD(j=>j===k||j.contains(k)))(),x=k=>{_(k)&&this.$emit(`clickOutside:${a}`)};y.push(x)}}},D={methods:{__getScroller(){return this.$_layout==="sidebar"?window.document.querySelector("main"):window},__emitScroll(){this.$emit("window:scroll",window.pageYOffset)}},mounted(){const a=this.__getScroller();a&&a.addEventListener("scroll",this.__emitScroll)},destroyed(){const a=this.__getScroller();a&&a.removeEventListener("scroll",this.__emitScroll)}},$=[];window.addEventListener("resize",()=>{$.forEach(a=>a())});const E={created(){this.$resizeListener=()=>{this.$emit("window:resize",window.innerWidth)},$.push(this.$resizeListener)},destroyed(){$.splice($.indexOf(this.$resizeListener),1)}},A=({param:a="tab",defaultTab:m}={param:"tab"})=>({computed:{[a]:{get(){return this.$route.params[a]||m},set(_){this.$route.params[a]!==_&&this.$router.replace(l._.merge({},this.$route,{params:{[a]:_}}))}}}})},"./js/vue-globals/mixins/bindApi.js":function(g,u,s){"use strict";s.r(u);var n=s("../node_modules/ramda/es/index.js");const o=(c,i)=>n.ETc(c.split("."),i);u.default={beforeCreate(){this.$options.commands&&(this.$commands=this.$options.commands)},computed:{$api(){if(!this.$options.api)return[];const c=this.$options.api;return typeof c=="function"?c.data.response:n.u4g((l,{command:p,bind:h})=>{if(typeof h=="string")return{...l,[h]:p.data.response};const v=n.u4g((b,[f,P])=>{const y=f.includes(".")?o(f,p.data):p.data[f]||p.data.response[f];return{...b,[P]:y}},{},n.Zpf(h));return{...l,...v}},{},c)}}}},"./js/vue-globals/mixins/local/clickOutside.js":function(g,u,s){"use strict";s.r(u),s.d(u,{$clickOutside:function(){return i}});var n=s("../node_modules/ramda/es/index.js");const o=[];document.body.addEventListener("click",l=>{o.forEach(n.gH4(l))}),window.addEventListener("touchstart",l=>{o.forEach(n.gH4(l))});const c=(l,p)=>n.zGw(n.qhW(Array.isArray,h=>[h]),n.hXT(n.CyQ(n.kKJ)),n.YPD(h=>h===l||h.contains(l)))(p),i={methods:{$clickOutsideListener(l,p){const h=v=>{c(v.target,p)&&this.$emit(`clickOutside:${l}`)};o.push(h)}}}},"./js/vue-globals/mixins/local/inputValidation.js":function(g,u,s){"use strict";s.r(u),s.d(u,{$inputValidation:function(){return c}});var n=s("./js/vue-globals/helpers.js"),o=s("./js/stores/index.ts");const c={inject:{groupID:{default:null},inputID:{default:null},validators:{default:()=>({})}},props:{id:{type:String,required:!1,default(){return this.inputID}},group:{type:String,required:!1,default(){return this.groupID}},novalidate:{type:Boolean,required:!1,default(){return!Object.keys(this.validators).length}}},computed:{validationStore(){return(0,o.oR)(PiniaStores.VALIDATION)},valid(){return this.validationStore.isValid(this.group,this.id)},errorState(){return!this.novalidate&&this.isUpdated&&!this.valid},isUpdated(){var i;const l=(i=this.validationStore.groups[this.group])==null?void 0:i[this.id];return typeof l=="undefined"?!1:l.updated}},methods:{$validate(i){this.id&&!this.novalidate&&this.validationStore.validate(this.groupID,this.id,i,this.validators)}},created(){if(!this.novalidate){const{validate:i}=this.$options;i&&this.$watch(i,(0,n.Ds)(this.$validate,{trailing:!0,leading:!1,delay:200}),{immediate:!0})}},destroyed(){this.novalidate||this.validationStore.deleteInput(this.group,this.id)}}},"./js/vue-globals/mixins/notification.js":function(g,u,s){"use strict";s.r(u);var n=s("./js/composables/index.ts");u.default={created(){const o=new n.d$;this.$notifications=o}}},"./js/vue-globals/mixins/reloadApiTable.js":function(g,u,s){"use strict";s.r(u);var n=s("./js/modules/constants.js");const o=i=>i.$options&&i.$options.name==="UiApiTable",c=i=>{const l=[i];let p=i;for(;p=l.shift();){if(o(p))return p;p.$children.length&&l.push(...p.$children)}return!1};u.default={methods:{$reloadApiTable({reset:i=!0}={}){const l=c(this);if(!l){n.Vi.DEV&&console.warn("$reloadApiTable called without any ui-api-table child");return}l.reloadTable(),i&&Object.assign(this.$data,this.$options.data.apply(this))}}}},"./js/vue-globals/mixins/session.js":function(g,u,s){"use strict";s.r(u);var n=s("./js/context/index.ts");u.default={computed:{$_ctx(){return n.T},$_flags(){return n.T.session.features},$_session(){return n.T.session.allValues}},methods:{$_cmd(o){return n.T.session.allowedCommands.includes(o)}}}},"./js/vue-globals/mixins/staticData.js":function(g,u,s){"use strict";s.r(u),u.default={created(){this.$options.staticData&&Object.entries(this.$options.staticData).forEach(([n,o])=>{this[n]=typeof o=="function"?o.bind(this)():o})}}},"./js/pages/admin/ip-manager/details.vue":function(g,u,s){"use strict";s.r(u),s.d(u,{default:function(){return R}});var n={};s.r(n),s.d(n,{getDetails:function(){return p},linkIp:function(){return h},setGlobal:function(){return b},unlinkIp:function(){return v}});var o=function(){var t=this,e=t._self._c;return e("app-page",{attrs:{actions:[{label:t.$gettext("Link IP"),icon:"#plus-fill",handler:t.$dialog("LINK_IP_DIALOG").open,visible:t.available_ips.length}]},scopedSlots:t._u([{key:"page:title",fn:function(){return[e("span",{domProps:{textContent:t._s(t.$gettextInterpolate(t.$gettext("Details for %{ip}"),{ip:t.ip}))}})]},proxy:!0},{key:"default",fn:function(){return[e("app-page-section",[e("ui-tabs",{attrs:{tabs:[{id:"details",label:t.$gettext("Details")},{id:"ips",label:t.$gettext("Linked IP(s)")}],selected:t.tab},on:{"update:selected":function(d){t.tab=d}},scopedSlots:t._u([{key:"tab:details",fn:function(){return[e("ui-table",{key:"details-table",attrs:{items:[t.details],transposed:""}},[t._l(t.detailsData,function(d,O){return e("ui-column",t._b({key:O,attrs:{visible:!!t.details[O],fit:""}},"ui-column",{label:d,id:O},!1))}),t._v(" "),e("ui-column",{attrs:{id:"resellers",visible:Boolean(t.details.global&&t.details.resellers.length),label:t.$gettext("Resellers")},scopedSlots:t._u([{key:"default",fn:function(){return[t._v(`
                                `+t._s(t.details.resellers.join(", "))+`
                            `)]},proxy:!0}])}),t._v(" "),e("ui-column",{attrs:{id:"reseller",label:t.$gettext("Reseller"),visible:Boolean(t.details.reseller&&!(t.details.global&&t.details.resellers.length))}}),t._v(" "),e("ui-column",{attrs:{id:"global",label:t.$gettext("Global"),visible:["shared","free"].includes(t.details.status)},scopedSlots:t._u([{key:"default",fn:function({global:d}){return[e("input-checkbox",{attrs:{model:d},on:{change:t.setGlobal}},[e("span",{domProps:{textContent:t._s(t.$gettext("When enabled, this IP can be used by multiple Resellers"))}})])]}}])})],2)]},proxy:!0},{key:"tab:ips",fn:function(){return[e("ui-api-table",t._b({on:{"action:unlink":function(d){t.$dialog("UNLINK_IP_DIALOG").open()}},scopedSlots:t._u([{key:"col:dns",fn:function({dns:d}){return[e("span",{domProps:{textContent:t._s(d?t.$gettext("Yes"):t.$gettext("No"))}})]}},{key:"col:apache",fn:function({apache:d}){return[e("span",{domProps:{textContent:t._s(d?t.$gettext("Yes"):t.$gettext("No"))}})]}}]),model:{value:t.select,callback:function(d){t.select=d},expression:"select"}},"ui-api-table",{command:t.$commands.getDetails,property:"linked_ips",rowID:"ip",columns:{ip:t.$gettext("IP Address"),dns:t.$gettext("Added to DNS"),apache:t.$gettext("Added to Apache")},actions:{unlink:t.$gettext("Un-Link")},requestData:{ip:t.ip}},!1))]},proxy:!0}])})],1),t._v(" "),e("link-ip-dialog",{attrs:{ip:t.ip,"available-ips":t.available_ips},on:{submit:t.linkIp}}),t._v(" "),e("unlink-ip-dialog",t._b({on:{submit:t.unlinkIp}},"unlink-ip-dialog",{ip:t.ip,select:t.select},!1))]},proxy:!0}])})},c=[],i=s("./js/api/command/index.js");const l="/CMD_IP_MANAGER_DETAILS",p=i.Z.get({url:l,id:"IP_MANAGER_DETAILS",schema:{ip:i.Z.REQUIRED_STRING},pagiantion:!0,after:r=>r.flow(r.moveProp("value","details.users"),r.moveProp("status","details.status"),r.moveProp("reseller","details.reseller"),r.moveProp("resellers_with_ip","details.resellers"),r.moveProp("ns","details.nameserver"),r.moveProp("netmask","details.netmask"),r.moveProp("gateway","details.gateway"),r.moveProp("ip","details.ip"),r.moveProp("global","details.global"),r.mapProps({linked_ips:r.toTable(r.mapArrayProps({dns:r.convert.toAppBoolean,apache:r.convert.toAppBoolean})),details:r.mapProps({users:r.convert.toAppNumber,global:r.isEqual("yes"),resellers:r.setDefault([])})}))}),h=i.Z.post({url:l,params:{json:!0,action:"add"},schema:{ip:i.Z.REQUIRED_STRING,ip_to_link:i.Z.REQUIRED_STRING,dns:i.Z.REQUIRED_BOOL,apache:i.Z.REQUIRED_BOOL,apply:i.Z.REQUIRED_BOOL}}),v=i.Z.select({url:l,params:{json:!0,remove:!0},schema:{ip:i.Z.REQUIRED_STRING,rewrite_apache:i.Z.REQUIRED_BOOL,flush_dns:i.Z.REQUIRED_BOOL}}),b=i.Z.post({url:l,params:{action:"global"},schema:{ip:i.Z.REQUIRED_STRING,global:i.Z.OPTIONAL_BOOL}});var f=s("./js/vue-globals/mixins.js"),P=function(){var t=this,e=t._self._c;return e("ui-dialog",{attrs:{id:"LINK_IP_DIALOG",theme:"safe"},on:{"dialog:close":t.resetData},scopedSlots:t._u([{key:"title",fn:function(){return[e("span",{domProps:{textContent:t._s(t.$gettextInterpolate(t.$gettext("Link an IP to %{ip}"),{ip:t.ip}))}})]},proxy:!0},{key:"content",fn:function(){return[e("ui-form-element",{attrs:{group:"linkIP",validators:{required:!0},vertical:""},scopedSlots:t._u([{key:"title",fn:function(){return[e("span",{domProps:{textContent:t._s(t.$gettext("IP Address"))}})]},proxy:!0},{key:"content",fn:function(){return[e("input-select",{attrs:{options:t.availableIps},model:{value:t.linkIP,callback:function(d){t.linkIP=d},expression:"linkIP"}})]},proxy:!0}])}),t._v(" "),e("ui-form-element",{attrs:{vertical:""},scopedSlots:t._u([{key:"content",fn:function(){return[e("input-checkbox",{model:{value:t.dns,callback:function(d){t.dns=d},expression:"dns"}},[e("span",{domProps:{textContent:t._s(t.$gettext("Add to DNS"))}}),t._v(" "),e("ui-tooltip",[e("span",{domProps:{textContent:t._s(t.$gettext("Linking an IP with DNS will duplicate the A/AAAA records for the current IP with the linked IP."))}})])],1)]},proxy:!0}])}),t._v(" "),e("ui-form-element",{attrs:{vertical:""},scopedSlots:t._u([{key:"content",fn:function(){return[e("input-checkbox",{model:{value:t.apache,callback:function(d){t.apache=d},expression:"apache"}},[e("span",{domProps:{textContent:t._s(t.$gettext("Add to Apache"))}}),t._v(" "),e("ui-tooltip",[e("span",{domProps:{textContent:t._s(t.$gettext("Linking an IP with apache will add the linked IP into the VirtualHost with the current IP."))}})])],1)]},proxy:!0}])}),t._v(" "),e("ui-form-element",{attrs:{vertical:""},scopedSlots:t._u([{key:"content",fn:function(){return[e("input-checkbox",{model:{value:t.apply,callback:function(d){t.apply=d},expression:"apply"}},[e("span",{domProps:{textContent:t._s(t.$gettext("Apply to existing domains"))}}),t._v(" "),e("ui-tooltip",[t._v(`
                        `+t._s(t.$gettext(`The "Apply to existing Domains" option will trigger the httpd.conf rewrites and insert A/AAAA records into the local DNS zones. Disabling this checkbox won't touch the DNS or httpd.conf files, but future httpd.cont rewrites will have the linked IP added.`))+`
                    `)])],1)]},proxy:!0}])}),t._v(" "),e("ui-form-element",{attrs:{vertical:""},scopedSlots:t._u([{key:"content",fn:function(){return[e("input-checkbox",{model:{value:t.background,callback:function(d){t.background=d},expression:"background"}},[e("span",{domProps:{textContent:t._s(t.$gettext("Link in background"))}}),t._v(" "),e("ui-tooltip",[e("span",{domProps:{textContent:t._s(t.$gettext("When this is set, the add link task is processed in the background via task.queue. It may take up to 1 minute before the processing starts, and an unknown amount of time, depending on the number of websites present."))}})])],1)]},proxy:!0}])})]},proxy:!0},{key:"buttons",fn:function(){return[e("ui-button",{attrs:{theme:"safe","validate-group":"linkIP"},on:{click:t.submit}},[e("span",{domProps:{textContent:t._s(t.$gettext("Link"))}})])]},proxy:!0}])})},y=[],I={props:{ip:{type:String,required:!0,default:""},availableIps:{type:Array,required:!0,default:()=>[]}},data:()=>({linkIP:"",dns:!0,apache:!0,apply:!0,background:!0}),methods:{submit(){this.$emit("submit",{ip:this.ip,ip_to_link:this.linkIP,dns:this.dns,apache:this.apache,apply:this.apply,background:this.background})},resetData(){Object.assign(this.$data,this.$options.data.apply(this))}}},D=I,$=s("../node_modules/vue-loader/lib/runtime/componentNormalizer.js"),E=(0,$.Z)(D,P,y,!1,null,null,null),A=E.exports,a=function(){var t=this,e=t._self._c;return e("ui-dialog",{attrs:{id:"UNLINK_IP_DIALOG",theme:"danger",title:t.$ngettext("Un-Link IP Address","Un-Link IP Addresses",t.select.length)},on:{"dialog:close":t.resetData},scopedSlots:t._u([{key:"content",fn:function(){return[e("span",{staticClass:"txt:bold",domProps:{textContent:t._s(t.$ngettext("Are you sure you want to unlink selected IP?","Are you sure you want to unlink selected IPs?",t.select.length))}}),t._v(" "),e("ui-form-element",{attrs:{vertical:""},scopedSlots:t._u([{key:"content",fn:function(){return[e("input-checkbox",{model:{value:t.flushDNS,callback:function(d){t.flushDNS=d},expression:"flushDNS"}},[e("span",{domProps:{textContent:t._s(t.$gettext("Flush from DNS"))}})])]},proxy:!0}])}),t._v(" "),e("ui-form-element",{attrs:{vertical:""},scopedSlots:t._u([{key:"content",fn:function(){return[e("input-checkbox",{model:{value:t.rewriteApache,callback:function(d){t.rewriteApache=d},expression:"rewriteApache"}},[e("span",{domProps:{textContent:t._s(t.$gettext("Rewrite Apache"))}})])]},proxy:!0}])})]},proxy:!0},{key:"buttons",fn:function(){return[e("ui-button",{attrs:{theme:"danger"},on:{click:t.submit}},[e("span",{domProps:{textContent:t._s(t.$gettext("Un-Link"))}})])]},proxy:!0}])})},m=[],_={props:{ip:{type:String,required:!0},select:{type:Array,required:!0}},data:()=>({flushDNS:!0,rewriteApache:!0}),methods:{submit(){this.$emit("submit",{ip:this.ip,select:this.select,flush_dns:this.flushDNS,rewrite_apache:this.rewriteApache})},resetData(){Object.assign(this.$data,this.$options.data.apply(this))}}},x=_,k=(0,$.Z)(x,a,m,!1,null,null,null),j=k.exports,L={preload:p,commands:n,components:{LinkIpDialog:A,UnlinkIpDialog:j},api:[{command:p,bind:"data"}],mixins:[(0,f.$bindTab)({defaultTab:"details",param:"tab"})],props:{ip:{type:String,required:!0}},data:()=>({select:[]}),computed:{details(){return this.$api.data.details},available_ips(){return this.$api.data.available_ips}},created(){this.detailsData={status:this.$gettext("Status"),netmask:this.$gettext("Netmask"),users:this.$gettext("Users"),nameserver:this.$gettext("Name Server")}},methods:{linkIp(r){h(r).then(this.$reloadApiTable)},unlinkIp(r){v(r).then(this.$reloadApiTable)},async setGlobal(r){await b({ip:this.ip,global:r||null}),p({ip:this.ip})}}},S=L,T=(0,$.Z)(S,o,c,!1,null,null,null),R=T.exports},"./js/vue-globals/mixins sync recursive \\.js$":function(g,u,s){var n={"./bindApi.js":"./js/vue-globals/mixins/bindApi.js","./local/clickOutside.js":"./js/vue-globals/mixins/local/clickOutside.js","./local/inputValidation.js":"./js/vue-globals/mixins/local/inputValidation.js","./notification.js":"./js/vue-globals/mixins/notification.js","./reloadApiTable.js":"./js/vue-globals/mixins/reloadApiTable.js","./session.js":"./js/vue-globals/mixins/session.js","./staticData.js":"./js/vue-globals/mixins/staticData.js","vue-globals/mixins/bindApi.js":"./js/vue-globals/mixins/bindApi.js","vue-globals/mixins/local/clickOutside.js":"./js/vue-globals/mixins/local/clickOutside.js","vue-globals/mixins/local/inputValidation.js":"./js/vue-globals/mixins/local/inputValidation.js","vue-globals/mixins/notification.js":"./js/vue-globals/mixins/notification.js","vue-globals/mixins/reloadApiTable.js":"./js/vue-globals/mixins/reloadApiTable.js","vue-globals/mixins/session.js":"./js/vue-globals/mixins/session.js","vue-globals/mixins/staticData.js":"./js/vue-globals/mixins/staticData.js"};function o(i){var l=c(i);return s(l)}function c(i){if(!s.o(n,i)){var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}return n[i]}o.keys=function(){return Object.keys(n)},o.resolve=c,g.exports=o,o.id="./js/vue-globals/mixins sync recursive \\.js$"}}]);
