"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6012],{"./js/api/commands/dns-zone.js":function(D,i,r){r.d(i,{Q6:function(){return d},Rj:function(){return v},Ug:function(){return p},kG:function(){return m},ri:function(){return c},v2:function(){return f}});var s=r("./js/api/command/index.js"),_=r("./js/composables/index.ts"),a=r("./js/api/commands/dns/index.js");const l=()=>(0,_.kP)().session.effectiveRole==="reseller"?"/CMD_DNS_RESELLER":"/CMD_DNS_ADMIN",p=s.Z.get({id:"DNS_ZONES",url:l,domain:!1,schema:{...s.Z.PAGINATION,filters:{type:Object,required:!1},domain:null},before:({filters:e})=>{if(e){const o={};e.domain&&(o.comparison1=e.searchType,o.value1=e.domain),e.local_data&&(o.comparison2="contains",o.value2=e.local_data),e.local_mail&&(o.comparison3="contains",o.value3=e.local_mail)}return{}},after:e=>o=>({info:{dns_ns:o.info.dns_ns,dns_ptr:o.info.dns_ptr},zones:e.toTable(e.mapArrayProps({local_data:e.convert.toAppBoolean,local_mail:e.convert.toAppBoolean}))(o)})}),c=s.Z.post({url:"/CMD_DNS_ADMIN",params:{action:"create"},domain:!0,schema:{ip:s.Z.REQUIRED_STRING,ns1:s.Z.REQUIRED_STRING,ns2:s.Z.REQUIRED_STRING,reverse:s.Z.OPTIONAL_BOOL}}),m=s.Z.select({url:"/CMD_DNS_ADMIN",params:{action:"delete"}}),v=s.Z.post({url:l,params:{action:"select",reset:!0},domain:!0}),d=a.Q6.extend({url:l,params:{ttl:null},after:e=>e.flow(e.wrap("options"),e.moveProp({"options.records":"records","options.dnssec":"dnssec","options.ttl_value":"ttl.value","options.ttl_selected":"ttl.select","options.zone_user":"ttl.user","options.default_ttl":"ttl.default"}),e.mapProps({records:a.ip,options:e.mapValues(e.isEqual("1")),dns_ds:e.feedWith(1,({dnssec:o})=>o==="1"),dnssec:o=>o==="1"||o==="2",ttl:e.mapProps({select:e.setDefault("default"),default:e.setDefault("14400"),value:e.setDefault("14400")})}),e.moveProp({dnssec:"options.dnssec",dns_ds:"options.dns_ds",dns_ns:"options.dns_ns",dns_ptr:"options.dns_ptr"}))}),f=a.v2.extend({url:l,schema:{user:s.Z.OPTIONAL_STRING}})},"./js/pages/reseller/dns/edit.vue":function(D,i,r){r.r(i),r.d(i,{default:function(){return b}});var s=function(){var t=this,n=t._self._c;return n("app-page",{attrs:{actions:[{handler:t.$dialog("RESET_ZONE_DEFAULTS_DIALOG").open,label:t.$gettext("Reset Defaults"),icon:"#reload",theme:"danger"},{handler:t.$dialog("OVERRIDE_TTL_DIALOG").open,label:t.$gettext("Override TTL"),icon:"#console",visible:t.$api.dns.options.allow_ttl_override}]},scopedSlots:t._u([{key:"page:title",fn:function(){return[n("span",{domProps:{textContent:t._s(t.$gettextInterpolate(t.$gettext("Edit DNS Records for %{ domain }"),{domain:t.$p6e.toU(t.dom)}))}})]},proxy:!0},{key:"default",fn:function(){return[n("app-page-section",[n("dns-records-table",t._b({attrs:{domain:t.dom,records:t.$api.dns.records,"disable-t-t-l-input":!t.allowTTLEdit,dns_ns:t.$api.dns.options.dns_ns!=="0",dns_ptr:t.$api.dns.options.dns_ptr!=="0","enable-t-t-l":t.$api.dns.options.dns_ttl},on:{"rows:update":t.loadRows}},"dns-records-table",t.$api.dns.options,!1))],1),t._v(" "),n("reset-zone-defaults-dialog",{attrs:{domain:t.dom}}),t._v(" "),n("override-ttl-dialog",{attrs:{domain:t.dom}})]},proxy:!0},{key:"bottom:links",fn:function(){return[t.$api.dns.options.dnssec?n("ui-link",{attrs:{path:`/${t.$_session.effectiveRole}/dns/${t.dom}/security`,bullet:""}},[n("span",{domProps:{textContent:t._s(t.$gettext("DNSSEC"))}})]):t._e()]},proxy:!0}])})},_=[],a=r("./js/api/commands/dns-zone.js"),l=r("./js/components/local/dns/records-table.vue"),p=function(){var t=this,n=t._self._c;return n("ui-dialog",{attrs:{id:"RESET_ZONE_DEFAULTS_DIALOG",theme:"danger",title:t.$gettext("Reset Defaults")},scopedSlots:t._u([{key:"content",fn:function(){return[n("span",{domProps:{textContent:t._s(t.$gettext("Resetting the defaults will wipe any custom entries you have made."))}})]},proxy:!0},{key:"buttons",fn:function(){return[n("ui-button",{attrs:{theme:"danger"},on:{click:t.resetDefaults}},[n("span",{domProps:{textContent:t._s(t.$gettext("Confirm"))}})])]},proxy:!0}])})},c=[],m={props:{domain:{type:String,required:!0}},methods:{async resetDefaults(){await(0,a.Rj)({domain:this.domain}),(0,a.Q6)({domain:this.domain})}}},v=m,d=r("../node_modules/vue-loader/lib/runtime/componentNormalizer.js"),f=(0,d.Z)(v,p,c,!1,null,null,null),e=f.exports,o=function(){var t=this,n=t._self._c;return n("ui-dialog",{attrs:{id:"OVERRIDE_TTL_DIALOG",theme:"primary",title:t.$gettext("Override TTL")},on:{"dialog:open":t.initData},scopedSlots:t._u([{key:"content",fn:function(){return[n("ui-form-element",{attrs:{vertical:""},scopedSlots:t._u([{key:"title",fn:function(){return[n("span",{domProps:{textContent:t._s(t.$gettext("TTL Value"))}})]},proxy:!0},{key:"content",fn:function(){return[n("input-select",{attrs:{options:{default:t.$gettext("Default"),custom:t.$gettext("Custom")}},scopedSlots:t._u([{key:"additions:right",fn:function(){return[n("input-text",{attrs:{number:"",disabled:t.select==="default",value:t.select==="default"?t.ttl.default:t.value},on:{input:function(g){t.value=g}}})]},proxy:!0}]),model:{value:t.select,callback:function(g){t.select=g},expression:"select"}})]},proxy:!0}])})]},proxy:!0},{key:"buttons",fn:function(){return[n("ui-button",{attrs:{theme:"primary"},on:{click:t.updateTTLOptions}},[n("span",{domProps:{textContent:t._s(t.$gettext("Save"))}})])]},proxy:!0}])})},y=[],h={props:{domain:{type:String,required:!0}},data:()=>({select:"default",value:"14400"}),api:[{command:a.Q6,bind:"dns"}],computed:{ttl(){return this.$api.dns.ttl}},methods:{initData(){Object.assign(this,this.ttl)},async updateTTLOptions(){await(0,a.v2)({domain:this.domain,ttl_select:this.select,ttl:this.value,user:this.ttl.user}),(0,a.Q6)({domain:this.domain})}}},x=h,R=(0,d.Z)(x,o,y,!1,null,null,null),T=R.exports,E={preload:({dom:u})=>(0,a.Q6)({domain:u}),api:[{command:a.Q6,bind:"dns"}],components:{DnsRecordsTable:l.Z,ResetZoneDefaultsDialog:e,OverrideTtlDialog:T},props:{dom:{type:String,required:!0}},computed:{allowTTLEdit(){return this.$api.dns.options.dns_ttl&&this.$api.dns.ttl.select==="default"}},methods:{loadRows(){(0,a.Q6)({domain:this.dom})}}},O=E,$=(0,d.Z)(O,s,_,!1,null,null,null),b=$.exports}}]);
