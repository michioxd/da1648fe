"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8931],{"./js/api/commands/user/domain-pointers.ts":function(h,i,n){n.r(i),n.d(i,{createPointer:function(){return m},deletePointers:function(){return a},getAppPointers:function(){return s},getPointers:function(){return c},setLocal:function(){return _},setRemote:function(){return v}});var o=n("./js/api/command/index.js"),u=n("../node_modules/ramda/es/index.js"),p=n("./js/api/commands/converters/index.ts");const s=u.zGw(u.vgT("domain_pointers"),(0,p.sf)(d=>({domain_pointer:d.domain_pointer,type:d.type,mail:d.local_mail==="yes"?"local":"remote"}))),c=o.Z.get({id:"DOMAIN_POINTERS",url:"/CMD_DOMAIN_POINTER",domain:!0,pagination:!0,mapResponse:s}),m=o.Z.post({url:"/CMD_DOMAIN_POINTER",params:{action:"add"},domain:!0,schema:{from:o.Z.REQUIRED_STRING,alias:o.Z.REQUIRED_BOOL}}),a=o.Z.select({url:"/CMD_DOMAIN_POINTER",params:{action:"delete"},domain:!0}),_=a.extend({params:{local_mail:!0}}),v=a.extend({params:{remote_mail:!0}})},"./js/pages/user/dns/index.vue":function(h,i,n){n.r(i),n.d(i,{default:function(){return R}});var o=function(){var t=this,e=t._self._c;return e("app-page",{attrs:{actions:[{label:t.$gettext("Override TTL Value"),handler:t.$dialog("OVERRIDE_TTL_DIALOG").open,icon:"#plus-fill",visible:t.$api.dns.ttl.allow}]},scopedSlots:t._u([{key:"default",fn:function(){return[e("app-page-section",[e("dns-records-table",t._b({attrs:{records:t.$api.dns.records,domain:t.$domain,pointer:t.pointer,pointers:t.pointers,"disable-t-t-l-input":!t.enableTtlEdit,"enable-t-t-l":t.$api.dns.options.dns_ttl,dns_ns:t.haveNS,dns_ptr:t.havePTR,"affect-pointers-default":t.$api.dns.affectPointersDefault,"has-affect-pointers":t.haveAffectPointers},on:{"rows:update":t.loadRecords}},"dns-records-table",t.$api.dns.options,!1))],1),t._v(" "),e("override-ttl-dialog",{on:{update:t.loadRecords}})]},proxy:!0},{key:"bottom:links",fn:function(){return[t.pointer?t._e():e("ui-link",{attrs:{name:"user/dns/mx-records",bullet:""}},[e("span",{domProps:{textContent:t._s(t.$gettext("Modify MX Records"))}})]),t._v(" "),t.dnssecAllowed?e("ui-link",{attrs:{name:"user/dns/security",query:t.pointer?{pointer:t.pointer}:{},bullet:""}},[e("span",{domProps:{textContent:t._s(t.$gettext("DNSSEC"))}})]):t._e()]},proxy:!0}])})},u=[],p=n("./js/context/index.ts"),s=n("./js/api/commands/dns/index.js"),c=n("./js/api/commands/user/domain-pointers.ts"),m=n("./js/components/local/dns/records-table.vue"),a=function(){var t=this,e=t._self._c;return e("ui-dialog",{attrs:{id:"OVERRIDE_TTL_DIALOG",theme:"primary",title:t.$gettext("Override TTL")},on:{"dialog:open":t.initData},scopedSlots:t._u([{key:"content",fn:function(){return[e("ui-form-element",{attrs:{vertical:""},scopedSlots:t._u([{key:"title",fn:function(){return[t._v(t._s(t.$gettext("TTL Value")))]},proxy:!0},{key:"content",fn:function(){return[e("input-select",{attrs:{options:{default:t.$gettext("Default"),custom:t.$gettext("Custom")}},scopedSlots:t._u([{key:"additions:right",fn:function(){return[e("input-text",{attrs:{number:"",disabled:t.select==="default",value:t.select==="default"?t.ttl.default:t.value},on:{input:function(l){t.value=l}}})]},proxy:!0}]),model:{value:t.select,callback:function(l){t.select=l},expression:"select"}})]},proxy:!0}])})]},proxy:!0},{key:"buttons",fn:function(){return[e("ui-button",{attrs:{theme:"primary"},on:{click:t.updateTTLOptions}},[e("span",{domProps:{textContent:t._s(t.$gettext("Save"))}})])]},proxy:!0}])})},_=[],v={data:()=>({select:"default",value:"14400"}),api:[{command:s.Q6,bind:"dns"}],computed:{ttl(){return this.$api.dns.ttl}},methods:{initData(){this.value=this.ttl.value,this.select=this.ttl.overridden?"custom":"default"},async updateTTLOptions(){await(0,s.v2)({ttl_select:this.select,ttl:this.value}),this.$emit("update")}}},d=v,f=n("../node_modules/vue-loader/lib/runtime/componentNormalizer.js"),g=(0,f.Z)(d,a,_,!1,null,null,null),P=g.exports,T={name:"DnsRecords",preload:r=>{const t=[];t.push((0,s.Q6)({ptr:r.pointer||null}));const e=p.T.session.allowedCommands.includes("/CMD_DOMAIN_POINTER"),l=p.T.session.features.usage.domainPointers;return e&&l&&t.push((0,c.getPointers)({ipp:99999})),Promise.all(t)},api:[{command:s.Q6,bind:"dns"},{command:c.getPointers,bind:"pointers"}],commands:{getRecords:s.Q6},components:{DnsRecordsTable:m.Z,OverrideTtlDialog:P},computed:{dnssecAllowed(){const{dnssec:r,user_dnssec_control:t}=this.$api.dns.options;return r&&t},pointer(){return this.$route.query.pointer||null},pointers(){return Object.keys(this.$api.pointers).length===0?[]:this.$api.pointers.rows.map(r=>r.domain_pointer)},enableTtlEdit(){return!this.$api.dns.ttl.overridden&&this.$api.dns.options.dns_ttl},haveAffectPointers(){return!!this.$_session.usage.domainPointers.usage&&!this.pointer},loggedAs(){return this.$_session.realUsername!==this.$_session.effectiveUsername},haveNS(){return this.loggedAs?this.$api.dns.options.dns_ns!=="0":this.$api.dns.options.dns_ns==="2"},havePTR(){return this.loggedAs?this.$api.dns.options.dns_ptr!=="0":this.$api.dns.options.dns_ptr==="2"}},methods:{loadRecords(){(0,s.Q6)({ptr:this.pointer})}}},x=T,y=(0,f.Z)(x,o,u,!1,null,null,null),R=y.exports}}]);
