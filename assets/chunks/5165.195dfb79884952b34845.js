"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5165],{"../node_modules/date-fns/esm/formatDistance/index.js":function(C,x,a){a.d(x,{Z:function(){return L}});var T=a("../node_modules/date-fns/esm/_lib/defaultOptions/index.js"),u=a("../node_modules/date-fns/esm/toDate/index.js"),d=a("../node_modules/date-fns/esm/_lib/requiredArgs/index.js");function g(s,r){(0,d.Z)(2,arguments);var t=(0,u.Z)(s),i=(0,u.Z)(r),v=t.getTime()-i.getTime();return v<0?-1:v>0?1:v}function Z(s,r){(0,d.Z)(2,arguments);var t=(0,u.Z)(s),i=(0,u.Z)(r),v=t.getFullYear()-i.getFullYear(),E=t.getMonth()-i.getMonth();return v*12+E}function h(s){(0,d.Z)(1,arguments);var r=(0,u.Z)(s);return r.setHours(23,59,59,999),r}function M(s){(0,d.Z)(1,arguments);var r=(0,u.Z)(s),t=r.getMonth();return r.setFullYear(r.getFullYear(),t+1,0),r.setHours(23,59,59,999),r}function _(s){(0,d.Z)(1,arguments);var r=(0,u.Z)(s);return h(r).getTime()===M(r).getTime()}function I(s,r){(0,d.Z)(2,arguments);var t=(0,u.Z)(s),i=(0,u.Z)(r),v=g(t,i),E=Math.abs(Z(t,i)),l;if(E<1)l=0;else{t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-v*E);var S=g(t,i)===-v;_((0,u.Z)(s))&&E===1&&g(s,i)===1&&(S=!1),l=v*(E-Number(S))}return l===0?0:l}function p(s,r){return(0,d.Z)(2,arguments),(0,u.Z)(s).getTime()-(0,u.Z)(r).getTime()}var O={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(r){return r<0?Math.ceil(r):Math.floor(r)}},N="trunc";function P(s){return s?O[s]:O[N]}function j(s,r,t){(0,d.Z)(2,arguments);var i=p(s,r)/1e3;return P(t==null?void 0:t.roundingMethod)(i)}var $=a("../node_modules/date-fns/esm/_lib/defaultLocale/index.js");function y(s,r){if(s==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(s[t]=r[t]);return s}function b(s){return y({},s)}var e=a("../node_modules/date-fns/esm/_lib/getTimezoneOffsetInMilliseconds/index.js"),n=1440,o=2520,c=43200,D=86400;function L(s,r,t){var i,v;(0,d.Z)(2,arguments);var E=(0,T.j)(),l=(i=(v=t==null?void 0:t.locale)!==null&&v!==void 0?v:E.locale)!==null&&i!==void 0?i:$.Z;if(!l.formatDistance)throw new RangeError("locale must contain formatDistance property");var S=g(s,r);if(isNaN(S))throw new RangeError("Invalid time value");var f=y(b(t),{addSuffix:Boolean(t==null?void 0:t.addSuffix),comparison:S}),A,U;S>0?(A=(0,u.Z)(r),U=(0,u.Z)(s)):(A=(0,u.Z)(s),U=(0,u.Z)(r));var B=j(U,A),z=((0,e.Z)(U)-(0,e.Z)(A))/1e3,m=Math.round((B-z)/60),R;if(m<2)return t!=null&&t.includeSeconds?B<5?l.formatDistance("lessThanXSeconds",5,f):B<10?l.formatDistance("lessThanXSeconds",10,f):B<20?l.formatDistance("lessThanXSeconds",20,f):B<40?l.formatDistance("halfAMinute",0,f):B<60?l.formatDistance("lessThanXMinutes",1,f):l.formatDistance("xMinutes",1,f):m===0?l.formatDistance("lessThanXMinutes",1,f):l.formatDistance("xMinutes",m,f);if(m<45)return l.formatDistance("xMinutes",m,f);if(m<90)return l.formatDistance("aboutXHours",1,f);if(m<n){var F=Math.round(m/60);return l.formatDistance("aboutXHours",F,f)}else{if(m<o)return l.formatDistance("xDays",1,f);if(m<c){var Y=Math.round(m/n);return l.formatDistance("xDays",Y,f)}else if(m<D)return R=Math.round(m/c),l.formatDistance("aboutXMonths",R,f)}if(R=I(U,A),R<12){var K=Math.round(m/c);return l.formatDistance("xMonths",K,f)}else{var X=R%12,W=Math.floor(R/12);return X<3?l.formatDistance("aboutXYears",W,f):X<9?l.formatDistance("overXYears",W,f):l.formatDistance("almostXYears",W+1,f)}}},"./js/composables/dateFilter.ts":function(C,x,a){a.d(x,{W:function(){return Z},f:function(){return d.f}});var T=a("../node_modules/ramda/es/index.js"),u=a("../node_modules/date-fns/esm/format/index.js"),d=a("./js/modules/date-formats.ts"),g=a("./js/modules/customizations/date-formats/default.ts");const Z=T.WAo((h,M)=>{if(M)try{return(0,u.Z)(M,d.f.value[h])}catch(_){return console.warn(`Given ${h} format is incorrect:
${_.message}`),(0,u.Z)(M,g.d[h])}return""})},"./js/composables/filters.ts":function(C,x,a){a.d(x,{Q0:function(){return j},aS:function(){return y},d5:function(){return $},eB:function(){return O},hT:function(){return I},kC:function(){return _},n9:function(){return P},zM:function(){return p}});var T=a("../node_modules/date-fns/esm/formatDistance/index.js"),u=a("../node_modules/punycode/punycode.es6.js"),d=a("./js/composables/dateFilter.ts"),g=a("./js/composables/gettext.ts");const{$gettext:Z,$ngettext:h,$gettextInterpolate:M}=(0,g.Z)(),_=e=>{var n;return e?((n=e.at(0))===null||n===void 0?void 0:n.toUpperCase())+e.slice(1):""},I=(e,n="datetime")=>(0,d.W)(n,e),p=e=>(0,T.Z)(e,new Date),O=(e,n=1024)=>{const o=Number(e);if(!o)return"0 B";const c=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],D=Math.floor(Math.log(o)/Math.log(n));return`${parseFloat((o/n**D).toFixed(2))} ${c[D]}`},N=e=>{try{return(0,u.xX)(e)}catch(n){return e}},P=e=>(0,u.xX)(e),j=e=>{if(!e||!e.includes("@"))return e;const[n,o]=e.split("@");return[n,N(o)].join("@")},$=e=>{if(e<60)return Z("less than a minute");const n=Math.floor(e/60)%60,o=Math.floor(e/3600)%24,c=Math.floor(e/(3600*24)),D=[c?h("%{days} day","%{days} days",c):null,o?h("%{hours} hour","%{hours} hours",o):null,n?h("%{minutes} minute","%{minutes} minutes",n):null].filter(Boolean).join(", ");return M(D,{days:c,hours:o,minutes:n})},y=(e,n)=>e.length<=n?e:`${e.substring(0,n)}...`,b=()=>({capitalize:_,date:I,distanceFromNow:p,humanReadableSize:O,p6eUnicode:P,p6eUnicodeEmail:j,formatUptime:$,truncateString:y})},"./js/pages/admin/db-monitor/index.vue":function(C,x,a){a.r(x),a.d(x,{default:function(){return y}});var T=function(){var e=this,n=e._self._c,o=e._self._setupProxy;return n("app-page",{scopedSlots:e._u([{key:"default",fn:function(){return[n("app-page-section",[n("ui-r-table",e._b({attrs:{"is-checkable":!1},scopedSlots:e._u([{key:"buttons:before:end",fn:function(){return[n("ui-refresh-timer",{attrs:{options:{30:o.$gettext("30 seconds"),60:o.$gettext("1 minute"),120:o.$gettext("2 minutes"),300:o.$gettext("5 minutes")},"initial-delay":"60","on-refresh":o.getProcesses}})]},proxy:!0},{key:"col:time",fn:function({item:c}){return[e._v(`
                    `+e._s(o.formatProcessTime(c))+`
                `)]}},{key:"row:actions",fn:function({item:c}){return[n("ui-button",{attrs:{theme:"light",size:"small"},on:{click:function(D){return o.killProcess(c.id)}},scopedSlots:e._u([{key:"icon",fn:function(){return[n("ui-icon",{attrs:{id:"close",theme:"danger"}})]},proxy:!0}],null,!0)},[e._v(`
                        `+e._s(o.$gettext("Kill Process"))+`
                    `)])]}}],null,!0)},"ui-r-table",{columns:[{id:"id",label:o.$gettext("ID")},{id:"user",label:o.$gettext("User")},{id:"host",label:o.$gettext("Host")},{id:"database",label:o.$gettext("Database")},{id:"command",label:o.$gettext("Command")},{id:"time",label:o.$gettext("Time")},{id:"state",label:o.$gettext("State")},{id:"info",label:o.$gettext("Information")}],rows:o.processes},!1))],1)]},proxy:!0}])})},u=[],d=a("../node_modules/vue/dist/vue.common.prod.js"),g=a("./js/api/openapi/index.ts"),Z=a("../node_modules/runtypes/lib/index.js"),h=a("./js/openapi/web.types.ts");const M=(0,g.$d)(),_=g.an.Default(async b=>{const{data:e}=await M.get("/api/db-monitor/processes",b);return e.status==="success"&&Z.Array(h.JN).guard(e.data)===!1?M.failure({type:"INVALID_RESPONSE",response:e.data}):e}),I=g.an.Default(async(b,e)=>{const{data:n}=await M.post(`/api/db-monitor/processes/${b}/kill`,e);return n});var p=a("./js/composables/index.ts"),O=a("./js/composables/filters.ts"),N=(0,d.defineComponent)({__name:"index",setup(b){const{$gettextInterpolate:e,$gettext:n,$ngettext:o}=(0,p.st)(),c=(0,p.Lu)({}),D=(0,d.ref)([]),L=t=>{const i=Math.floor(t.time/1e9);return i<60?e(o("%{ s } second","%{ s } seconds",i),{s:i}):(0,O.d5)(i)},s=async()=>{p.S8.start(e("Loading %{subject}...",{subject:n("database processes")}));const{data:t,error:i}=await _();t&&(D.value=t),i&&c(i),p.S8.stop()},r=async t=>{const{error:i}=await I(t);if(i){c(i);return}(0,p.d$)().success({title:n("Success"),content:n("Process successfully killed!")}),s()};return(0,d.onMounted)(()=>{s()}),{__sfc:!0,$gettextInterpolate:e,$gettext:n,$ngettext:o,notifyError:c,processes:D,formatProcessTime:L,getProcesses:s,killProcess:r}}}),P=N,j=a("../node_modules/vue-loader/lib/runtime/componentNormalizer.js"),$=(0,j.Z)(P,T,u,!1,null,null,null),y=$.exports}}]);
