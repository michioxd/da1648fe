"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9063],{"../node_modules/date-fns/esm/formatDistance/index.js":function(P,p,r){r.d(p,{Z:function(){return C}});var g=r("../node_modules/date-fns/esm/_lib/defaultOptions/index.js"),u=r("../node_modules/date-fns/esm/toDate/index.js"),l=r("../node_modules/date-fns/esm/_lib/requiredArgs/index.js");function M(a,n){(0,l.Z)(2,arguments);var t=(0,u.Z)(a),v=(0,u.Z)(n),x=t.getTime()-v.getTime();return x<0?-1:x>0?1:x}function T(a,n){(0,l.Z)(2,arguments);var t=(0,u.Z)(a),v=(0,u.Z)(n),x=t.getFullYear()-v.getFullYear(),O=t.getMonth()-v.getMonth();return x*12+O}function _(a){(0,l.Z)(1,arguments);var n=(0,u.Z)(a);return n.setHours(23,59,59,999),n}function D(a){(0,l.Z)(1,arguments);var n=(0,u.Z)(a),t=n.getMonth();return n.setFullYear(n.getFullYear(),t+1,0),n.setHours(23,59,59,999),n}function E(a){(0,l.Z)(1,arguments);var n=(0,u.Z)(a);return _(n).getTime()===D(n).getTime()}function z(a,n){(0,l.Z)(2,arguments);var t=(0,u.Z)(a),v=(0,u.Z)(n),x=M(t,v),O=Math.abs(T(t,v)),i;if(O<1)i=0;else{t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-x*O);var j=M(t,v)===-x;E((0,u.Z)(a))&&O===1&&M(a,v)===1&&(j=!1),i=x*(O-Number(j))}return i===0?0:i}function s(a,n){return(0,l.Z)(2,arguments),(0,u.Z)(a).getTime()-(0,u.Z)(n).getTime()}var e={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(n){return n<0?Math.ceil(n):Math.floor(n)}},d="trunc";function f(a){return a?e[a]:e[d]}function I(a,n,t){(0,l.Z)(2,arguments);var v=s(a,n)/1e3;return f(t==null?void 0:t.roundingMethod)(v)}var B=r("../node_modules/date-fns/esm/_lib/defaultLocale/index.js");function U(a,n){if(a==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(a[t]=n[t]);return a}function L(a){return U({},a)}var o=r("../node_modules/date-fns/esm/_lib/getTimezoneOffsetInMilliseconds/index.js"),c=1440,Z=2520,A=43200,$=86400;function C(a,n,t){var v,x;(0,l.Z)(2,arguments);var O=(0,g.j)(),i=(v=(x=t==null?void 0:t.locale)!==null&&x!==void 0?x:O.locale)!==null&&v!==void 0?v:B.Z;if(!i.formatDistance)throw new RangeError("locale must contain formatDistance property");var j=M(a,n);if(isNaN(j))throw new RangeError("Invalid time value");var m=U(L(t),{addSuffix:Boolean(t==null?void 0:t.addSuffix),comparison:j}),y,R;j>0?(y=(0,u.Z)(n),R=(0,u.Z)(a)):(y=(0,u.Z)(a),R=(0,u.Z)(n));var b=I(R,y),Q=((0,o.Z)(R)-(0,o.Z)(y))/1e3,h=Math.round((b-Q)/60),S;if(h<2)return t!=null&&t.includeSeconds?b<5?i.formatDistance("lessThanXSeconds",5,m):b<10?i.formatDistance("lessThanXSeconds",10,m):b<20?i.formatDistance("lessThanXSeconds",20,m):b<40?i.formatDistance("halfAMinute",0,m):b<60?i.formatDistance("lessThanXMinutes",1,m):i.formatDistance("xMinutes",1,m):h===0?i.formatDistance("lessThanXMinutes",1,m):i.formatDistance("xMinutes",h,m);if(h<45)return i.formatDistance("xMinutes",h,m);if(h<90)return i.formatDistance("aboutXHours",1,m);if(h<c){var W=Math.round(h/60);return i.formatDistance("aboutXHours",W,m)}else{if(h<Z)return i.formatDistance("xDays",1,m);if(h<A){var X=Math.round(h/c);return i.formatDistance("xDays",X,m)}else if(h<$)return S=Math.round(h/A),i.formatDistance("aboutXMonths",S,m)}if(S=z(R,y),S<12){var Y=Math.round(h/A);return i.formatDistance("xMonths",Y,m)}else{var F=S%12,N=Math.floor(S/12);return F<3?i.formatDistance("aboutXYears",N,m):F<9?i.formatDistance("overXYears",N,m):i.formatDistance("almostXYears",N+1,m)}}},"./js/api/commands/admin/mail-queue.js":function(P,p,r){r.r(p),r.d(p,{doAction:function(){return E},getQueue:function(){return D},getQueueItem:function(){return z}});var g=r("./js/api/command/index.js"),u=r("../node_modules/date-fns/esm/_lib/toInteger/index.js"),l=r("../node_modules/date-fns/esm/addMilliseconds/index.js"),M=r("../node_modules/date-fns/esm/_lib/requiredArgs/index.js");function T(s,e){(0,M.Z)(2,arguments);var d=(0,u.Z)(e);return(0,l.Z)(s,d*1e3)}function _(s,e){(0,M.Z)(2,arguments);var d=(0,u.Z)(e);return T(s,-d)}const D=g.Z.get({id:"MAIL_QUEUE",url:"/CMD_MAIL_QUEUE",pagination:!0,schema:{force:g.Z.OPTIONAL_BOOL},after:s=>e=>e.error?s.flow(s.project({queue_size:"queue_size",max_load_size:"mq_exim_max_load_size",error:"error"}),s.mapProp("error",s.convert.toAppBoolean))(e):s.flow(s.getProp("table"),s.toTable(s.mapArrayProps({time:d=>_(new Date,d),size:s.convert.toAppNumber,frozen:s.convert.toAppBoolean})))(e)}),E=g.Z.select({url:"/CMD_MAIL_QUEUE",schema:{action:g.Z.REQUIRED_STRING},before:({action:s})=>({[s]:!0,action:"select"})}),z=g.Z.get({id:"MAIL_QUEUE_ITEM",url:"/CMD_MAIL_QUEUE",schema:{id:g.Z.REQUIRED_STRING},after:s=>s.mapProps({body:s.convert.toAppText,headers:s.convert.toAppText,logs:s.convert.toAppText})})},"./js/composables/dateFilter.ts":function(P,p,r){r.d(p,{W:function(){return T},f:function(){return l.f}});var g=r("../node_modules/ramda/es/index.js"),u=r("../node_modules/date-fns/esm/format/index.js"),l=r("./js/modules/date-formats.ts"),M=r("./js/modules/customizations/date-formats/default.ts");const T=g.WAo((_,D)=>{if(D)try{return(0,u.Z)(D,l.f.value[_])}catch(E){return console.warn(`Given ${_} format is incorrect:
${E.message}`),(0,u.Z)(D,M.d[_])}return""})},"./js/composables/filters.ts":function(P,p,r){r.d(p,{Q0:function(){return I},aS:function(){return U},d5:function(){return B},eB:function(){return e},hT:function(){return z},kC:function(){return E},n9:function(){return f},zM:function(){return s}});var g=r("../node_modules/date-fns/esm/formatDistance/index.js"),u=r("../node_modules/punycode/punycode.es6.js"),l=r("./js/composables/dateFilter.ts"),M=r("./js/composables/gettext.ts");const{$gettext:T,$ngettext:_,$gettextInterpolate:D}=(0,M.Z)(),E=o=>{var c;return o?((c=o.at(0))===null||c===void 0?void 0:c.toUpperCase())+o.slice(1):""},z=(o,c="datetime")=>(0,l.W)(c,o),s=o=>(0,g.Z)(o,new Date),e=(o,c=1024)=>{const Z=Number(o);if(!Z)return"0 B";const A=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],$=Math.floor(Math.log(Z)/Math.log(c));return`${parseFloat((Z/c**$).toFixed(2))} ${A[$]}`},d=o=>{try{return(0,u.xX)(o)}catch(c){return o}},f=o=>(0,u.xX)(o),I=o=>{if(!o||!o.includes("@"))return o;const[c,Z]=o.split("@");return[c,d(Z)].join("@")},B=o=>{if(o<60)return T("less than a minute");const c=Math.floor(o/60)%60,Z=Math.floor(o/3600)%24,A=Math.floor(o/(3600*24)),$=[A?_("%{days} day","%{days} days",A):null,Z?_("%{hours} hour","%{hours} hours",Z):null,c?_("%{minutes} minute","%{minutes} minutes",c):null].filter(Boolean).join(", ");return D($,{days:A,hours:Z,minutes:c})},U=(o,c)=>o.length<=c?o:`${o.substring(0,c)}...`,L=()=>({capitalize:E,date:z,distanceFromNow:s,humanReadableSize:e,p6eUnicode:f,p6eUnicodeEmail:I,formatUptime:B,truncateString:U})},"./js/pages/admin/mail-queue/index.vue":function(P,p,r){r.r(p),r.d(p,{default:function(){return z}});var g=function(){var e=this,d=e._self._c;return d("app-page",{scopedSlots:e._u([{key:"default",fn:function(){return[e.$api.queue.error?d("app-page-section",[d("span",{domProps:{textContent:e._s(e.$gettextInterpolate(e.$gettext("Queue size (%{ queue_size }) is larger than the maximum value (%{ max_load_size}) and may timeout."),{queue_size:e.$api.queue.queue_size,max_load_size:e.$api.queue.max_load_size}))}}),e._v(" "),d("ui-button",{attrs:{theme:"danger",size:"normal"},on:{click:e.forceLoad}},[d("span",{domProps:{textContent:e._s(e.$gettext("Force Load"))}})])],1):d("app-page-section",[d("ui-api-table",e._b({attrs:{"initial-sort":{key:"time",order:"ASC"}},on:{"action:thaw":function(f){return e.doAction("thaw")},"action:freeze":function(f){return e.doAction("freeze")},"action:retry":function(f){return e.doAction("retry")},"action:bounce":function(f){return e.doAction("bounce")},"action:del":function(f){return e.doAction("delete")}},scopedSlots:e._u([{key:"col:id",fn:function({id:f,item:I}){return[d("ui-link",{attrs:{name:"admin/mail-queue/view",params:{id:f}}},[e._v(`
                        `+e._s(f)+`
                    `)]),e._v(" "),I.frozen?d("ui-tooltip",{attrs:{theme:"danger",icon:"warning"}},[d("span",{domProps:{textContent:e._s(e.$gettext("Frozen"))}})]):e._e()]}},{key:"col:time",fn:function({time:f}){return[e._v(`
                    `+e._s(e.distanceFromNow(f))+`
                `)]}},{key:"col:recipients",fn:function({recipients:f}){return e._l(f,function(I){return d("div",{directives:[{name:"margin",rawName:"v-margin",value:0,expression:"0"}],key:I},[e._v(`
                        `+e._s(I)+`
                    `)])})}}]),model:{value:e.select,callback:function(f){e.select=f},expression:"select"}},"ui-api-table",{command:e.$commands.getQueue,rowID:"id",requestData:{force:e.forceSet},columns:{id:{label:e.$gettext("ID"),searchable:!0},time:e.$gettext("Time"),size:e.$gettext("Size"),sender:{label:e.$gettext("Sender"),searchable:!0},recipients:{label:e.$gettext("Recipient(s)"),grow:!0,searchable:!0},frozen:{label:e.$gettext("Frozen"),hide:!0,searchable:{type:"select",options:{yes:e.$gettext("Yes"),no:e.$gettext("No")}}}},actions:{thaw:e.$gettext("Thaw"),freeze:e.$gettext("Freeze"),retry:e.$gettext("Retry"),bounce:e.$gettext("Bounce"),del:e.$gettext("Delete")}},!1))],1)]},proxy:!0}])})},u=[],l=r("./js/api/commands/admin/mail-queue.js"),M=r("./js/composables/filters.ts"),T={preload:l.getQueue,commands:l,api:[{command:l.getQueue,bind:"queue"}],props:{force:{type:Boolean,required:!1,default:!1}},data(){return{checkedRows:[],select:[],forceSet:this.force}},methods:{distanceFromNow:M.zM,forceLoad(){this.forceSet=!0,l.getQueue({force:this.forceSet})},async doAction(s){await l.doAction({action:s,select:this.select})&&(this.select=[],this.$reloadApiTable())}}},_=T,D=r("../node_modules/vue-loader/lib/runtime/componentNormalizer.js"),E=(0,D.Z)(_,g,u,!1,null,null,null),z=E.exports}}]);
