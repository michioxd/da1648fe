"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8589],{"../node_modules/date-fns/esm/formatDistance/index.js":function(k,O,i){i.d(O,{Z:function(){return z}});var I=i("../node_modules/date-fns/esm/_lib/defaultOptions/index.js"),d=i("../node_modules/date-fns/esm/toDate/index.js"),l=i("../node_modules/date-fns/esm/_lib/requiredArgs/index.js");function E(r,o){(0,l.Z)(2,arguments);var s=(0,d.Z)(r),m=(0,d.Z)(o),g=s.getTime()-m.getTime();return g<0?-1:g>0?1:g}function b(r,o){(0,l.Z)(2,arguments);var s=(0,d.Z)(r),m=(0,d.Z)(o),g=s.getFullYear()-m.getFullYear(),c=s.getMonth()-m.getMonth();return g*12+c}function M(r){(0,l.Z)(1,arguments);var o=(0,d.Z)(r);return o.setHours(23,59,59,999),o}function _(r){(0,l.Z)(1,arguments);var o=(0,d.Z)(r),s=o.getMonth();return o.setFullYear(o.getFullYear(),s+1,0),o.setHours(23,59,59,999),o}function P(r){(0,l.Z)(1,arguments);var o=(0,d.Z)(r);return M(o).getTime()===_(o).getTime()}function S(r,o){(0,l.Z)(2,arguments);var s=(0,d.Z)(r),m=(0,d.Z)(o),g=E(s,m),c=Math.abs(b(s,m)),e;if(c<1)e=0;else{s.getMonth()===1&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-g*c);var t=E(s,m)===-g;P((0,d.Z)(r))&&c===1&&E(r,m)===1&&(t=!1),e=g*(c-Number(t))}return e===0?0:e}function R(r,o){return(0,l.Z)(2,arguments),(0,d.Z)(r).getTime()-(0,d.Z)(o).getTime()}var j={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(o){return o<0?Math.ceil(o):Math.floor(o)}},F="trunc";function L(r){return r?j[r]:j[F]}function N(r,o,s){(0,l.Z)(2,arguments);var m=R(r,o)/1e3;return L(s==null?void 0:s.roundingMethod)(m)}var B=i("../node_modules/date-fns/esm/_lib/defaultLocale/index.js");function y(r,o){if(r==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(r[s]=o[s]);return r}function X(r){return y({},r)}var a=i("../node_modules/date-fns/esm/_lib/getTimezoneOffsetInMilliseconds/index.js"),u=1440,p=2520,x=43200,Z=86400;function z(r,o,s){var m,g;(0,l.Z)(2,arguments);var c=(0,I.j)(),e=(m=(g=s==null?void 0:s.locale)!==null&&g!==void 0?g:c.locale)!==null&&m!==void 0?m:B.Z;if(!e.formatDistance)throw new RangeError("locale must contain formatDistance property");var t=E(r,o);if(isNaN(t))throw new RangeError("Invalid time value");var n=y(X(s),{addSuffix:Boolean(s==null?void 0:s.addSuffix),comparison:t}),f,T;t>0?(f=(0,d.Z)(o),T=(0,d.Z)(r)):(f=(0,d.Z)(r),T=(0,d.Z)(o));var C=N(T,f),W=((0,a.Z)(T)-(0,a.Z)(f))/1e3,h=Math.round((C-W)/60),A;if(h<2)return s!=null&&s.includeSeconds?C<5?e.formatDistance("lessThanXSeconds",5,n):C<10?e.formatDistance("lessThanXSeconds",10,n):C<20?e.formatDistance("lessThanXSeconds",20,n):C<40?e.formatDistance("halfAMinute",0,n):C<60?e.formatDistance("lessThanXMinutes",1,n):e.formatDistance("xMinutes",1,n):h===0?e.formatDistance("lessThanXMinutes",1,n):e.formatDistance("xMinutes",h,n);if(h<45)return e.formatDistance("xMinutes",h,n);if(h<90)return e.formatDistance("aboutXHours",1,n);if(h<u){var $=Math.round(h/60);return e.formatDistance("aboutXHours",$,n)}else{if(h<p)return e.formatDistance("xDays",1,n);if(h<x){var V=Math.round(h/u);return e.formatDistance("xDays",V,n)}else if(h<Z)return A=Math.round(h/x),e.formatDistance("aboutXMonths",A,n)}if(A=S(T,f),A<12){var Y=Math.round(h/x);return e.formatDistance("xMonths",Y,n)}else{var U=A%12,v=Math.floor(A/12);return U<3?e.formatDistance("aboutXYears",v,n):U<9?e.formatDistance("overXYears",v,n):e.formatDistance("almostXYears",v+1,n)}}},"./js/composables/dateFilter.ts":function(k,O,i){i.d(O,{W:function(){return b},f:function(){return l.f}});var I=i("../node_modules/ramda/es/index.js"),d=i("../node_modules/date-fns/esm/format/index.js"),l=i("./js/modules/date-formats.ts"),E=i("./js/modules/customizations/date-formats/default.ts");const b=I.WAo((M,_)=>{if(_)try{return(0,d.Z)(_,l.f.value[M])}catch(P){return console.warn(`Given ${M} format is incorrect:
${P.message}`),(0,d.Z)(_,E.d[M])}return""})},"./js/composables/filters.ts":function(k,O,i){i.d(O,{Q0:function(){return N},aS:function(){return y},d5:function(){return B},eB:function(){return j},hT:function(){return S},kC:function(){return P},n9:function(){return L},zM:function(){return R}});var I=i("../node_modules/date-fns/esm/formatDistance/index.js"),d=i("../node_modules/punycode/punycode.es6.js"),l=i("./js/composables/dateFilter.ts"),E=i("./js/composables/gettext.ts");const{$gettext:b,$ngettext:M,$gettextInterpolate:_}=(0,E.Z)(),P=a=>{var u;return a?((u=a.at(0))===null||u===void 0?void 0:u.toUpperCase())+a.slice(1):""},S=(a,u="datetime")=>(0,l.W)(u,a),R=a=>(0,I.Z)(a,new Date),j=(a,u=1024)=>{const p=Number(a);if(!p)return"0 B";const x=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],Z=Math.floor(Math.log(p)/Math.log(u));return`${parseFloat((p/u**Z).toFixed(2))} ${x[Z]}`},F=a=>{try{return(0,d.xX)(a)}catch(u){return a}},L=a=>(0,d.xX)(a),N=a=>{if(!a||!a.includes("@"))return a;const[u,p]=a.split("@");return[u,F(p)].join("@")},B=a=>{if(a<60)return b("less than a minute");const u=Math.floor(a/60)%60,p=Math.floor(a/3600)%24,x=Math.floor(a/(3600*24)),Z=[x?M("%{days} day","%{days} days",x):null,p?M("%{hours} hour","%{hours} hours",p):null,u?M("%{minutes} minute","%{minutes} minutes",u):null].filter(Boolean).join(", ");return _(Z,{days:x,hours:p,minutes:u})},y=(a,u)=>a.length<=u?a:`${a.substring(0,u)}...`,X=()=>({capitalize:P,date:S,distanceFromNow:R,humanReadableSize:j,p6eUnicode:L,p6eUnicodeEmail:N,formatUptime:B,truncateString:y})},"./js/pages/user/clamav/index.vue":function(k,O,i){i.r(O),i.d(O,{default:function(){return g}});var I=function(){var e=this,t=e._self._c,n=e._self._setupProxy;return t("app-page",{scopedSlots:e._u([{key:"default",fn:function(){return[t("app-page-section",{scopedSlots:e._u([{key:"section:title",fn:function(){return[e._v(`
                `+e._s(e.$gettext("Scan directory to detect malware and other malicious threats."))+`
            `)]},proxy:!0},{key:"footer:buttons",fn:function(){return[t("ui-button",{attrs:{theme:"primary","validate-group":"job-init"},on:{click:n.startScan}},[t("span",{domProps:{textContent:e._s(e.$gettext("Scan Path"))}})])]},proxy:!0}])},[e._v(" "),t("ui-form-element",{attrs:{underline:!1},scopedSlots:e._u([{key:"content",fn:function(){return[t("input-radio",{attrs:{value:"home"},model:{value:n.type,callback:function(f){n.type=f},expression:"type"}},[t("span",{domProps:{textContent:e._s(e.$gettext("Home - Scan the home directory."))}})])]},proxy:!0}])}),e._v(" "),t("ui-form-element",{attrs:{underline:!1},scopedSlots:e._u([{key:"content",fn:function(){return[t("input-radio",{attrs:{value:"domains"},model:{value:n.type,callback:function(f){n.type=f},expression:"type"}},[t("span",{domProps:{textContent:e._s(e.$gettext("Domains - Scan the domains directory."))}})])]},proxy:!0}])}),e._v(" "),t("ui-form-element",{attrs:{underline:!1},scopedSlots:e._u([{key:"content",fn:function(){return[t("input-radio",{attrs:{value:"mail"},model:{value:n.type,callback:function(f){n.type=f},expression:"type"}},[t("span",{domProps:{textContent:e._s(e.$gettext("Mail - Scan all mail directories."))}})])]},proxy:!0}])}),e._v(" "),t("ui-form-element",{scopedSlots:e._u([{key:"title",fn:function(){return[t("input-radio",{attrs:{value:"custom"},model:{value:n.type,callback:function(f){n.type=f},expression:"type"}},[t("span",{domProps:{textContent:e._s(e.$gettext("Custom - Scan the desired path."))}})])]},proxy:!0},{key:"content",fn:function(){return[t("input-text",{attrs:{disabled:n.type!=="custom",prefix:`${e.$_session.homeDir}/`},model:{value:n.queryPath,callback:function(f){n.queryPath=f},expression:"queryPath"}})]},proxy:!0}])})],1),e._v(" "),n.listNotEmpty?t("app-page-section",{scopedSlots:e._u([{key:"section:title",fn:function(){return[e._v(`
                `+e._s(e.$gettext("List of currently active scans."))+`
            `)]},proxy:!0}],null,!1,3911512852)},[e._v(" "),t("ui-r-table",e._b({attrs:{"disable-pagination":""},scopedSlots:e._u([{key:"col:start_time",fn:function({start_time:f}){return[e._v(`
                    `+e._s(n.date(new Date(f),"datetime"))+`
                `)]}},{key:"row:actions",fn:function({item:f}){return[t("ui-button-icon",{attrs:{theme:"danger",icon:"cancel",title:e.$gettext("Cancel")},on:{click:function(T){return n.deleteProcessBefore(f)}}})]}}],null,!1,1959801319)},"ui-r-table",{rows:n.clamavList,columns:[{id:"pid",label:e.$gettext("PID")},{id:"path",label:e.$gettext("Path")},{id:"start_time",label:e.$gettext("Start time")}],verticalLayout:n.clientStore.isPhone,isCheckable:!1},!1))],1):e._e(),e._v(" "),t("app-page-section",{scopedSlots:e._u([{key:"section:title",fn:function(){return[t("div",[t("span",{domProps:{textContent:e._s(e.$gettext("Read finished scan reports in the"))}}),e._v(" "),t("ui-link",{attrs:{path:"/user/messages"}},[t("span",{domProps:{textContent:e._s(e.$gettext("Message Area"))}})])],1)]},proxy:!0}])}),e._v(" "),t("ui-dialog-delete-items",{attrs:{subject:e.$gettext("process:")},on:{"click:confirm":function(f){return n.deleteProcessAfter()}}},[e._v(`
            `+e._s(n.currentItemPid)+`
        `)])]},proxy:!0}])})},d=[],l=i("../node_modules/vue/dist/vue.common.prod.js"),E=i("./js/stores/index.ts"),b=i("./js/composables/dialog.ts"),M=i("./js/composables/filters.ts"),_=i("./js/api/openapi/index.ts"),P=i("./js/openapi/web.types.ts");const S=(0,_.$d)(),R=_.an.Default(async c=>{const{data:e}=await S.get("/api/clamav",c);return e.status==="success"&&P.lX.guard(e.data)===!1?S.failure({type:"INVALID_RESPONSE",response:e.data}):e}),j=_.an.Default(async(c,e)=>{const{data:t}=await S.post("/api/clamav",c,e);return t}),F=_.an.Default(async(c,e)=>{const{data:t}=await S.delete(`/api/clamav/${c}`,e);return t});var L=i("./js/composables/notify.ts"),N=i("./js/composables/gettext.ts"),B=i("./js/composables/useErrorMessages.ts");const{$gettext:y}=(0,N.Z)(),X=(0,L.d$)(),a=(0,B.L)({CLAMAV_PATH_NOT_FOUND:y("ClamAV path was not found"),CLAMAV_SCAN_LIMIT_ERROR:y("This path is already being scanned by ClamAV"),CLAMAV_PROCESS_NOT_FOUND:y("ClamAV process does not exist anymore")}),u=(0,l.ref)([]),p=async()=>{const c=await R();return c.error&&a(c.error),c},x=async c=>{const e=await j(c);return e.error?a(e.error):X.success({title:y("Start"),content:y("Directory scan process started")}),e},Z=async c=>{const e=await F(c);return e.error?a(e.error):X.success({title:y("Cancel"),content:y("Directory scan process canceled")}),e},z=(0,l.defineComponent)({async beforeRouteEnter(c,e,t){const{data:n}=await p();if(!n){t(!1);return}u.value=n.processes,t()}});var r=(0,l.defineComponent)({...z,__name:"index",emits:[],setup(c){const e=(0,E.oR)("client"),t=(0,l.ref)("0"),n=(0,l.ref)(""),f=(0,l.ref)("home"),T=(0,l.ref)(30*1e3),C=(0,l.ref)(!0),W=(0,l.ref)(),h=(0,l.computed)(()=>u.value.length>0);(0,l.onMounted)(()=>{U()}),(0,l.onBeforeUnmount)(()=>{clearTimeout(W.value)});async function A(){const v=["Maildir","imap"];switch(f.value){case"home":$("");break;case"domains":$("domains");break;case"mail":v.forEach(D=>{$(D)});break;case"custom":$(n.value),n.value="";break}}async function $(v){var D;const{error:w}=await x({path:v});if(!w){const{data:H}=await p();u.value=(D=H==null?void 0:H.processes)!==null&&D!==void 0?D:[]}}async function V(v){t.value=v.pid.toString(),(0,b.R)("DELETE_ITEMS_DIALOG").open()}async function Y(){var v;const{error:D}=await Z(t.value);if(!D){const{data:w}=await p();u.value=(v=w==null?void 0:w.processes)!==null&&v!==void 0?v:[]}}async function U(){var v;if(C.value){const{data:D}=await p();u.value=(v=D==null?void 0:D.processes)!==null&&v!==void 0?v:[]}W.value=setTimeout(U,T.value)}return{__sfc:!0,clientStore:e,currentItemPid:t,queryPath:n,type:f,refreshTimeout:T,refresh:C,timeoutId:W,listNotEmpty:h,startScan:A,createScan:$,deleteProcessBefore:V,deleteProcessAfter:Y,refreshList:U,date:M.hT,clamavList:u}}}),o=r,s=i("../node_modules/vue-loader/lib/runtime/componentNormalizer.js"),m=(0,s.Z)(o,I,d,!1,null,null,null),g=m.exports}}]);
