"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[6926],{"./js/api/commands/user/domains/index.js":function(R,v,o){o.d(v,{x6:function(){return T},R6:function(){return s},Fj:function(){return b},Uq:function(){return w},Ak:function(){return m},fp:function(){return M},ge:function(){return N},Px:function(){return C},Qv:function(){return Z},Nk:function(){return I},gP:function(){return P},v$:function(){return A},xh:function(){return e},$A:function(){return k},ql:function(){return S}});var t=o("./js/api/command/index.js"),a=o("../node_modules/ramda/es/index.js"),l=o("./js/api/commands/converters/index.ts");const D=a.zGw(Number,Number.isFinite),_=n=>({domain:n.domain,active:(0,l.sw)(n.active),defaultdomain:(0,l.sw)(n.defaultdomain),subdomain:(0,l.He)(n.subdomain),bandwidth:(0,l.cc)({usage:D(n.bandwidth)?n.bandwidth:"0",limit:n.bandwidth_limit}),quota:(0,l.cc)({usage:D(n.quota)?n.quota:"0",limit:n.quota_limit}),pointers:a.zGw(a.yAE({}),a.XPQ,a.UID(String))(n.pointers)}),y=n=>({bandwidth:n.bandwidth,quota:n.quota,ssl:n.ssl==="ON",cgi:n.cgi==="ON",php:n.php==="ON",show_ips:n.has_multiple_ips==="yes",show_php:n.has_php_selector==="yes",force_ssl:n.force_ssl==="yes",private_html:n.private_html==="link"?"symlink":"directory",force_redirect:n.force_redirect||"none",modsecurity:n.modsecurity==="yes",nginx:n.nginx==="1",hasPerDomainNginx:n.HAS_PER_DOMAIN_NGINX==="yes"}),g=n=>({type:"checkbox",value:n.value==="ON"||n.checked==="yes",description:n.desc||"",label:n.string||"",api_only:n.api_only==="yes",hidden:n.hidden==="yes"}),r=n=>({type:"text",description:n.desc||"",label:n.string||"",value:n.value||"",api_only:n.api_only==="yes",hidden:n.hidden==="yes"}),u=n=>{const x=Object.keys(n).filter(O=>/^item\d+val*$/.test(O)).reduce((O,E)=>({...O,[n[E]]:n[E.replace("val","txt")]||""}),{});return{type:"select",description:n.desc||"",label:n.string||"",value:n.value||n.default||"",options:x,api_only:n.api_only==="yes",hidden:n.hidden==="yes"}},p=n=>n.split("&").reduce((x,O)=>{const[E="",$=""]=O.split("=");return{...x,[E]:$}},{}),i=n=>{switch(n.type){case"listbox":return u(n);case"checkbox":return g(n);default:return r(n)}};var h={getDomains:n=>a.UID(_,a.VO0(n)),getDomain:{domain:y,custom_items:n=>{const x=a.IDH(p,n.custom_domain_items||{}),O=a.zXx(a.XPQ(x),n),E=a.viO(a.IDH(U=>({value:U}),O),x);return a.IDH(i,E)}},getPhpVersions:n=>{if(n.has_php_selector==="yes"){if(typeof n.php1_select=="object")return{enabled:!0,legacy:n.php_selector_count==="2",versions:(0,l.M1)(n.php1_select)};const x=a.eiS(a.UID(O=>`php${O}_select`,a.w6H(1,5)),n.options);return{enabled:!0,versions:{value:n.php1_select,options:x},legacy:n.php_selector_count==="2"}}else return{enabled:!1,legacy:!1,versions:{options:{},value:""}}}};const I=t.Z.get({id:"GET_DOMAINS",url:"/CMD_ADDITIONAL_DOMAINS",params:{bytes:!0},response:[],mapResponse:h.getDomains}),N=t.Z.get({id:"GET_DOMAIN",url:"/CMD_ADDITIONAL_DOMAINS",params:{action:"view"},schema:{domain:t.Z.DOMAIN},mapResponse:h.getDomain}),M=t.Z.get({id:"DOMAIN_CUSTOM_ITEMS",url:"/HTM_ADD_DOMAIN",mapResponse:h.getDomain.custom_items}),d=t.Z.select({url:"/CMD_DOMAIN"}),e=d.extend({params:{default:!0}}),s=d.extend({params:{reason:"Other",suspend:!0}}),m=d.extend({params:{delete:!0,confirmed:!0,delete_data_aware:!0},schema:{delete_data:t.Z.REQUIRED_BOOL}}),b=t.Z.post({url:"/CMD_DOMAIN",params:{action:"create"},schema:{domain:t.Z.REQUIRED_STRING,bandwidth:t.Z.OPTIONAL_STRING,unbandwidth:t.Z.OPTIONAL_STRING,quota:t.Z.OPTIONAL_STRING,uquota:t.Z.OPTIONAL_STRING,ssl:t.Z.OPTIONAL_STRING,cgi:t.Z.OPTIONAL_STRING,php:t.Z.OPTIONAL_STRING},notifySuccess:!0,notifyError:!0}),A=t.Z.post({url:"/CMD_CHANGE_DOMAIN",params:{json:!0},schema:{old_domain:t.Z.REQUIRED_STRING,new_domain:t.Z.REQUIRED_STRING}}),P=t.Z.post({url:"/CMD_DOMAIN",params:{action:"modify",form_version:"1.1"},body:{domain:t.Z.DOMAIN,bandwidth:t.Z.REQUIRED_STRING,ubandwidth:t.Z.REQUIRED_STRING,quota:t.Z.REQUIRED_STRING,uquota:t.Z.REQUIRED_STRING,ssl:t.Z.REQUIRED_STRING,php:t.Z.REQUIRED_STRING,cgi:t.Z.REQUIRED_STRING,www_pointers:t.Z.OPTIONAL_STRING,force_redirect:t.Z.REQUIRED_STRING}}),S=t.Z.post({url:"/CMD_DOMAIN",params:{action:"private_html"},schema:{domain:t.Z.DOMAIN,val:{...t.Z.REQUIRED_STRING,validator:n=>["directory","symlink"].includes(n)},force_ssl:t.Z.OPTIONAL_BOOL},notifySuccess:!1}),T=t.Z.post({url:"/CMD_DOMAIN",params:{action:"multi_ip",add:!0},schema:{domain:t.Z.DOMAIN,ip:t.Z.REQUIRED_STRING,dns:t.Z.OPTIONAL_BOOL}}),C=t.Z.get({id:"DOMAIN_IPS",url:"/CMD_ADDITIONAL_DOMAINS",params:{action:"view",ips:!0},schema:{domain:t.Z.DOMAIN},after:n=>n.flow(n.project({assigned:"assigned_ips",available:"available_ips"}),n.mapProp("assigned",n.mapArray(x=>({ip:x}))))}),w=t.Z.post({url:"/CMD_DOMAIN",params:{action:"multi_ip",delete:!0},schema:{domain:t.Z.DOMAIN,select:t.Z.ROWS,removedns:t.Z.OPTIONAL_BOOL}}),Z=t.Z.get({id:"DOMAIN_PHP_VERSIONS",url:"/CMD_ADDITIONAL_DOMAINS",params:{action:"view"},domain:!0,mapResponse:h.getPhpVersions}),k=t.Z.post({url:"/CMD_DOMAIN",method:"POST",params:{action:"php_selector",save:!0},domain:!0,schema:{php1_select:t.Z.REQUIRED_STRING}})},"./js/api/commands/converters/customItems.ts":function(R,v,o){o.d(v,{CR:function(){return _}});var t=o("../node_modules/ramda/es/index.js"),a=o("./js/api/commands/converters/index.ts"),l=o("./js/api/commands/utils/transduce.ts"),D=o("./js/api/commands/converters/toSelectData.ts");const _=r=>{const u={name:r.name,type:r.type==="listbox"?"select":r.type,label:r.string,description:r.desc||"",value:r.type==="checkbox"?(0,a.sw)(r.checked||"no"):r.value||""};return u.type==="select"?t.BPw(u,(0,D.M1)(r.select||{})):u},y=r=>(0,l.vr)([(0,l.uD)(u=>/^item\d+val$/.test(u)),(0,l.r5)(u=>{const p=u,i=u.replace("val","txt"),f=r[p],c=r[i];return{[f]:c}})],Object.keys(r)),g=(r,u)=>t.qCK(i=>{const f={name:i.name,type:i.type==="listbox"?"select":i.type,description:i.desc||"",value:i.value||"",label:i.string};return i.type==="listbox"?(f.value=i.default,f.options=y(i)):i.type==="checkbox"&&(f.value=i.checked==="yes"),f},t.BPw({name:r}),(0,l.vr)([(0,l.r5)(i=>{const[f,c]=t.Vl2("=",i);return{[f]:c}})]),t.Vl2("&"))(u);v.ZP={fromObject:_,fromString:g}},"./js/api/commands/converters/index.ts":function(R,v,o){o.d(v,{l$:function(){return p.ZP},t0:function(){return t.t0},S8:function(){return t.S8},ql:function(){return t.ql},sw:function(){return t.sw},Qu:function(){return t.Qu},He:function(){return t.He},M1:function(){return u.M1},sf:function(){return f},cc:function(){return r}});var t=o("./js/api/commands/converters/primitive.ts"),a=o("../node_modules/monet/dist/monet.js"),l=o("./js/api/commands/types.ts");const D=c=>typeof c=="object"?a.Either.Right(c):a.Either.Left(new Error("Passed param is not an object")),_=c=>typeof c.usage=="string"?a.Either.Right(c):a.Either.Left(new Error("usage property is required")),y=c=>({usage:(0,t.He)(c.usage),limit:(0,t.Qu)(c.limit)}),g=({usage:c,limit:h})=>{let I=l.H.Normal;const N=Math.floor(c/h*100);return N>=100?I=l.H.OverUsed:N>80&&(I=l.H.AlmostUsed),{usage:c,limit:h,status:I}},r=c=>{const h=a.Either.Right(c).flatMap(D).flatMap(_).map(y).map(g);if(h.isLeft())throw h.left();return h.right()};var u=o("./js/api/commands/converters/toSelectData.ts"),p=o("./js/api/commands/converters/customItems.ts"),i=o("../node_modules/ramda/es/index.js");const f=c=>h=>{const{info:I}=h,N=i.CEd(["info"],h);return{columns:I.columns,rowsCount:Number(I.rows),rows:i.UID(c,i.VO0(N))}}},"./js/api/commands/converters/toSelectData.ts":function(R,v,o){o.d(v,{M1:function(){return g}});var t=o("../node_modules/monet/dist/monet.js"),a=o.n(t),l=o("./js/api/commands/utils/transduce.ts"),D=o("../node_modules/ramda/es/index.js");const _=r=>t.Maybe.Some(r).flatMap(u=>{const p=u.find(i=>i.selected==="yes");return p?t.Maybe.Some(p):t.Maybe.None()}).flatMap(u=>t.Maybe.fromNull(u.value)).orSome(""),y=(0,l.vr)([(0,l.r5)(r=>({[r.value]:r.text}))]),g=r=>{const u=(0,D.VO0)(r);return{value:_(u),options:y(u)}}},"./js/api/commands/types.ts":function(R,v,o){o.d(v,{H:function(){return t}});var t;(function(a){a.Normal="normal",a.AlmostUsed="almost_used",a.OverUsed="overused"})(t||(t={}))},"./js/api/commands/utils/transduce.ts":function(R,v,o){o.d(v,{Re:function(){return D},r5:function(){return a},uD:function(){return l},vr:function(){return u},zh:function(){return g}});var t=o("../node_modules/ramda/es/index.js");const a=p=>i=>(f,c)=>{const h=p(c);return i(f,h)},l=p=>i=>(f,c)=>p(c)?i(f,c):f,D=(p,i)=>(p.push(i),p),_=(p,i)=>t.BPw(p,i),y=(p,i,f,c)=>{const h=t.qCK(...f);return c.reduce(h(i),p)},g=t.WAo(y),r=g([],D),u=g({},_)},"./js/components/local/layouts/standard-2021/components/info-bar-text-item.vue":function(R,v,o){o.d(v,{Z:function(){return y}});var t=function(){var r=this,u=r._self._c;return u("div",{staticClass:"info-bar-data-text-item"},[u("span",{staticClass:"info-bar-text-item-label"},[r._t("label")],2),r._v(" "),u("span",{staticClass:"info-bar-text-item-value"},[r._t("value")],2)])},a=[],l=o("../node_modules/vue-loader/lib/runtime/componentNormalizer.js"),D={},_=(0,l.Z)(D,t,a,!1,null,null,null),y=_.exports},"./js/pages/user/domains/index.vue":function(R,v,o){o.r(v),o.d(v,{default:function(){return M}});var t=function(){var e=this,s=e._self._c;return s("app-page",{attrs:{actions:[{handler:()=>e.$router.push("/user/domains/add-domain"),label:e.$gettext("Add New"),visible:e.permissions.add&&e.domainUsage.usage<e.domainUsage.limit,icon:"#plus-fill",theme:"safe"},{label:e.$gettext("Rename domain"),handler:e.$dialog("RENAME_DOMAIN_DIALOG").open,visible:e.$_cmd("/CMD_CHANGE_DOMAIN"),icon:"#pencil"}]},scopedSlots:e._u([{key:"details",fn:function(){return[s("ui-infobar-item",{attrs:{title:e.$gettext("Details")}},[s("text-item",{scopedSlots:e._u([{key:"label",fn:function(){return[e._v(e._s(e.$gettext("Default Domain")))]},proxy:!0},{key:"value",fn:function(){return[e._v(`
                    `+e._s(e.defaultDomain)+`
                `)]},proxy:!0}])}),e._v(" "),s("ui-infobar-stats",e._b({attrs:{title:e.$gettext("Domains")}},"ui-infobar-stats",e.domainUsage,!1))],1)]},proxy:!0},{key:"default",fn:function(){return[e.clientStore.isPhone&&e.$_layout!=="standard2021"?s("app-page-section",[s("ui-stats-summary",{attrs:{badges:[{label:e.$gettext("Domains"),value:e.$api.domains.length},{label:e.$gettext("Default Domain"),value:e.defaultDomain}]}})],1):e._e(),e._v(" "),s("app-page-section",[s("ui-r-table",{attrs:{rows:e.$api.domains,columns:[{id:"domain",label:e.$gettext("Domain"),grow:!0,editable:!1},{id:"bandwidth",label:e.$gettext("Bandwidth")},{id:"quota",label:e.$gettext("Disk Usage")},{id:"subdomain",label:e.$gettext("Subdomains")},e.hasPointers?{id:"pointers",label:e.$gettext("Pointers")}:{}],"checked-rows":e.checkedRows,"rows-count":e.$api.domains.length,"disable-pagination":"","vertical-layout":e.clientStore.isPhone,"sort-by":e.sortBy},on:{"update:checkedRows":function(m){e.checkedRows=m}},scopedSlots:e._u([{key:"buttons:before",fn:function(){return[!e.clientStore.isPhone&&e.$_layout!=="standard2021"?s("ui-stats-summary",{attrs:{badges:[{label:e.$gettext("Domains"),value:e.$api.domains.length},{label:e.$gettext("Default Domain"),value:e.defaultDomain}]}}):e._e()]},proxy:!0},{key:"table:actions",fn:function(){return[e.checkedRows.length<=1?s("ui-table-action",{on:{click:e.setCheckedAsDefault}},[s("span",{domProps:{textContent:e._s(e.$gettext("Set as default"))}})]):e._e(),e._v(" "),s("ui-table-action",{on:{click:e.changeDomainStatus}},[s("span",{domProps:{textContent:e._s(e.$gettext("Suspend / Unsuspend"))}})]),e._v(" "),e.permissions.delete?s("ui-table-action",{on:{click:function(m){e.$dialog("DELETE_ITEMS_DIALOG").open()}}},[s("span",{domProps:{textContent:e._s(e.$gettext("Delete"))}})]):e._e()]},proxy:!0},{key:"col:domain",fn:function({domain:m,defaultdomain:b,active:A}){return[s("div",{staticClass:"wrap:nowrap overfl:hid toverfl:ellipsis"},[s("ui-link",{class:{"txt:bold":b},attrs:{name:"user/domains/edit",params:{domain:m}}},[e._v(`
                            `+e._s(e.$p6e.toU(m))+`
                        `)]),e._v(" "),A?e._e():s("ui-tooltip",{attrs:{theme:"danger",icon:"warning"}},[s("span",{domProps:{textContent:e._s(e.$gettext("Suspended"))}})])],1)]}},{key:"col:bandwidth",fn:function({bandwidth:m}){return[s("ui-limited-usage",e._b({},"ui-limited-usage",m,!1))]}},{key:"col:quota",fn:function({quota:m}){return[s("ui-limited-usage",e._b({},"ui-limited-usage",m,!1))]}},{key:"col:active",fn:function({item:m}){return[m.active?s("span",{domProps:{textContent:e._s(e.$gettext("Active"))}}):s("span",{domProps:{textContent:e._s(e.$gettext("Suspended"))}})]}},{key:"col:pointers",fn:function({pointers:m}){return[m.length?s("div",e._l(m,function(b){return s("div",{key:b},[s("strong",[e._v("P:")]),e._v(`
                            `+e._s(b)+`
                        `)])}),0):s("span")]}}])}),e._v(" "),s("ui-dialog-delete-items",{attrs:{subject:e.$ngettext("domain","domains",e.checkedDomains.length)},on:{"click:confirm":e.deleteDomains}},[s("input-checkbox",{directives:[{name:"margin",rawName:"v-margin",value:[1,0],expression:"[1, 0]"}],model:{value:e.deleteData,callback:function(m){e.deleteData=m},expression:"deleteData"}},[s("span",{domProps:{textContent:e._s(e.$gettext("Delete web data"))}})])],1)],1),e._v(" "),s("rename-domain-dialog",{on:{rename:e.loadDomains}})]},proxy:!0}])})},a=[],l=o("./js/stores/index.ts"),D=o("../node_modules/ramda/es/index.js"),_=o("./js/api/commands/user/domains/index.js"),y=function(){var e=this,s=e._self._c;return s("ui-dialog",{attrs:{id:"RENAME_DOMAIN_DIALOG",title:e.$gettext("Rename Domain")},scopedSlots:e._u([{key:"content",fn:function(){return[s("ui-form-element",{attrs:{vertical:"",group:"renameDomain",validators:{required:!0}},scopedSlots:e._u([{key:"title",fn:function(){return[e._v(e._s(e.$gettext("Old Domain")))]},proxy:!0},{key:"tooltip",fn:function(){return[s("span",{domProps:{textContent:e._s(e.$gettext("Select the domain to change and enter its new value"))}})]},proxy:!0},{key:"content",fn:function(){return[s("input-select",{attrs:{options:e.domains},model:{value:e.oldDomain,callback:function(m){e.oldDomain=m},expression:"oldDomain"}})]},proxy:!0}])}),e._v(" "),s("ui-form-element",{attrs:{validators:{required:!0,domain:!0},group:"renameDomain",vertical:""},scopedSlots:e._u([{key:"title",fn:function(){return[e._v(e._s(e.$gettext("New Domain")))]},proxy:!0},{key:"content",fn:function(){return[s("input-text",{model:{value:e.newDomain,callback:function(m){e.newDomain=m},expression:"newDomain"}})]},proxy:!0},{key:"error:domain",fn:function(){return[s("span",{domProps:{textContent:e._s(e.$gettext("Should be valid domain name"))}})]},proxy:!0}])})]},proxy:!0},{key:"buttons",fn:function(){return[s("ui-button",{attrs:{"validate-group":"renameDomain",theme:"primary"},on:{click:e.renameDomain}},[s("span",{domProps:{textContent:e._s(e.$gettext("Save"))}})])]},proxy:!0}])})},g=[],r={data:()=>({newDomain:"",oldDomain:""}),computed:{domains(){const d=this.$_session.domainsList,e=(s,m)=>({...s,[m]:this.$p6e.toU(m)});return d.reduce(e,{})}},methods:{async renameDomain(){const d=this.$p6e.toA(this.newDomain);d!==this.newDomain&&this.$notifications.info({title:this.$gettext("Domain name punycoded"),content:this.$gettext("Domain name has been automatically converted to punycode format. Punycode is used to encode internationalized domain names (IDN) by converting Unicode characters to ASCII.")}),await(0,_.v$)({new_domain:d,old_domain:this.oldDomain}),this.$_ctx.session.loadUserConfig(),this.$emit("rename"),Object.assign(this.$data,this.$options.data.apply(this))}}},u=r,p=o("../node_modules/vue-loader/lib/runtime/componentNormalizer.js"),i=(0,p.Z)(u,y,g,!1,null,null,null),f=i.exports,c=o("./js/components/local/layouts/standard-2021/components/info-bar-text-item.vue"),h={name:"DomainIndex",components:{RenameDomainDialog:f,TextItem:c.Z},preload:_.Nk,provide(){return{getClass:(d,e)=>e==="quota"||e==="bandwidth"?`--usage:${this.$api.domains[d][e].status}`:""}},api:[{command:_.Nk,bind:"domains"}],data:()=>({checkedRows:[],deleteData:!0}),computed:{checkedDomains(){return this.checkedRows.map(d=>d.domain)},defaultDomain(){const d=({defaultdomain:s})=>s,{domain:e=""}=this.$api.domains.find(d)||this.$api.domains[0]||{};return this.$p6e.toU(e)},sortBy(){return d=>D.ETc(D.q9t(d,["quota","bandwidth"])?[d,"usage"]:[d])},hasPointers(){return this.$api.domains.some(d=>d.pointers.length)},permissions(){const d=this.$_session.usersManageDomains;return{add:d!==2,delete:d===0}},domainUsage(){return{usage:this.$api.domains.length,limit:this.$_session.usage.domains.limit}},...(0,l.Kc)(["client"])},methods:{loadDomains(){(0,_.Nk)(),Object.assign(this.$data,this.$options.data.apply(this))},async setCheckedAsDefault(){await(0,_.xh)({select:this.checkedDomains})&&this.loadDomains()},async changeDomainStatus(){await(0,_.R6)({select:this.checkedDomains})&&this.loadDomains()},async deleteDomains(){if(await(0,_.Ak)({select:this.checkedDomains,delete_data:this.deleteData})){await this.$_ctx.session.loadUserConfig();const{domainsList:e,defaultDomain:s}=this.$_session;if(e.length===0){this.$notifications.info({title:this.$gettext("No default domain"),content:this.$gettext("You deleted all of your domains. You should create one for full functionality.")}),this.$router.push({name:"user/domains/add"}),this.$_ctx.session.setDomain("");return}this.checkedDomains.includes(this.$domain)&&(e.includes(s)?this.$_ctx.session.setDomain(s):this.$_ctx.session.setDomain(e[0])),this.loadDomains()}}}},I=h,N=(0,p.Z)(I,t,a,!1,null,null,null),M=N.exports}}]);
