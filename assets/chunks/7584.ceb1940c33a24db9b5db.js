(self.webpackChunk=self.webpackChunk||[]).push([[7584],{"./js/pages/user/protected-directories/_commands/index.js":function(a,i,o){"use strict";o.d(i,{$z:function(){return f},Ee:function(){return D},Tp:function(){return v},Vt:function(){return y},cn:function(){return g},fE:function(){return x},m6:function(){return j},nb:function(){return R},wX:function(){return p}});var s=o("./js/api/command/index.js"),u=o("../node_modules/ramda/es/index.js");const l="/CMD_FILE_MANAGER",v=s.Z.post({url:l,params:{action:"protect",enabled:!0},schema:{path:s.Z.REQUIRED_STRING,user:s.Z.REQUIRED_STRING,passwd:s.Z.REQUIRED_STRING,passwd2:s.Z.REQUIRED_STRING}}),f=s.Z.get({id:"PROTECTED_DIRECTORIES",url:"/CMD_PROTECTED_DIRECTORIES",domain:!0,response:[]}),j=s.Z.get({id:"PROTECTED_DIRECTORY_STATUS",url:l,params:{action:"protect"},schema:{path:s.Z.REQUIRED_STRING},response:{protected:!1},after:()=>({ENABLED:r})=>({protected:!!r})}).extend({id:"PROTECTED_DIRECTORY_INFO",pagination:!0,response:{},after:r=>r.flow(r.deleteProp("ENABLED"),r.deleteProp("domain"),r.deleteProp("path"),r.processTableInfo("users"),r.moveProp({users:"rows",NAME:"name"}),r.mapProp("rows",r.toArray))}),g=s.Z.post({url:l,params:{action:"protect",enabled:!0},schema:{name:s.Z.REQUIRED_STRING,path:s.Z.REQUIRED_STRING,user:s.Z.REQUIRED_STRING,passwd:s.Z.REQUIRED_STRING,passwd2:s.Z.REQUIRED_STRING}}),y=s.Z.select({url:l,params:{action:"delete"},schema:{path:s.Z.REQUIRED_STRING}}),x=s.Z.post({url:l,params:{action:"protect"},schema:{name:s.Z.REQUIRED_STRING,path:s.Z.REQUIRED_STRING}}),D=s.Z.post({url:l,params:{action:"protect",enabled:!0},schema:{name:s.Z.REQUIRED_STRING,path:s.Z.REQUIRED_STRING}}),p=s.Z.get({url:"/CMD_FILE_MANAGER",params:{action:"json_all",ipp:1e5,comparison12:"equals",value12:"directory"}}),R=s.Z.get({id:"GET_PROTECTABLE_ROOTS",url:"/CMD_SUBDOMAIN",schema:{domain:s.Z.DOMAIN,ipp:9999},response:[],after:(r,h)=>b=>{const P=u.CEd(["info"],b.subdomains),S=`/domains/${h.domain}`,m=Object.values(P).map(c=>c.public_html);return[S,...m]}})},"../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/user/protected-directories/_components/fm-tree-body.vue?vue&type=style&index=0&id=7704cf32&prod&lang=scss&":function(){},"../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/user/protected-directories/_components/fm-tree-header.vue?vue&type=style&index=0&id=6590b1be&prod&lang=scss&":function(){},"../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/user/protected-directories/_components/fm-tree.vue?vue&type=style&index=0&id=49ea60c6&prod&lang=scss&":function(){},"./js/pages/user/protected-directories/add.vue":function(a,i,o){"use strict";o.r(i),o.d(i,{default:function(){return $}});var s=function(){var e=this,t=e._self._c;return t("app-page",{scopedSlots:e._u([{key:"default",fn:function(){return[t("app-page-section",[t("ui-form-element",{scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("Path"))}})]},proxy:!0},{key:"content",fn:function(){return[t("div",[t("fm-tree",{attrs:{protected:e.$api},model:{value:e.path,callback:function(n){e.path=n},expression:"path"}}),e._v(" "),e.path?t("input-text",{directives:[{name:"margin",rawName:"v-margin:top",value:.5,expression:"0.5",arg:"top"}],staticClass:"width:100%",attrs:{value:e.path,disabled:""}}):e._e()],1)]},proxy:!0}])}),e._v(" "),t("ui-form-element",{attrs:{vertical:""}}),e._v(" "),t("ui-form-element",{attrs:{group:"protectDir",validators:{required:!0}},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("Protected Directory Prompt"))}})]},proxy:!0},{key:"content",fn:function(){return[t("input-text",{attrs:{placeholder:e.$gettext("e.g. Member's Area")},model:{value:e.name,callback:function(n){e.name=n},expression:"name"}})]},proxy:!0}])}),e._v(" "),t("ui-form-element",{attrs:{group:"protectDir",validators:{required:!0}},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("Set/Update User"))}})]},proxy:!0},{key:"content",fn:function(){return[t("input-text",{model:{value:e.user,callback:function(n){e.user=n},expression:"user"}})]},proxy:!0}])}),e._v(" "),t("ui-form-element",{attrs:{group:"protectDir",validators:{required:!0}},scopedSlots:e._u([{key:"title",fn:function(){return[t("span",{domProps:{textContent:e._s(e.$gettext("Password"))}})]},proxy:!0},{key:"content",fn:function(){return[t("input-password",{attrs:{"show-generator":""},model:{value:e.passwd,callback:function(n){e.passwd=n},expression:"passwd"}})]},proxy:!0}])})],1)]},proxy:!0},{key:"footer:buttons",fn:function(){return[t("ui-button",{attrs:{theme:"primary","validate-group":"protectDir",disabled:e.path===""},on:{click:e.protectDirectory}},[t("span",{domProps:{textContent:e._s(e.$gettext("Protect"))}})])]},proxy:!0}])})},u=[],l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"fm-tree scrollbar:primary"},[e.loading?t("ui-center",{attrs:{height:"400px"}},[t("ui-loader-icon",{attrs:{size:32}})],1):t("fm-tree-body",e._b({on:{select:e.chooseDirectory,expand:e.togglePath}},"fm-tree-body",{nodes:e.nodes},!1))],1)},v=[],f=function(){var e=this,t=e._self._c;return t("div",{staticClass:"fm-tree-body"},e._l(e.nodes,function(n){return t("div",{key:n.path,staticClass:"fm-tree-item"},[t("fm-tree-header",e._g(e._b({},"fm-tree-header",n,!1),e.$listeners)),e._v(" "),n.expanded&&n.children.length?t("fm-tree-body",e._g({attrs:{nodes:n.children}},e.$listeners)):e._e()],1)}),0)},E=[],j=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"flex",rawName:"v-flex",value:{dir:"row",cross:"center"},expression:"{ dir: 'row', cross: 'center' }"}],staticClass:"fm-tree-header"},[t("span",{staticClass:"fm-tree-header-expand cursor:pointer",on:{click:function(n){return e.$emit("expand",e.path)}}},[e.lazy?t("ui-icon",{class:{"--expanded":e.expanded},attrs:{id:"caret-right",size:12,color:"var(--primary)"}}):e._e()],1),e._v(" "),t("input-checkbox",e._b({directives:[{name:"margin",rawName:"v-margin:left",value:1,expression:"1",arg:"left"},{name:"margin",rawName:"v-margin:right",value:.5,expression:"0.5",arg:"right"}],on:{change:function(n){return e.$emit("select",e.path)}}},"input-checkbox",{model:e.model,disabled:e.disabled},!1),[t("span",{class:{"txt:bold":e.protectable&&e.isProtected===!1},domProps:{textContent:e._s(e.name)}})]),e._v(" "),e.isProtected?t("ui-tooltip",{scopedSlots:e._u([{key:"trigger",fn:function(){return[e.isProtected?t("ui-link",{attrs:{name:"user/protected-directories/view",query:{path:e.path}}},[t("ui-icon",{attrs:{id:"exclamation-triangle"}})],1):e._e()]},proxy:!0}],null,!1,111692736)},[t("span",{domProps:{textContent:e._s(e.$gettext("Edit Protection"))}})]):e._e()],1)},g=[],y={props:{path:{type:String,required:!0},name:{type:String,required:!0},protectable:Boolean,selected:Boolean,expanded:Boolean,isProtected:Boolean,lazy:Boolean},computed:{model(){return this.selected||this.isProtected},disabled(){return this.protectable===!1||this.isProtected===!0}}},x=y,D=o("../node_modules/vue-style-loader/index.js!../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/user/protected-directories/_components/fm-tree-header.vue?vue&type=style&index=0&id=6590b1be&prod&lang=scss&"),p=o("../node_modules/vue-loader/lib/runtime/componentNormalizer.js"),R=(0,p.Z)(x,j,g,!1,null,null,null),r=R.exports,h={name:"FmTreeBody",components:{FmTreeBody:m,FmTreeHeader:r},props:{nodes:{type:Array,required:!0}}},b=h,P=o("../node_modules/vue-style-loader/index.js!../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/user/protected-directories/_components/fm-tree-body.vue?vue&type=style&index=0&id=7704cf32&prod&lang=scss&"),S=(0,p.Z)(b,f,E,!1,null,null,null),m=S.exports,c=o("./js/pages/user/protected-directories/_commands/index.js"),I=o("../node_modules/ramda/es/index.js"),N={name:"FmTree",components:{FmTreeBody:m},model:{prop:"value",event:"update:value"},props:{value:{type:String,required:!0},protected:{type:Array,required:!1,default:()=>[]}},data:()=>({expanded:[],roots:[],dirs:{},loading:!0}),computed:{nodes(){const d=t=>this.roots.some(n=>I.Nyw(n,t.path)||I.Nyw(t.path,n)),e=t=>(this.dirs[t]||[]).filter(d).map(_=>({..._,children:e(_.path),expanded:this.isExpanded(_.path),selected:this.value===_.path}));return e("/domains")}},watch:{$domain(){this.loadDirs("/domains")}},async mounted(){await this.loadDirs("/domains"),this.loading=!1},methods:{isExpanded(d){return this.expanded.includes(d)},chooseDirectory(d){this.$emit("update:value",d)},async loadDirs(d){let e=await(0,c.wX)({path:d});delete e.info,this.$set(this.dirs,d,Object.values(e).filter(t=>t.islink==="0").map(t=>({protectable:(Number(t.api_flags)&1)===1,name:t.name,path:t.truepath,lazy:Number(t.sub_directories)>0,isProtected:this.protected.includes(t.truepath)}))),this.roots=await(0,c.nb)()},async togglePath(d){this.isExpanded(d)?this.expanded=this.expanded.filter(e=>d!==e):(await this.loadDirs(d),this.expanded.push(d))},getPathChildren(d){return this.dirs[d]||[]}}},w=N,O=o("../node_modules/vue-style-loader/index.js!../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/user/protected-directories/_components/fm-tree.vue?vue&type=style&index=0&id=49ea60c6&prod&lang=scss&"),T=(0,p.Z)(w,l,v,!1,null,null,null),C=T.exports,Z={preload:c.$z,components:{FmTree:C},api:c.$z,data:()=>({path:"",name:"",user:"",passwd:""}),methods:{async protectDirectory(){await(0,c.Tp)({path:this.path,name:this.name,user:this.user,passwd:this.passwd,passwd2:this.passwd})instanceof Error||this.$router.push({name:"user/protected-directories/view",query:{path:this.path}})}}},k=Z,U=(0,p.Z)(k,s,u,!1,null,null,null),$=U.exports},"../node_modules/vue-style-loader/index.js!../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/user/protected-directories/_components/fm-tree-body.vue?vue&type=style&index=0&id=7704cf32&prod&lang=scss&":function(a,i,o){var s=o("../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/user/protected-directories/_components/fm-tree-body.vue?vue&type=style&index=0&id=7704cf32&prod&lang=scss&");s.__esModule&&(s=s.default),typeof s=="string"&&(s=[[a.id,s,""]]),s.locals&&(a.exports=s.locals);var u=o("../node_modules/vue-style-loader/lib/addStylesClient.js").Z,l=u("1edbbfe6",s,!0,{})},"../node_modules/vue-style-loader/index.js!../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/user/protected-directories/_components/fm-tree-header.vue?vue&type=style&index=0&id=6590b1be&prod&lang=scss&":function(a,i,o){var s=o("../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/user/protected-directories/_components/fm-tree-header.vue?vue&type=style&index=0&id=6590b1be&prod&lang=scss&");s.__esModule&&(s=s.default),typeof s=="string"&&(s=[[a.id,s,""]]),s.locals&&(a.exports=s.locals);var u=o("../node_modules/vue-style-loader/lib/addStylesClient.js").Z,l=u("05c2433e",s,!0,{})},"../node_modules/vue-style-loader/index.js!../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/user/protected-directories/_components/fm-tree.vue?vue&type=style&index=0&id=49ea60c6&prod&lang=scss&":function(a,i,o){var s=o("../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/user/protected-directories/_components/fm-tree.vue?vue&type=style&index=0&id=49ea60c6&prod&lang=scss&");s.__esModule&&(s=s.default),typeof s=="string"&&(s=[[a.id,s,""]]),s.locals&&(a.exports=s.locals);var u=o("../node_modules/vue-style-loader/lib/addStylesClient.js").Z,l=u("39f2e311",s,!0,{})}}]);
