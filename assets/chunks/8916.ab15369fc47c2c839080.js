"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8916],{"./js/pages/user/security-questions.vue":function(f,u,n){n.r(u),n.d(u,{default:function(){return v}});var o={};n.r(o),n.d(o,{addQuestion:function(){return p},deleteQuestions:function(){return c},getSettings:function(){return i},submitAnswer:function(){return S},updateQuestion:function(){return m},updateSettings:function(){return l}});var d=function(){var t=this,r=t._self._c;return r("app-page",{attrs:{actions:[{label:t.$gettext("Disable"),handler:t.disable,icon:"#console",visible:t.table.rows.length,theme:"danger"}]},scopedSlots:t._u([{key:"default",fn:function(){return[r("app-page-section",[r("ui-api-table",t._b({ref:"table",on:{"action:del":t.deleteCheckedQuestions},model:{value:t.select,callback:function(T){t.select=T},expression:"select"}},"ui-api-table",{command:t.$commands.getSettings,property:"table",rowID:"id",columns:{id:t.$gettext("ID"),q:{label:t.$gettext("Security Question"),grow:!0}},actions:{del:t.$gettext("Delete")}},!1))],1)]},proxy:!0}])})},_=[],s=n("./js/api/command/index.js");const a="/CMD_SECURITY_QUESTIONS",i=s.Z.get({id:"SECURITY_SETTINGS",url:a,after:e=>e.flow(e.project({questions:"new_questions","table.rows":"questions","settings.api_with_password":"SECURITY_QUESTIONS_ON_API_CHECKED","settings.notify_on_all_question_failures":"NOTIFY_ON_ALL_FAILURES_CHECKED","settings.security_questions":"SECURITY_QUESTIONS_CHECKED","settings.max_attempts":"MAX_ATTEMPTS"}),e.mapProps({table:e.flow(e.processTableInfo("rows"),e.mapProp("rows",e.flow(e.toArray,e.mapArrayProps({q:e.convert.toAppString})))),settings:e.mapProps({notify_on_all_question_failures:e.isEqual("checked"),api_with_password:e.isEqual("checked"),security_questions:e.isEqual("checked")})}))}),l=s.Z.post({url:a,params:{action:"settings",version:"1",save:"Save",json:null},schema:{security_questions:s.Z.OPTIONAL_BOOL,api_with_password:s.Z.OPTIONAL_BOOL,notify_on_all_question_failures:s.Z.OPTIONAL_BOOL,max_attempts:s.Z.OPTIONAL_STRING}}),p=s.Z.post({url:a,params:{action:"add"},schema:{type:s.Z.REQUIRED_STRING,question:s.Z.OPTIONAL_STRING,value:s.Z.REQUIRED_STRING},before:({type:e,question:t})=>({custom_question:e==="custom"?t:null,question:e==="custom"?null:t})}),c=s.Z.select({url:a,params:{delete:!0}}),m=s.Z.select({url:a,params:{set:!0},schema:{value:s.Z.REQUIRED_STRING}}),S=s.Z.post({url:"/CMD_ASK_SECURITY_QUESTION",params:{action:"submit",referer:window.location.href},schema:{answer:s.Z.REQUIRED_STRING}});var g={preload:i,api:i,commands:o,data:()=>({select:[]}),computed:{table(){return this.$api.table}},methods:{reload(){var e;(e=this.$refs.table)==null||e.reloadTable()},async disable(){await l({action:"settings",version:"1",security_questions:!1,api_with_password:this.$api.settings.api_with_password||null,notify_on_all_question_failures:this.$api.settings.notify_on_all_question_failures||null,save:"Save"}),this.$router.replace("/")},async deleteCheckedQuestions(){await c({select:this.select}),this.reload()}}},I=g,h=n("../node_modules/vue-loader/lib/runtime/componentNormalizer.js"),E=(0,h.Z)(I,d,_,!1,null,null,null),v=E.exports}}]);
