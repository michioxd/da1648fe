"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[8847],{"./js/api/commands/user/domains/index.js":function(P,_,o){o.d(_,{x6:function(){return Z},R6:function(){return l},Fj:function(){return x},Uq:function(){return w},Ak:function(){return O},fp:function(){return E},ge:function(){return R},Px:function(){return C},Qv:function(){return U},Nk:function(){return g},gP:function(){return S},v$:function(){return T},xh:function(){return s},$A:function(){return j},ql:function(){return b}});var e=o("./js/api/command/index.js"),r=o("../node_modules/ramda/es/index.js"),i=o("./js/api/commands/converters/index.ts");const v=r.zGw(Number,Number.isFinite),f=t=>({domain:t.domain,active:(0,i.sw)(t.active),defaultdomain:(0,i.sw)(t.defaultdomain),subdomain:(0,i.He)(t.subdomain),bandwidth:(0,i.cc)({usage:v(t.bandwidth)?t.bandwidth:"0",limit:t.bandwidth_limit}),quota:(0,i.cc)({usage:v(t.quota)?t.quota:"0",limit:t.quota_limit}),pointers:r.zGw(r.yAE({}),r.XPQ,r.UID(String))(t.pointers)}),h=t=>({bandwidth:t.bandwidth,quota:t.quota,ssl:t.ssl==="ON",cgi:t.cgi==="ON",php:t.php==="ON",show_ips:t.has_multiple_ips==="yes",show_php:t.has_php_selector==="yes",force_ssl:t.force_ssl==="yes",private_html:t.private_html==="link"?"symlink":"directory",force_redirect:t.force_redirect||"none",modsecurity:t.modsecurity==="yes",nginx:t.nginx==="1",hasPerDomainNginx:t.HAS_PER_DOMAIN_NGINX==="yes"}),I=t=>({type:"checkbox",value:t.value==="ON"||t.checked==="yes",description:t.desc||"",label:t.string||"",api_only:t.api_only==="yes",hidden:t.hidden==="yes"}),a=t=>({type:"text",description:t.desc||"",label:t.string||"",value:t.value||"",api_only:t.api_only==="yes",hidden:t.hidden==="yes"}),u=t=>{const y=Object.keys(t).filter(N=>/^item\d+val*$/.test(N)).reduce((N,A)=>({...N,[t[A]]:t[A.replace("val","txt")]||""}),{});return{type:"select",description:t.desc||"",label:t.string||"",value:t.value||t.default||"",options:y,api_only:t.api_only==="yes",hidden:t.hidden==="yes"}},d=t=>t.split("&").reduce((y,N)=>{const[A="",M=""]=N.split("=");return{...y,[A]:M}},{}),n=t=>{switch(t.type){case"listbox":return u(t);case"checkbox":return I(t);default:return a(t)}};var p={getDomains:t=>r.UID(f,r.VO0(t)),getDomain:{domain:h,custom_items:t=>{const y=r.IDH(d,t.custom_domain_items||{}),N=r.zXx(r.XPQ(y),t),A=r.viO(r.IDH(L=>({value:L}),N),y);return r.IDH(n,A)}},getPhpVersions:t=>{if(t.has_php_selector==="yes"){if(typeof t.php1_select=="object")return{enabled:!0,legacy:t.php_selector_count==="2",versions:(0,i.M1)(t.php1_select)};const y=r.eiS(r.UID(N=>`php${N}_select`,r.w6H(1,5)),t.options);return{enabled:!0,versions:{value:t.php1_select,options:y},legacy:t.php_selector_count==="2"}}else return{enabled:!1,legacy:!1,versions:{options:{},value:""}}}};const g=e.Z.get({id:"GET_DOMAINS",url:"/CMD_ADDITIONAL_DOMAINS",params:{bytes:!0},response:[],mapResponse:p.getDomains}),R=e.Z.get({id:"GET_DOMAIN",url:"/CMD_ADDITIONAL_DOMAINS",params:{action:"view"},schema:{domain:e.Z.DOMAIN},mapResponse:p.getDomain}),E=e.Z.get({id:"DOMAIN_CUSTOM_ITEMS",url:"/HTM_ADD_DOMAIN",mapResponse:p.getDomain.custom_items}),D=e.Z.select({url:"/CMD_DOMAIN"}),s=D.extend({params:{default:!0}}),l=D.extend({params:{reason:"Other",suspend:!0}}),O=D.extend({params:{delete:!0,confirmed:!0,delete_data_aware:!0},schema:{delete_data:e.Z.REQUIRED_BOOL}}),x=e.Z.post({url:"/CMD_DOMAIN",params:{action:"create"},schema:{domain:e.Z.REQUIRED_STRING,bandwidth:e.Z.OPTIONAL_STRING,unbandwidth:e.Z.OPTIONAL_STRING,quota:e.Z.OPTIONAL_STRING,uquota:e.Z.OPTIONAL_STRING,ssl:e.Z.OPTIONAL_STRING,cgi:e.Z.OPTIONAL_STRING,php:e.Z.OPTIONAL_STRING},notifySuccess:!0,notifyError:!0}),T=e.Z.post({url:"/CMD_CHANGE_DOMAIN",params:{json:!0},schema:{old_domain:e.Z.REQUIRED_STRING,new_domain:e.Z.REQUIRED_STRING}}),S=e.Z.post({url:"/CMD_DOMAIN",params:{action:"modify",form_version:"1.1"},body:{domain:e.Z.DOMAIN,bandwidth:e.Z.REQUIRED_STRING,ubandwidth:e.Z.REQUIRED_STRING,quota:e.Z.REQUIRED_STRING,uquota:e.Z.REQUIRED_STRING,ssl:e.Z.REQUIRED_STRING,php:e.Z.REQUIRED_STRING,cgi:e.Z.REQUIRED_STRING,www_pointers:e.Z.OPTIONAL_STRING,force_redirect:e.Z.REQUIRED_STRING}}),b=e.Z.post({url:"/CMD_DOMAIN",params:{action:"private_html"},schema:{domain:e.Z.DOMAIN,val:{...e.Z.REQUIRED_STRING,validator:t=>["directory","symlink"].includes(t)},force_ssl:e.Z.OPTIONAL_BOOL},notifySuccess:!1}),Z=e.Z.post({url:"/CMD_DOMAIN",params:{action:"multi_ip",add:!0},schema:{domain:e.Z.DOMAIN,ip:e.Z.REQUIRED_STRING,dns:e.Z.OPTIONAL_BOOL}}),C=e.Z.get({id:"DOMAIN_IPS",url:"/CMD_ADDITIONAL_DOMAINS",params:{action:"view",ips:!0},schema:{domain:e.Z.DOMAIN},after:t=>t.flow(t.project({assigned:"assigned_ips",available:"available_ips"}),t.mapProp("assigned",t.mapArray(y=>({ip:y}))))}),w=e.Z.post({url:"/CMD_DOMAIN",params:{action:"multi_ip",delete:!0},schema:{domain:e.Z.DOMAIN,select:e.Z.ROWS,removedns:e.Z.OPTIONAL_BOOL}}),U=e.Z.get({id:"DOMAIN_PHP_VERSIONS",url:"/CMD_ADDITIONAL_DOMAINS",params:{action:"view"},domain:!0,mapResponse:p.getPhpVersions}),j=e.Z.post({url:"/CMD_DOMAIN",method:"POST",params:{action:"php_selector",save:!0},domain:!0,schema:{php1_select:e.Z.REQUIRED_STRING}})},"./js/api/commands/converters/customItems.ts":function(P,_,o){o.d(_,{CR:function(){return f}});var e=o("../node_modules/ramda/es/index.js"),r=o("./js/api/commands/converters/index.ts"),i=o("./js/api/commands/utils/transduce.ts"),v=o("./js/api/commands/converters/toSelectData.ts");const f=a=>{const u={name:a.name,type:a.type==="listbox"?"select":a.type,label:a.string,description:a.desc||"",value:a.type==="checkbox"?(0,r.sw)(a.checked||"no"):a.value||""};return u.type==="select"?e.BPw(u,(0,v.M1)(a.select||{})):u},h=a=>(0,i.vr)([(0,i.uD)(u=>/^item\d+val$/.test(u)),(0,i.r5)(u=>{const d=u,n=u.replace("val","txt"),m=a[d],c=a[n];return{[m]:c}})],Object.keys(a)),I=(a,u)=>e.qCK(n=>{const m={name:n.name,type:n.type==="listbox"?"select":n.type,description:n.desc||"",value:n.value||"",label:n.string};return n.type==="listbox"?(m.value=n.default,m.options=h(n)):n.type==="checkbox"&&(m.value=n.checked==="yes"),m},e.BPw({name:a}),(0,i.vr)([(0,i.r5)(n=>{const[m,c]=e.Vl2("=",n);return{[m]:c}})]),e.Vl2("&"))(u);_.ZP={fromObject:f,fromString:I}},"./js/api/commands/converters/index.ts":function(P,_,o){o.d(_,{l$:function(){return d.ZP},t0:function(){return e.t0},S8:function(){return e.S8},ql:function(){return e.ql},sw:function(){return e.sw},Qu:function(){return e.Qu},He:function(){return e.He},M1:function(){return u.M1},sf:function(){return m},cc:function(){return a}});var e=o("./js/api/commands/converters/primitive.ts"),r=o("../node_modules/monet/dist/monet.js"),i=o("./js/api/commands/types.ts");const v=c=>typeof c=="object"?r.Either.Right(c):r.Either.Left(new Error("Passed param is not an object")),f=c=>typeof c.usage=="string"?r.Either.Right(c):r.Either.Left(new Error("usage property is required")),h=c=>({usage:(0,e.He)(c.usage),limit:(0,e.Qu)(c.limit)}),I=({usage:c,limit:p})=>{let g=i.H.Normal;const R=Math.floor(c/p*100);return R>=100?g=i.H.OverUsed:R>80&&(g=i.H.AlmostUsed),{usage:c,limit:p,status:g}},a=c=>{const p=r.Either.Right(c).flatMap(v).flatMap(f).map(h).map(I);if(p.isLeft())throw p.left();return p.right()};var u=o("./js/api/commands/converters/toSelectData.ts"),d=o("./js/api/commands/converters/customItems.ts"),n=o("../node_modules/ramda/es/index.js");const m=c=>p=>{const{info:g}=p,R=n.CEd(["info"],p);return{columns:g.columns,rowsCount:Number(g.rows),rows:n.UID(c,n.VO0(R))}}},"./js/api/commands/converters/toSelectData.ts":function(P,_,o){o.d(_,{M1:function(){return I}});var e=o("../node_modules/monet/dist/monet.js"),r=o.n(e),i=o("./js/api/commands/utils/transduce.ts"),v=o("../node_modules/ramda/es/index.js");const f=a=>e.Maybe.Some(a).flatMap(u=>{const d=u.find(n=>n.selected==="yes");return d?e.Maybe.Some(d):e.Maybe.None()}).flatMap(u=>e.Maybe.fromNull(u.value)).orSome(""),h=(0,i.vr)([(0,i.r5)(a=>({[a.value]:a.text}))]),I=a=>{const u=(0,v.VO0)(a);return{value:f(u),options:h(u)}}},"./js/api/commands/types.ts":function(P,_,o){o.d(_,{H:function(){return e}});var e;(function(r){r.Normal="normal",r.AlmostUsed="almost_used",r.OverUsed="overused"})(e||(e={}))},"./js/api/commands/utils/transduce.ts":function(P,_,o){o.d(_,{Re:function(){return v},r5:function(){return r},uD:function(){return i},vr:function(){return u},zh:function(){return I}});var e=o("../node_modules/ramda/es/index.js");const r=d=>n=>(m,c)=>{const p=d(c);return n(m,p)},i=d=>n=>(m,c)=>d(c)?n(m,c):m,v=(d,n)=>(d.push(n),d),f=(d,n)=>e.BPw(d,n),h=(d,n,m,c)=>{const p=e.qCK(...m);return c.reduce(p(n),d)},I=e.WAo(h),a=I([],v),u=I({},f)},"./js/pages/user/domains/ips.vue":function(P,_,o){o.r(_),o.d(_,{default:function(){return E}});var e=function(){var s=this,l=s._self._c;return l("app-page",{attrs:{actions:s.actions},scopedSlots:s._u([{key:"default",fn:function(){return[l("app-page-section",[l("ui-r-table",{attrs:{rows:s.assigned,"checked-rows":s.checkedRows,columns:[{id:"ip",label:s.$ngettext("Assigned IP","Assigned IPs",s.assigned.length)}]},on:{"update:checkedRows":function(O){s.checkedRows=O}},scopedSlots:s._u([{key:"table:actions",fn:function(){return[s.checkedRows.length<s.assigned.length?l("ui-table-action",{on:{click:function(O){s.$dialog("DELETE_ITEMS_DIALOG").open()}}},[l("span",{domProps:{textContent:s._s(s.$gettext("Delete"))}})]):s._e()]},proxy:!0}])})],1),s._v(" "),l("ui-dialog-delete-items",{attrs:{subject:s.$ngettext("IP","IPs",s.checkedRows.length)},on:{"click:confirm":s.deleteIPs}},[l("input-checkbox",{directives:[{name:"margin",rawName:"v-margin",value:[1,0],expression:"[1, 0]"}],model:{value:s.removedns,callback:function(O){s.removedns=O},expression:"removedns"}},[l("span",{domProps:{textContent:s._s(s.$ngettext("Remove DNS records for IP","Remove DNS records for IPs",s.checkedRows.length))}})])],1),s._v(" "),l("add-ip-to-domain-dialog")]},proxy:!0}])})},r=[],i=o("./js/api/commands/user/domains/index.js"),v=function(){var s=this,l=s._self._c;return l("ui-dialog",{attrs:{id:"ADD_IP_TO_DOMAIN_DIALOG",title:s.$gettext("Add Another IP")},on:{"dialog:open":s.onOpen},scopedSlots:s._u([{key:"content",fn:function(){return[l("div",[l("ui-form-element",{attrs:{vertical:""},scopedSlots:s._u([{key:"title",fn:function(){return[s._v(s._s(s.$gettext("Select IP to Add")))]},proxy:!0},{key:"content",fn:function(){return[l("input-select",{attrs:{options:s.available},model:{value:s.ip,callback:function(O){s.ip=O},expression:"ip"}})]},proxy:!0}])}),s._v(" "),l("ui-form-element",{attrs:{vertical:""},scopedSlots:s._u([{key:"content",fn:function(){return[l("input-checkbox",{model:{value:s.dns,callback:function(O){s.dns=O},expression:"dns"}},[l("span",{domProps:{textContent:s._s(s.$gettext("Add DNS records for this IP"))}})])]},proxy:!0}])})],1)]},proxy:!0},{key:"buttons",fn:function(){return[l("ui-button",{attrs:{theme:"primary"},on:{click:s.assignIP}},[l("span",{domProps:{textContent:s._s(s.$gettext("Save"))}})])]},proxy:!0}])})},f=[],h={data:()=>({ip:"",dns:!0}),api:[{command:i.Px,bind:"ips"}],computed:{available(){return this.$api.ips.available}},methods:{async assignIP(){await(0,i.x6)({ip:this.ip,domain:this.$domain,dns:this.dns||null})&&(0,i.Px)()},onOpen(){[this.ip]=this.available}}},I=h,a=o("../node_modules/vue-loader/lib/runtime/componentNormalizer.js"),u=(0,a.Z)(I,v,f,!1,null,null,null),d=u.exports,n=o("./js/composables/index.ts");const{$gettext:m}=(0,n.st)(),c=(0,n.Rh)("ADD_IP_TO_DOMAIN_DIALOG");var p={components:{AddIpToDomainDialog:d},preload:i.Px,api:[{command:i.Px,bind:"ips"}],data:()=>({assigned:[],available:[],checkedRows:[],removedns:!0}),computed:{actions(){return[{label:m("Add IP"),handler:c.open,visible:this.available.length,icon:"#plus-fill"}]}},mounted(){var D,s;this.assigned=(D=this.$api.ips.assigned)!=null?D:[],this.available=(s=this.$api.ips.available)!=null?s:[]},methods:{async deleteIPs(){await(0,i.Uq)({select:this.checkedRows.map(D=>D.ip),removedns:this.removedns||null}),(0,i.Px)(),Object.assign(this.$data,this.$options.data.apply(this))}}},g=p,R=(0,a.Z)(g,e,r,!1,null,null,null),E=R.exports}}]);
