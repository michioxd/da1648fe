(self.webpackChunk=self.webpackChunk||[]).push([[1614],{"../node_modules/date-fns/esm/formatDistance/index.js":function(S,y,a){"use strict";a.d(y,{Z:function(){return U}});var n=a("../node_modules/date-fns/esm/_lib/defaultOptions/index.js"),c=a("../node_modules/date-fns/esm/toDate/index.js"),i=a("../node_modules/date-fns/esm/_lib/requiredArgs/index.js");function _(d,u){(0,i.Z)(2,arguments);var l=(0,c.Z)(d),f=(0,c.Z)(u),h=l.getTime()-f.getTime();return h<0?-1:h>0?1:h}function x(d,u){(0,i.Z)(2,arguments);var l=(0,c.Z)(d),f=(0,c.Z)(u),h=l.getFullYear()-f.getFullYear(),D=l.getMonth()-f.getMonth();return h*12+D}function g(d){(0,i.Z)(1,arguments);var u=(0,c.Z)(d);return u.setHours(23,59,59,999),u}function T(d){(0,i.Z)(1,arguments);var u=(0,c.Z)(d),l=u.getMonth();return u.setFullYear(u.getFullYear(),l+1,0),u.setHours(23,59,59,999),u}function k(d){(0,i.Z)(1,arguments);var u=(0,c.Z)(d);return g(u).getTime()===T(u).getTime()}function I(d,u){(0,i.Z)(2,arguments);var l=(0,c.Z)(d),f=(0,c.Z)(u),h=_(l,f),D=Math.abs(x(l,f)),m;if(D<1)m=0;else{l.getMonth()===1&&l.getDate()>27&&l.setDate(30),l.setMonth(l.getMonth()-h*D);var A=_(l,f)===-h;k((0,c.Z)(d))&&D===1&&_(d,f)===1&&(A=!1),m=h*(D-Number(A))}return m===0?0:m}function j(d,u){return(0,i.Z)(2,arguments),(0,c.Z)(d).getTime()-(0,c.Z)(u).getTime()}var E={ceil:Math.ceil,round:Math.round,floor:Math.floor,trunc:function(u){return u<0?Math.ceil(u):Math.floor(u)}},w="trunc";function b(d){return d?E[d]:E[w]}function R(d,u,l){(0,i.Z)(2,arguments);var f=j(d,u)/1e3;return b(l==null?void 0:l.roundingMethod)(f)}var M=a("../node_modules/date-fns/esm/_lib/defaultLocale/index.js");function C(d,u){if(d==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var l in u)Object.prototype.hasOwnProperty.call(u,l)&&(d[l]=u[l]);return d}function O(d){return C({},d)}var t=a("../node_modules/date-fns/esm/_lib/getTimezoneOffsetInMilliseconds/index.js"),o=1440,e=2520,s=43200,r=86400;function U(d,u,l){var f,h;(0,i.Z)(2,arguments);var D=(0,n.j)(),m=(f=(h=l==null?void 0:l.locale)!==null&&h!==void 0?h:D.locale)!==null&&f!==void 0?f:M.Z;if(!m.formatDistance)throw new RangeError("locale must contain formatDistance property");var A=_(d,u);if(isNaN(A))throw new RangeError("Invalid time value");var p=C(O(l),{addSuffix:Boolean(l==null?void 0:l.addSuffix),comparison:A}),N,Z;A>0?(N=(0,c.Z)(u),Z=(0,c.Z)(d)):(N=(0,c.Z)(d),Z=(0,c.Z)(u));var P=R(Z,N),B=((0,t.Z)(Z)-(0,t.Z)(N))/1e3,v=Math.round((P-B)/60),$;if(v<2)return l!=null&&l.includeSeconds?P<5?m.formatDistance("lessThanXSeconds",5,p):P<10?m.formatDistance("lessThanXSeconds",10,p):P<20?m.formatDistance("lessThanXSeconds",20,p):P<40?m.formatDistance("halfAMinute",0,p):P<60?m.formatDistance("lessThanXMinutes",1,p):m.formatDistance("xMinutes",1,p):v===0?m.formatDistance("lessThanXMinutes",1,p):m.formatDistance("xMinutes",v,p);if(v<45)return m.formatDistance("xMinutes",v,p);if(v<90)return m.formatDistance("aboutXHours",1,p);if(v<o){var G=Math.round(v/60);return m.formatDistance("aboutXHours",G,p)}else{if(v<e)return m.formatDistance("xDays",1,p);if(v<s){var Q=Math.round(v/o);return m.formatDistance("xDays",Q,p)}else if(v<r)return $=Math.round(v/s),m.formatDistance("aboutXMonths",$,p)}if($=I(Z,N),$<12){var W=Math.round(v/s);return m.formatDistance("xMonths",W,p)}else{var K=$%12,L=Math.floor($/12);return K<3?m.formatDistance("aboutXYears",L,p):K<9?m.formatDistance("overXYears",L,p):m.formatDistance("almostXYears",L+1,p)}}},"./js/api/commands/reseller/tickets.js":function(S,y,a){"use strict";a.d(y,{DU:function(){return w},Fv:function(){return E},J9:function(){return i},Kw:function(){return b},Pp:function(){return I},QC:function(){return k},SP:function(){return x},TF:function(){return C},_U:function(){return g},a5:function(){return M},ax:function(){return j},je:function(){return T},pR:function(){return R},x$:function(){return O}});var n=a("./js/api/command/index.js"),c=a("../node_modules/date-fns/esm/formatDistance/index.js");const i=n.Z.post({url:"/CMD_TICKET_CREATE",params:{action:"create",type:"message",user:"multiple",priority:"20"},schema:{users:n.Z.ROWS,subject:n.Z.REQUIRED_STRING,message:n.Z.REQUIRED_STRING,emailOnly:{...n.Z.OPTIONAL_BOOL,default:!1},all_email_accounts:n.Z.OPTIONAL_BOOL}}),_={...n.Z.OPTIONAL_BOOL,default:!0},x=n.Z.get({id:"TICKETS",url:"/CMD_TICKET_MANAGE",response:{tickets:[],info:{columns:[],pagination:{},tickets:{}}},pagination:!0,schema:{show_open:_,show_hold:_,show_closed:_},after:t=>t.flow(t.wrap("rows"),t.moveProp({"rows.info.new_all":"filters.all.new","rows.info.num_all":"filters.all.total","rows.info.new_hold":"filters.hold.new","rows.info.num_hold":"filters.hold.total","rows.info.new_open":"filters.open.new","rows.info.num_open":"filters.open.total","rows.info.new_closed":"filters.closed.new","rows.info.num_closed":"filters.closed.total","rows.info.active":"enabled","rows.info.html":"message"}),t.processTableInfo("rows"),t.mapProps({rows:t.flow(t.toArray,t.mapArrayProps({new:t.convert.toAppBoolean,priority:t.convert.toAppNumber,replies:t.convert.toAppNumber,last_message:t.convert.toAppDate,subject:t.convert.toAppString,user:t.convert.toAppString})),filters:t.mapValues(t.mapProps({new:t.convert.toAppNumber,total:t.convert.toAppNumber})),enabled:t.convert.toAppBoolean,message:t.convert.toAppHtml}))}),g=n.Z.get({id:"TICKET_MESSAGES",url:"/CMD_TICKET_MANAGE",response:[],params:{action:"view",type:"ticket"},schema:{number:n.Z.REQUIRED_STRING},after:t=>t.flow(t.deleteProp("info"),t.toArray,o=>o.reverse(),t.mapArrayProps({message:t.convert.toAppHtml,time:o=>(0,c.Z)(Date.now(),t.convert.toAppDate(o))}))}),T=n.Z.select({url:"/CMD_TICKET_MANAGE",params:{close:!0}}),k=n.Z.post({url:"/CMD_TICKET_MANAGE",params:{action:"status",status:"open"},schema:{number:n.Z.REQUIRED_STRING}}),I=n.Z.select({url:"/CMD_TICKET_MANAGE",params:{read:!0}}),j=n.Z.post({url:"/CMD_TICKET_CREATE",params:{action:"create",type:"request"},before:({email_only:t})=>({encoding:t?"utf-8":null}),schema:{user:n.Z.REQUIRED_STRING,priority:{...n.Z.REQUIRED_STRING,validator:t=>["10","20","30"].includes(t)},subject:n.Z.REQUIRED_STRING,message:n.Z.REQUIRED_STRING,email_only:n.Z.OPTIONAL_BOOL}}),E=n.Z.post({url:"/CMD_TICKET_MANAGE",params:{action:"reply",type:"reply",priority:"none"},schema:{number:n.Z.REQUIRED_STRING,user:n.Z.REQUIRED_STRING,subject:n.Z.REQUIRED_STRING,status:{type:String,required:!1,default:"open",validator:t=>["open","closed"].includes(t)},message:n.Z.REQUIRED_STRING}}),w=n.Z.get({id:"TICKET_DEFAULTS",url:"/CMD_TICKET_CREATE",after:t=>t.flow(t.moveProp("EML_ONLY_CHEKCED","email.set"),t.moveProp("SHOW_EML_ONLY","email.show"),t.moveProp("TCKTTO","to"),t.moveProp("TCKTTYPE","type"),o=>({...o,selected:Object.values(o.to).find(e=>!!e.selected)}),t.mapProps({email:t.mapProps({set:t.convert.toAppBoolean,show:t.convert.toAppBoolean}),to:o=>Object.values(o).map(e=>({label:e.text,value:e.value})),selected:o=>({label:o.text,value:o.value})}))}),b=n.Z.get({id:"TICKETS_EMAIL_SETTING",url:"/CMD_TICKET",after:t=>t.flow(t.project({email:"settings.EMAIL",checked:"settings.EMAILCHECKED"}),t.mapProps({featureEnabled:t.feedWith(1,({checked:o})=>typeof o!="undefined"),email:t.setDefault(""),checked:t.flow(t.setDefault("no"),t.convert.toAppBoolean)}))}),R=n.Z.post({url:"/CMD_TICKET_MANAGE",params:{action:"email"},schema:{email:n.Z.REQUIRED_STRING,ON:n.Z.REQUIRED_BOOL}}),M=n.Z.get({id:"TICKETS_ACTIVE_STATUS",url:"/CMD_TICKET_MANAGE",response:{html:"",active:!1},after:t=>o=>({html:o.info.html,active:t.convert.toAppBoolean(o.info.active)})}),C=n.Z.post({url:"/CMD_TICKET_MANAGE",params:{action:"active"},schema:{active:n.Z.REQUIRED_BOOL,html:n.Z.REQUIRED_STRING}}),O=n.Z.get({id:"TICKET_SYSTEM_STATUS",url:"/CMD_TICKET_CREATE",params:{type:"Ticket"},notifyError:!0})},"../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/reseller/_dialogs/view-ticket.vue?vue&type=style&index=0&id=6e69de0d&prod&lang=scss&":function(){},"../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/reseller/tickets.vue?vue&type=style&index=0&id=c6f994a4&prod&lang=scss&scoped=true&":function(){},"./js/composables/dateFilter.ts":function(S,y,a){"use strict";a.d(y,{W:function(){return x},f:function(){return i.f}});var n=a("../node_modules/ramda/es/index.js"),c=a("../node_modules/date-fns/esm/format/index.js"),i=a("./js/modules/date-formats.ts"),_=a("./js/modules/customizations/date-formats/default.ts");const x=n.WAo((g,T)=>{if(T)try{return(0,c.Z)(T,i.f.value[g])}catch(k){return console.warn(`Given ${g} format is incorrect:
${k.message}`),(0,c.Z)(T,_.d[g])}return""})},"./js/composables/filters.ts":function(S,y,a){"use strict";a.d(y,{Q0:function(){return R},aS:function(){return C},d5:function(){return M},eB:function(){return E},hT:function(){return I},kC:function(){return k},n9:function(){return b},zM:function(){return j}});var n=a("../node_modules/date-fns/esm/formatDistance/index.js"),c=a("../node_modules/punycode/punycode.es6.js"),i=a("./js/composables/dateFilter.ts"),_=a("./js/composables/gettext.ts");const{$gettext:x,$ngettext:g,$gettextInterpolate:T}=(0,_.Z)(),k=t=>{var o;return t?((o=t.at(0))===null||o===void 0?void 0:o.toUpperCase())+t.slice(1):""},I=(t,o="datetime")=>(0,i.W)(o,t),j=t=>(0,n.Z)(t,new Date),E=(t,o=1024)=>{const e=Number(t);if(!e)return"0 B";const s=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],r=Math.floor(Math.log(e)/Math.log(o));return`${parseFloat((e/o**r).toFixed(2))} ${s[r]}`},w=t=>{try{return(0,c.xX)(t)}catch(o){return t}},b=t=>(0,c.xX)(t),R=t=>{if(!t||!t.includes("@"))return t;const[o,e]=t.split("@");return[o,w(e)].join("@")},M=t=>{if(t<60)return x("less than a minute");const o=Math.floor(t/60)%60,e=Math.floor(t/3600)%24,s=Math.floor(t/(3600*24)),r=[s?g("%{days} day","%{days} days",s):null,e?g("%{hours} hour","%{hours} hours",e):null,o?g("%{minutes} minute","%{minutes} minutes",o):null].filter(Boolean).join(", ");return T(r,{days:s,hours:e,minutes:o})},C=(t,o)=>t.length<=o?t:`${t.substring(0,o)}...`,O=()=>({capitalize:k,date:I,distanceFromNow:j,humanReadableSize:E,p6eUnicode:b,p6eUnicodeEmail:R,formatUptime:M,truncateString:C})},"./js/pages/reseller/tickets.vue":function(S,y,a){"use strict";a.r(y),a.d(y,{default:function(){return t}});var n=function(){var e=this,s=e._self._c;return s("app-page",{attrs:{id:"manage-tickets"},scopedSlots:e._u([{key:"default",fn:function(){return[s("app-page-section",[s("ui-api-table",e._b({ref:"table",staticClass:"app-tickets-table",on:{"action:close":e.closeTickets,"action:open":e.updateTicketOpen,"action:markread":e.markAsRead,"table:rowClick":function(r){return e.openTicketRowClick(r)}},scopedSlots:e._u([{key:"col:subject",fn:function({item:r}){return[s("ui-round-badge",{directives:[{name:"margin",rawName:"v-margin:right",value:1,expression:"1",arg:"right"}],attrs:{theme:{10:"safe",20:"primary",30:"danger"}[r.priority]||"safe",title:{10:e.$gettext("Low"),20:e.$gettext("Normal"),30:e.$gettext("High")}[r.priority]||e.$gettext("Normal"),size:12}}),e._v(" "),r.new?s("strong",{domProps:{textContent:e._s(r.subject)}}):s("span",{domProps:{textContent:e._s(r.subject)}})]}},{key:"col:status",fn:function({item:r}){return[s("span",{class:`ticket-status-${r.status}`,domProps:{textContent:e._s(e.capitalize(r.status))}})]}},{key:"col:last_message",fn:function({last_message:r}){return[s("span",[e._v(`
                        `+e._s(e.date(r,"date"))+`
                    `)])]}},{key:"col:user",fn:function({user:r}){return[s("ui-link",{attrs:{name:"reseller/users/view",params:{user:r}}},[e._v(`
                        `+e._s(r)+`
                    `)])]}},{key:"buttons:before",fn:function(){return[e.$api.tickets.filters?s("input-checkable-select",{attrs:{options:{open:e.$gettext("Open"),hold:e.$gettext("Hold"),closed:e.$gettext("Closed")}},scopedSlots:e._u([{key:"label",fn:function(){return[s("span",{domProps:{textContent:e._s(e.$gettext("Filter"))}})]},proxy:!0},{key:"check:all:after",fn:function(){return[s("span",{domProps:{textContent:e._s(e.ticketsCount("all"))}})]},proxy:!0},{key:"check:open:after",fn:function(){return[s("span",{domProps:{textContent:e._s(e.ticketsCount("open"))}})]},proxy:!0},{key:"check:hold:after",fn:function(){return[s("span",{domProps:{textContent:e._s(e.ticketsCount("hold"))}})]},proxy:!0},{key:"check:closed:after",fn:function(){return[s("span",{domProps:{textContent:e._s(e.ticketsCount("closed"))}})]},proxy:!0}],null,!1,2949225329),model:{value:e.show,callback:function(r){e.show=r},expression:"show"}}):e._e()]},proxy:!0}]),model:{value:e.select,callback:function(r){e.select=r},expression:"select"}},"ui-api-table",{command:e.$commands.getTickets,rowID:"ticket",clickable:!0,columns:{ticket:e.$gettext("Ticket #"),subject:{label:e.$gettext("Subject"),grow:!0},replies:e.$gettext("Replies"),status:e.$gettext("Status"),last_message:e.$gettext("Last Message"),user:e.$gettext("User")},actions:{close:e.$gettext("Close"),open:{label:e.$gettext("Open"),disabled:e.updateTicketOpenActionDisabled},markread:e.$gettext("Mark as read")},requestData:{show_open:e.filters.open,show_hold:e.filters.hold,show_closed:e.filters.closed}},!1))],1),e._v(" "),s("ui-dialog",{attrs:{id:"TICKET_SYSTEM_SETTINGS",title:e.$gettext("Settings")},scopedSlots:e._u([{key:"content",fn:function(){return[s("div",[s("ui-form-element",{attrs:{vertical:""},scopedSlots:e._u([{key:"title",fn:function(){return[s("input-checkbox",{model:{value:e.ticketSystemStatus.active,callback:function(r){e.$set(e.ticketSystemStatus,"active",r)},expression:"ticketSystemStatus.active"}},[s("span",{domProps:{textContent:e._s(e.$gettext("Ticket System Enabled"))}})])]},proxy:!0},{key:"content",fn:function(){return[e.ticketSystemStatus.active?e._e():s("input",{directives:[{name:"model",rawName:"v-model",value:e.ticketSystemStatus.html,expression:"ticketSystemStatus.html"}],domProps:{value:e.ticketSystemStatus.html},on:{input:function(r){r.target.composing||e.$set(e.ticketSystemStatus,"html",r.target.value)}}})]},proxy:!0}])}),e._v(" "),s("ui-form-element",{attrs:{vertical:""},scopedSlots:e._u([{key:"title",fn:function(){return[s("input-checkbox",{model:{value:e.email.ON,callback:function(r){e.$set(e.email,"ON",r)},expression:"email.ON"}},[s("span",{domProps:{textContent:e._s(e.$gettext("E-mail a copy of all messages"))}})])]},proxy:!0},{key:"content",fn:function(){return[e.email.ON?s("input",{directives:[{name:"model",rawName:"v-model",value:e.email.email,expression:"email.email"}],attrs:{type:"text"},domProps:{value:e.email.email},on:{input:function(r){r.target.composing||e.$set(e.email,"email",r.target.value)}}}):e._e()]},proxy:!0}])})],1)]},proxy:!0},{key:"buttons",fn:function(){return[s("ui-button",{attrs:{theme:"primary"},on:{click:e.updateSettings}},[s("span",{domProps:{textContent:e._s(e.$gettext("Save"))}})])]},proxy:!0}])}),e._v(" "),e.openedTicket?s("view-ticket-dialog",e._b({attrs:{messages:e.$api.messages},on:{update:e.loadTicketMessages,close:e.closeTicketDialog}},"view-ticket-dialog",e.openedTicket,!1)):e._e()]},proxy:!0},{key:"bottom:links",fn:function(){return[e.$api.emailSetting.featureEnabled?s("ui-link",{attrs:{bullet:""},on:{click:function(r){e.$dialog("TICKET_SYSTEM_SETTINGS").open()}}},[s("span",{domProps:{textContent:e._s(e.$gettext("Ticket System Settings"))}})]):e._e(),e._v(" "),s("ui-link",{attrs:{bullet:"",name:"reseller/tickets/create"}},[s("span",{domProps:{textContent:e._s(e.$gettext("Send a message"))}})])]},proxy:!0}])})},c=[],i=a("./js/api/commands/reseller/tickets.js"),_=function(){var e=this,s=e._self._c;return s("ui-dialog",e._g(e._b({attrs:{id:"VIEW_TICKET_DIALOG",size:"normal","no-close-btn":""},on:{"dialog:close":function(r){return e.$emit("close")}},scopedSlots:e._u([{key:"title",fn:function(){return[s("span",{domProps:{textContent:e._s(e.$gettextInterpolate(e.$gettext("View Ticket: #%{ ticket }"),{ticket:e.ticket}))}})]},proxy:!0},{key:"content",fn:function(){return[s("div",[s("ui-form-element",{staticClass:"pos:rel",scopedSlots:e._u([{key:"content",fn:function(){return[s("div",{staticClass:"textarea"},[s("input-textarea",{staticClass:"textarea-input",attrs:{placeholder:e.$gettext("Type your reply here...")},on:{focus:function(r){e.focused=!0},blur:function(r){e.focused=!1},keyup:function(r){return!r.type.indexOf("key")&&r.keyCode!==13||!r.ctrlKey?null:e.postReply.apply(null,arguments)}},model:{value:e.message,callback:function(r){e.message=r},expression:"message"}}),e._v(" "),s("div",{staticClass:"textarea-submit-button"},[e.clientStore.isDesktop?s("span",{staticClass:"submit-keys-suggestion",domProps:{textContent:e._s(e.$gettext("Ctrl+Enter to post reply"))}}):s("span"),e._v(" "),s("ui-input-group",{directives:[{name:"flex-item",rawName:"v-flex-item",value:{grow:!1},expression:"{ grow: false }"}],style:{minWidth:"unset"},attrs:{grow:!1},scopedSlots:e._u([{key:"additions:left",fn:function(){return[s("ui-button",{attrs:{disabled:""}},[s("span",{domProps:{textContent:e._s(e.$gettext("Status:"))}})])]},proxy:!0},{key:"input",fn:function(){return[s("input-select",{attrs:{title:e.$gettext("Status"),options:{open:e.$gettext("Open"),closed:e.$gettext("Closed")}},model:{value:e.status,callback:function(r){e.status=r},expression:"status"}})]},proxy:!0},{key:"additions:right",fn:function(){return[s("ui-button",{style:{whiteSpace:"nowrap"},attrs:{theme:"safe"},on:{click:e.postReply}},[s("span",{domProps:{textContent:e._s(e.$gettext("Post reply"))}})])]},proxy:!0}])})],1)],1)]},proxy:!0}])}),e._v(" "),s("ui-table",{attrs:{items:e.messages,"hide-headers":""}},[s("ui-column",{attrs:{id:"avatar",fit:""},scopedSlots:e._u([{key:"default",fn:function(r){return[s("ui-round-badge",{staticClass:"messageAvatar",attrs:{theme:e.$_useStore("user").name===r.from?"safe":"primary",size:48}},[e._v(`
                            `+e._s(e._f("firstLetter")(r.from))+`
                        `)])]}}])}),e._v(" "),s("ui-column",{attrs:{id:"message"},scopedSlots:e._u([{key:"default",fn:function(r){return[s("div",{staticClass:"scrollArea"},[s("ui-grid",{attrs:{column:""}},[s("ui-grid",{attrs:{cross:"center"}},[s("span",{staticClass:"userName"},[e._v(`
                                        `+e._s({admin:e.$gettext("Admin"),reseller:e.$gettext("Reseller"),user:e.$gettext("User")}[r.level])+`:
                                        `+e._s(r.name)+`
                                    `)]),e._v(" "),s("span",{staticClass:"c:txt:neutral"},[e._v(`
                                        (`+e._s(r.time)+`)
                                    `)])]),e._v(" "),s("p",{staticClass:"message scrollbar:tiny",domProps:{innerHTML:e._s(r.message)}})],1)],1)]}}])})],1)],1)]},proxy:!0}])},"ui-dialog",e.$attrs,!1),e.$listeners))},x=[],g=a("./js/stores/index.ts"),T={filters:{firstLetter:o=>o[0].toUpperCase()},props:{subject:{type:String,required:!0},user:{type:String,required:!0},ticket:{type:String,required:!0},messages:{type:Array,required:!0}},data:()=>({message:"",status:"open",focused:!1}),computed:{...(0,g.Kc)(["client"])},methods:{async postReply(){await(0,i.Fv)({number:this.ticket,subject:`Re: ${this.subject}`,user:this.user,message:this.message,status:this.status})&&(this.message="",this.$emit("update"))}}},k=T,I=a("../node_modules/vue-style-loader/index.js!../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/reseller/_dialogs/view-ticket.vue?vue&type=style&index=0&id=6e69de0d&prod&lang=scss&"),j=a("../node_modules/vue-loader/lib/runtime/componentNormalizer.js"),E=(0,j.Z)(k,_,x,!1,null,null,null),w=E.exports,b=a("./js/composables/filters.ts"),R={name:"ResellerTickets",preload:[i.SP,i.Kw,i.a5],commands:{getTickets:i.SP},api:[{command:i.SP,bind:"tickets"},{command:i._U,bind:"messages"},{command:i.Kw,bind:"emailSetting"},{command:i.a5,bind:"activeStatus"}],components:{ViewTicketDialog:w},async beforeRouteUpdate(o,e,s){o.query.id&&(this.savedQuery=e.query,this.openTicketByID(o.query.id)),s()},props:{number:{type:String,required:!1,default:""}},data(){return{select:[],show:["open","hold","closed"],openedTicket:null,newTicket:{},email:{email:"",ON:!1},ticketSystemStatus:{active:!1,html:""},savedQuery:{}}},computed:{ticketsCount(){return o=>{const e=this.$api.tickets.filters[o];return`(${e.new?`${e.new} / `:""}${e.total})`}},allFiltersChecked(){return Object.values(this.filters).every(o=>o)},filters(){return{open:this.show.includes("open"),hold:this.show.includes("hold"),closed:this.show.includes("closed")}},updateTicketOpenActionDisabled(){if(this.select.length>1||!this.select.length)return!0;const{status:o="open"}=this.$api.tickets.rows.find(({ticket:e})=>e===this.select[0])||{};return o!=="closed"}},watch:{show(){this.reloadTable()}},created(){this.email={email:this.$api.emailSetting.email,ON:this.$api.emailSetting.checked},this.ticketSystemStatus={...this.$api.activeStatus},this.$route.query.id&&this.openTicketByID(this.$route.query.id)},methods:{capitalize:b.kC,date:b.hT,getPriorityClass(o){return`priority-${o.priority_string.toLowerCase()||"normal"}`},openTicketByID(o){const e=this.$api.tickets.rows.find(s=>s.ticket===o);this.openTicket(e)},openTicketRowClick(o){this.openTicket(o.item)},closeTickets(){(0,i.je)({select:this.select}).then(this.reloadTable)},updateTicketOpen(){(0,i.QC)(this.select[0]).then(this.reloadTable)},markAsRead(){(0,i.Pp)({select:this.select}).then(this.reloadTable)},loadTicketMessages(){return(0,i._U)({number:this.openedTicket.ticket})},async openTicket(o){this.openedTicket=o,await this.loadTicketMessages(),this.$dialog("VIEW_TICKET_DIALOG").open()},async sendMessage(){(0,i.ax)(this.newTicket)},async loadStatus(){const o=await(0,i.a5)();this.ticketSystemStatus={...o}},updateSettings(){(0,i.pR)(this.email),(0,i.TF)(this.ticketSystemStatus)},reloadTable(){this.$refs.table.reloadTable({show_open:this.filters.open,show_hold:this.filters.hold,show_closed:this.filters.closed}),this.select=[]},closeTicketDialog(){this.$router.push({name:"reseller/tickets",query:this.savedQuery}),this.savedQuery={}}}},M=R,C=a("../node_modules/vue-style-loader/index.js!../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/reseller/tickets.vue?vue&type=style&index=0&id=c6f994a4&prod&lang=scss&scoped=true&"),O=(0,j.Z)(M,n,c,!1,null,"c6f994a4",null),t=O.exports},"../node_modules/vue-style-loader/index.js!../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/reseller/_dialogs/view-ticket.vue?vue&type=style&index=0&id=6e69de0d&prod&lang=scss&":function(S,y,a){var n=a("../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/reseller/_dialogs/view-ticket.vue?vue&type=style&index=0&id=6e69de0d&prod&lang=scss&");n.__esModule&&(n=n.default),typeof n=="string"&&(n=[[S.id,n,""]]),n.locals&&(S.exports=n.locals);var c=a("../node_modules/vue-style-loader/lib/addStylesClient.js").Z,i=c("02b6c5b2",n,!0,{})},"../node_modules/vue-style-loader/index.js!../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/reseller/tickets.vue?vue&type=style&index=0&id=c6f994a4&prod&lang=scss&scoped=true&":function(S,y,a){var n=a("../node_modules/mini-css-extract-plugin/dist/loader.js??clonedRuleSet-13.use[1]!../node_modules/css-loader/dist/cjs.js??clonedRuleSet-13.use[2]!../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../node_modules/postcss-loader/dist/cjs.js??clonedRuleSet-13.use[3]!../node_modules/sass-loader/dist/cjs.js??clonedRuleSet-13.use[4]!../node_modules/vue-loader/lib/index.js??vue-loader-options!../node_modules/unplugin/dist/webpack/loaders/transform.js?unpluginName=unplugin-vue-define-options!./js/pages/reseller/tickets.vue?vue&type=style&index=0&id=c6f994a4&prod&lang=scss&scoped=true&");n.__esModule&&(n=n.default),typeof n=="string"&&(n=[[S.id,n,""]]),n.locals&&(S.exports=n.locals);var c=a("../node_modules/vue-style-loader/lib/addStylesClient.js").Z,i=c("317458c6",n,!0,{})}}]);
